<?xml version="1.0" encoding="utf-8"?><ManagementPack ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <Manifest>
    <Identity>
      <ID>MSMQ</ID>
      <Version>10.0.2.1</Version>
    </Identity>
    <Name>MSMQ</Name>
    <References>
      <Reference Alias="SCDW">
        <ID>Microsoft.SystemCenter.DataWarehouse.Library</ID>
        <Version>10.19.10050.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Windows">
        <ID>Microsoft.Windows.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Perf">
        <ID>System.Performance.Library</ID>
        <Version>7.0.8443.6</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="MSIL">
        <ID>Microsoft.SystemCenter.InstanceGroup.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="MSDRL">
        <ID>Microsoft.SystemCenter.DataWarehouse.Report.Library</ID>
        <Version>10.19.10407.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="System">
        <ID>System.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SC">
        <ID>Microsoft.SystemCenter.Library</ID>
        <Version>7.0.8448.6</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Health">
        <ID>System.Health.Library</ID>
        <Version>7.0.8443.6</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
    </References>
  </Manifest>
  <TypeDefinitions>
    <EntityTypes>
      <ClassTypes>
        <ClassType ID="MSMQ.Seed" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.LocalApplication" Hosted="true" Singleton="false" Extension="false">
          <Property ID="IsVirtualNode" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
        </ClassType>
        <ClassType ID="MSMQ.Server" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.LocalApplication" Hosted="true" Singleton="false" Extension="false">
          <Property ID="ClusterResourceName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="DependentClients" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="IsClustered" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="JournalQuota" Type="double" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="MessageFilesFolder" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="MessageLoggerFolder" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Quota" Type="double" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Routing" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="ServiceName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="SiteName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="SourceName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="TransactionLoggerFolder" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Version" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Workgroup" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
        </ClassType>
        <ClassType ID="MSMQ.Queue" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false">
          <Property ID="ADsPath" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="FormatName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="IsPublic" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="IsTestQueue" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="IsTransactional" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="JournalEnabled" Type="bool" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="JournalQuota" Type="int" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Label" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="PathName" Type="string" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="PrivilegeLevel" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
          <Property ID="Quota" Type="int" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
        </ClassType>
        <ClassType ID="MSMQ.Trigger" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false">
          <Property ID="ServiceName" Type="string" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" />
        </ClassType>
        <ClassType ID="MSMQ.ComputersAndWatchers.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
        <ClassType ID="MSMQ.Queue.NonTransactional.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
        <ClassType ID="MSMQ.Queue.Private.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
        <ClassType ID="MSMQ.Queue.Public.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
        <ClassType ID="MSMQ.Queue.Test.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
        <ClassType ID="MSMQ.Queue.Transactional.Group" Accessibility="Public" Abstract="false" Base="MSIL!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" />
      </ClassTypes>
      <RelationshipTypes>
        <RelationshipType ID="MSMQ.ServerHostsQueue.Relationship" Accessibility="Public" Abstract="false" Base="System!System.Hosting">
          <Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="MSMQ.Server" />
          <Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="MSMQ.Queue" />
        </RelationshipType>
        <RelationshipType ID="MSMQ.ServerHostsTriggers.Relationship" Accessibility="Public" Abstract="false" Base="System!System.Hosting">
          <Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="MSMQ.Server" />
          <Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="MSMQ.Trigger" />
        </RelationshipType>
      </RelationshipTypes>
    </EntityTypes>
    <SecureReferences>
      <SecureReference ID="MSMQ.RunAsProfile" Accessibility="Public" Context="System!System.Entity" />
    </SecureReferences>
    <ModuleTypes>
      <DataSourceModuleType ID="MSMQ.Server.Discovery.DS" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ComputerName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IsVirtualNode" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="DebugLogging" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="TimeoutSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
          <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="bool" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.TimedPowerShell.DiscoveryProvider">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime />
                <ScriptName>MSMQ.Server.Discovery.DS.ps1</ScriptName>
                <ScriptBody>
#=================================================================================
#  MSMQ Server Role Discovery
#
#  Author: Kevin Holman
#  v1.2
#=================================================================================
param($SourceId,$ManagedEntityId,[string]$ComputerName,[string]$IsVirtualNode,[string]$MGName,[string]$DebugLogging)


# Manual Testing section - put stuff here for manually testing script - typically parameters:
#=================================================================================
# $SourceId = '{00000000-0000-0000-0000-000000000000}'
# $ManagedEntityId = '{00000000-0000-0000-0000-000000000000}'
# $ComputerName = "computername.domain.com"
# $IsVirtualNode = "True"
# $MGName = "MGNAME"
# $DebugLogging = $true
#=================================================================================


# Constants section - modify stuff here:
#=================================================================================
# Assign script name variable for use in event logging.  
# ScriptName should be the same as the ID of the module that the script is contained in
$ScriptName = "MSMQ.Server.Discovery.DS.ps1"
$EventID = "14100"
#=================================================================================


# Starting Script section - All scripts get this
#=================================================================================
# Gather the start time of the script
$StartTime = Get-Date
#Set variable to be used in logging events
$whoami = whoami
# Load MOMScript API
$momapi = New-Object -comObject MOM.ScriptAPI
#Log script event that we are starting task
$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript is starting. `nRunning as ($whoami). `nComputerName: ($ComputerName). `nIsVirtualNode: ($IsVirtualNode). `nMGName: ($MGName).")
#=================================================================================


# Discovery Script section - Discovery scripts get this
#=================================================================================
# Load SCOM Discovery module
$DiscoveryData = $momapi.CreateDiscoveryData(0,$SourceId,$ManagedEntityId)
#=================================================================================


# Begin MAIN script section
#=================================================================================
#Get the NetBIOS name from the FQDN ComputerName script parameter
$NetBIOSName = ($ComputerName.Split("."))[0]

# Find out if this is discovering for a virtual computer
IF ($IsVirtualNode -eq "True")
{
  #This is a virtual node.  Assume cluster discovery
  #Check if the ComputerName matches a cluster name hosting MSMQ
  #Get array of clustered MSMQ objects
  $MQClusterServices = gwmi -Query "SELECT * FROM Win32_Service WHERE Name like 'MSMQ$%'"
  #Loop through each object to find a match for this computername
  FOREACH ($MQClusterService in $MQClusterServices)
  {
    $ServiceName = $MQClusterService.Name
    $MQClusterServiceName = $ServiceName.Replace("MSMQ$","")
    $MQClusResource = Get-ClusterResource -Name $MQClusterServiceName
    $MQClusResourceGroup = $MQClusResource.OwnerGroup
    $MQClusterNetworkName = $MQClusResourceGroup | Get-ClusterResource | where {$_.ResourceType.Name -eq "Network Name"}
    $MQClusterDNSName = $MQClusterNetworkName | Get-ClusterParameter -Name DnsName
    $MQClusterDNSNameValue = $MQClusterDNSName.Value

    IF ($MQClusterDNSNameValue -eq $NetBIOSName)
    {
      #We found a MSMQ Clustered resource with a Network Name that matches the target Computer discovery is running on.
      $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nCluster Resource Matches NetBIOS Name: ($NetBIOSName). `nComputerName: ($ComputerName).  Continuing Discovery.")
      #Continue discovery for this MSMQ Instance
      $RegInstance = "HKLM:\SOFTWARE\Microsoft\MSMQ\Clustered QMs\" + $ServiceName
      $ReginstanceParam = $RegInstance + "\Parameters"
      $Version = (Get-ItemProperty $RegInstanceParam).CurrentBuild
      $VersionSplit = $Version.Split(".")
      [double]$VersionNumber = $VersionSplit[0] + "." + $VersionSplit[1]
      #Only discover MSMQ on WS2012 and later
      IF ($VersionNumber -ge "6.2")
      {
        $Workgroup = $false
        $StorePersistentPath = ""
        $MessageLoggerFolder = ""
        $StoreXactLogPath = ""
        $MQS_DepClients = $false
        $Routing = $false

        #Get registry values for discovery properties
        $Workgroup = (Get-ItemProperty ($ReginstanceParam)).Workgroup
        $StorePersistentPath = (Get-ItemProperty ($ReginstanceParam)).StorePersistentPath
        $MessageLoggerFolder = (Get-ItemProperty ($ReginstanceParam)).StoreLogPath
        $StoreXactLogPath = (Get-ItemProperty ($ReginstanceParam)).StoreXactLogPath
        $MQS_DepClients = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MQS_DepClients
        $Routing = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).Routing
        $MachineQuota = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MachineQuota
        $MachineJournalQuota = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MachineJournalQuota

        IF ($Workgroup -eq "1"){$Workgroup = $true}ELSE{$Workgroup = $false}
        IF ($MQS_DepClients -eq "1"){$MQS_DepClients = $true}ELSE{$MQS_DepClients = $false}
        IF ($Routing -eq "1"){$Routing = $true}ELSE{$Routing = $false}
        IF ($MachineQuota -eq $null){$MachineQuota = "-1"}
        IF ($MachineJournalQuota -eq $null){$MachineJournalQuota = "-1"}

        #Discover MSMQ Clustered Server Role
        $instance = $DiscoveryData.CreateClassInstance("$MPElement[Name='MSMQ.Server']$")
        $instance.AddProperty("$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", $ComputerName)
        $instance.AddProperty("$MPElement[Name='System!System.Entity']/DisplayName$", $ComputerName)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/ServiceName$", $ServiceName)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Workgroup$", $Workgroup)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/DependentClients$", $MQS_DepClients)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Routing$", $Routing)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Quota$", $MachineQuota)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/JournalQuota$", $MachineJournalQuota)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/MessageFilesFolder$", $StorePersistentPath)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/MessageLoggerFolder$", $MessageLoggerFolder)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/TransactionLoggerFolder$", $StoreXactLogPath)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/IsClustered$", $true)
        $instance.AddProperty("$MPElement[Name='MSMQ.Server']/ClusterResourceName$", $MQClusterServiceName)
		$instance.AddProperty("$MPElement[Name='MSMQ.Server']/Version$", $Version)
        $DiscoveryData.AddInstance($instance)

        $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nDiscovering MSMQ Instance: `nComputerName: ($ComputerName). `nServiceName: ($ServiceName).")

        Remove-Variable MachineQuota
        Remove-Variable MachineJournalQuota

        #Discover Triggers
        $MQTriggers = gwmi -Query "SELECT * FROM Win32_Service WHERE Name like 'MSMQTriggers$%'"
        IF ($MQTriggers)
        {
          $MQTriggerServiceName = $MQTriggers.Name
          $instance = $DiscoveryData.CreateClassInstance("$MPElement[Name='MSMQ.Trigger']$")
          $instance.AddProperty("$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", $ComputerName)
          $instance.AddProperty("$MPElement[Name='System!System.Entity']/DisplayName$", $ComputerName)
          $instance.AddProperty("$MPElement[Name='MSMQ.Trigger']/ServiceName$", $MQTriggerServiceName)
          $DiscoveryData.AddInstance($instance)		  
          
          $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nDiscovering Trigger: `nComputerName: ($ComputerName). `nServiceName: ($MQTriggerServiceName).")        
        }
      }
      ELSE
      {
        #Log event MSMQ Found but wrong version
        $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nMSMQ found but unsupported version. `nMinimum Version: (6.2). `nVersion Found: ($VersionNumber). `nWill not discover this instance.")
      }
    }
    ELSE
    {
      #This is a Virtual but the NetBIOS Computer Name does not match any MSMQ Cluster resources
      $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nNetBIOS Computer Name ($NetBIOSName) does not match Virtual Cluster Network Name: ($MQClusterDNSNameValue). `nWill not discover this instance.")
    }
  }
}
ELSE
{
  #Assume this is not a cluster since IsVirtualNode = false
  #Check to see if this is a cluster node that hosts a MSMQ resource
  $MSMQClResource = Get-ClusterResource | Where {$_.ResourceType -eq "MSMQ"} -ErrorAction SilentlyContinue
  IF ($MSMQCLResource)
  {
    #This is a cluster node that hosts a MSMQ resource.  Do not discover this as a MSMQ Server role.
  }
  ELSE
  {
    #Get Non-Clustered MSMQ instances
    $MQService = gwmi -Query "SELECT * FROM Win32_Service WHERE Name = 'MSMQ'"
    $ServiceName = $MQService.Name
    $RegInstance = "HKLM:\SOFTWARE\Microsoft\MSMQ"
    $ReginstanceParam = $RegInstance + "\Parameters"
    $Version = (Get-ItemProperty $RegInstanceParam).CurrentBuild
    $VersionSplit = $Version.Split(".")
    [double]$VersionNumber = $VersionSplit[0] + "." + $VersionSplit[1]
    #Only discover MSMQ on WS2012 and later
    IF ($VersionNumber -ge "6.2")
    {
      $Workgroup = $false
      $StorePersistentPath = ""
      $MessageLoggerFolder = ""
      $StoreXactLogPath = ""
      $MQS_DepClients = $false
      $Routing = $false

     #Get registry values for discovery properties
      $Workgroup = (Get-ItemProperty ($ReginstanceParam)).Workgroup
      $StorePersistentPath = (Get-ItemProperty ($ReginstanceParam)).StorePersistentPath
      $MessageLoggerFolder = (Get-ItemProperty ($ReginstanceParam)).StoreLogPath
      $StoreXactLogPath = (Get-ItemProperty ($ReginstanceParam)).StoreXactLogPath
      $MQS_DepClients = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MQS_DepClients
      $Routing = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).Routing
      $MachineQuota = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MachineQuota
      $MachineJournalQuota = (Get-ItemProperty ($ReginstanceParam + "\MachineCache")).MachineJournalQuota

      IF ($Workgroup -eq "1"){$Workgroup = $true}ELSE{$Workgroup = $false}
      IF ($MQS_DepClients -eq "1"){$MQS_DepClients = $true}ELSE{$MQS_DepClients = $false}
      IF ($Routing -eq "1"){$Routing = $true}ELSE{$Routing = $false}
      IF ($MachineQuota -eq $null){$MachineQuota = "-1"}
      IF ($MachineJournalQuota -eq $null){$MachineJournalQuota = "-1"}

      #Discover MSMQ Server Role
      $instance = $DiscoveryData.CreateClassInstance("$MPElement[Name='MSMQ.Server']$")
      $instance.AddProperty("$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", $ComputerName)
      $instance.AddProperty("$MPElement[Name='System!System.Entity']/DisplayName$", $ComputerName)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/ServiceName$", $ServiceName)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Workgroup$", $Workgroup)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/DependentClients$", $MQS_DepClients)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Routing$", $Routing)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Quota$", $MachineQuota)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/JournalQuota$", $MachineJournalQuota)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/MessageFilesFolder$", $StorePersistentPath)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/MessageLoggerFolder$", $MessageLoggerFolder)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/TransactionLoggerFolder$", $StoreXactLogPath)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/IsClustered$", $false)
      $instance.AddProperty("$MPElement[Name='MSMQ.Server']/Version$", $Version)	  
      $DiscoveryData.AddInstance($instance)

      $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nDiscovering MSMQ Instance: `nComputerName: ($ComputerName). `nServiceName: ($ServiceName). `nVersion: ($Version). `nWorkGroup: ($Workgroup). `nMessageFilesFolder: ($StorePersistentPath).")

      #Discover Triggers
      $MQTriggers = gwmi -Query "SELECT * FROM Win32_Service WHERE Name = 'MSMQTriggers'"
      IF ($MQTriggers)
      {
        $instance = $DiscoveryData.CreateClassInstance("$MPElement[Name='MSMQ.Trigger']$")
        $instance.AddProperty("$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", $ComputerName)
        $instance.AddProperty("$MPElement[Name='System!System.Entity']/DisplayName$", $ComputerName)
        $instance.AddProperty("$MPElement[Name='MSMQ.Trigger']/ServiceName$", "MSMQTriggers")
        $DiscoveryData.AddInstance($instance)	  
      
        $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nDiscovering Trigger: `nComputerName: ($ComputerName). `nServiceName: (MSMQTriggers).")
      }
    }
    ELSE
    {
      #Log event MSMQ Found but wrong version
      $momapi.LogScriptEvent($ScriptName,$EventID,0,"`nMSMQ found but unsupported version. `nMinimum Version: (6.2). `nVersion Found: ($VersionNumber). `nWill not discover this instance.")
    }
  }
}

# Return Discovery Items Normally           
$DiscoveryData
# Return Discovery Bag to the command line for testing (does not work from ISE)
# $momapi.Return($DiscoveryData)
#=================================================================================
# End MAIN script section


# End of script section
#=================================================================================
#Log an event for script ending and total execution time.
$EndTime = Get-Date
$ScriptTime = ($EndTime - $StartTime).TotalSeconds
$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript Completed. `nRuntime: ($ScriptTime) seconds.")
#=================================================================================
# End of script			
                </ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>SourceId</Name>
                    <Value>$MPElement$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ManagedEntityId</Name>
                    <Value>$Target/Id$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ComputerName</Name>
                    <Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>IsVirtualNode</Name>
                    <Value>$Config/IsVirtualNode$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>MGName</Name>
                    <Value>$Target/ManagementGroup/Name$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>DebugLogging</Name>
                    <Value>$Config/DebugLogging$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </DataSource>
            </MemberModules>
            <Composition>
              <Node ID="DS" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.Discovery.Data</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="MSMQ.QueueStats.DS" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" type="xsd:integer" name="IntervalSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="ComputerName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="DebugLogging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />		  
          <xsd:element minOccurs="1" type="xsd:integer" name="TimeoutSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
          <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="string" />			  
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Scheduler" TypeID="System!System.Scheduler">
                <Scheduler>
                  <SimpleReccuringSchedule>
                    <Interval Unit="Seconds">$Config/IntervalSeconds$</Interval>
                  </SimpleReccuringSchedule>
                  <ExcludeDates />
                </Scheduler>
              </DataSource>
              <ProbeAction ID="PA" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagTriggerOnlyProbe">
                <ScriptName>MSMQ.QueueStats.DS.ps1</ScriptName>
                <ScriptBody>
#=================================================================================
#  MSMQ Queue Stats and Performance Script
#
#  Author:  Kevin Holman
#  v1.6
#=================================================================================
param([string]$ComputerName,[string]$DebugLogging)

# Manual Testing section - put stuff here for manually testing script - typically parameters:
#=================================================================================
# $ComputerName = "WS2016CLMQ1.opsmgr.net"
#=================================================================================


# Constants section - modify stuff here:
#=================================================================================
# Assign script name variable for use in event logging.  
$ScriptName = "MSMQ.QueueStats.DS.ps1"
$EventID = "14120"
#=================================================================================


# Starting Script section - All scripts get this
#=================================================================================
# Gather the start time of the script
$StartTime = Get-Date
#Set variable to be used in logging events
$whoami = whoami
# Load MOMScript API
$momapi = New-Object -comObject MOM.ScriptAPI
#=================================================================================


# Begin MAIN script section
#=================================================================================
#Check DebugLogging
IF ($DebugLogging.ToUpper() -eq "TRUE"){$DBL=$true}

#Log script event that we are starting task
IF ($DBL){$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript is starting. `nRunning For: ($ComputerName). `nRunning as: ($whoami). `nDebugLogging: ($DebugLogging).")}

#Modify the environment variables for this session if a cluster
$IsCluster = $false
$ComputerNameFromEnv = $env:computername
$NetBIOSName = ($ComputerName.Split("."))[0]
IF ($NetBIOSName -ne $ComputerNameFromEnv)
{
  #The Environment Variable for ComputerName does not match the ComputerName hosting this Queue
  #This is common on clusters so we must set the environment variables for clusters
  $IsCluster = $true
  $env:computername = $NetBIOSName
  $env:_CLUSTER_NETWORK_NAME_ = $NetBIOSName
}

# Clear any previous errors
$Error.Clear()

#Test PowerShell MSMQ
$Queues = Get-MsmqQueue

IF ($Error)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nFATAL ERROR:  MSMQ PowerShell Commandlet failed attempting (Get-MsmqQueue). `nTerminating. `nError is ($Error).")
  EXIT
}

#Get the Queues
$Queues = Get-MsmqQueue

#Loop through each queue and output propertybag data
FOREACH ($Queue in $Queues)
{
  $QueueName = $Queue.QueueName
  $MessageCount = $Queue.MessageCount
  $BytesInQueue = $Queue.BytesInQueue
  $KBytesInQueue = [math]::Round(($BytesInQueue / 1000),0)
  $JournalMessageCount = $Queue.JournalMessageCount  
  $BytesInJournal = $Queue.BytesInJournal
  $KBytesInJournal = [math]::Round(($BytesInJournal / 1000),0)
  $MaximumQueueSizeKB = $Queue.MaximumQueueSize
  $MaximumJournalSizeKB = $Queue.MaximumJournalSize
  $QueuePercentUsed = [math]::Round((($KBytesInQueue / $MaximumQueueSizeKB)*100),0)
  $JournalPercentUsed = [math]::Round((($KBytesInJournal / $MaximumJournalSizeKB)*100),0)

  IF ($DBL){$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nRunning For: ($ComputerName). `nQueueName: ($QueueName). `nMessages In Queue: ($MessageCount). `nKBytes In Queue: ($KBytesInQueue). `nMessages In Journal Queue: ($JournalMessageCount). `nKBytes In Journal Queue: ($KBytesInJournal). `nQueue Percent Used: ($QueuePercentUsed). `nJournal Percent Used: ($JournalPercentUsed).")}
 
  # Load PropertyBag function 
  $bag = $momapi.CreatePropertyBag()
  #Create PropertyBags
  $bag.AddValue('NetBIOSName',$NetBIOSName)  
  $bag.AddValue('QueueName',$QueueName)
  $bag.AddValue('Messages In Queue',$MessageCount)
  $bag.AddValue('KBytes In Queue',$KBytesInQueue)
  $bag.AddValue('Messages In Journal Queue',$JournalMessageCount)
  $bag.AddValue('KBytes In Journal Queue',$KBytesInJournal)
  $bag.AddValue('Queue Percent Used',$QueuePercentUsed)
  $bag.AddValue('Journal Percent Used',$JournalPercentUsed)
  #Return each property bag as we create and populate it.
  $bag
}

IF ($IsCluster)
{
  #Set Environment Variable back to default
  $env:computername = $ComputerNameFromEnv
  Remove-Item env:_CLUSTER_NETWORK_NAME_
}
#=================================================================================
# End MAIN script section


# End of script section
#=================================================================================
#Log an event for script ending and total execution time.
$EndTime = Get-Date
$ScriptTime = ($EndTime - $StartTime).TotalSeconds
$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript Completed. `nRunning For: ($ComputerName). `nRunning as ($whoami). `nScript Runtime: ($ScriptTime) seconds.")
#=================================================================================
# End of script
                </ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>ComputerName</Name>
                    <Value>$Config/ComputerName$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>DebugLogging</Name>
                    <Value>$Config/DebugLogging$</Value>
                  </Parameter>					  
                </Parameters>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="PA">
                <Node ID="Scheduler" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="MSMQ.QueueStats.Filtered.DS" Accessibility="Public" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" type="xsd:integer" name="IntervalSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="ComputerName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
		  <xsd:element minOccurs="1" type="xsd:string" name="DebugLogging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="TimeoutSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="QueueName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
		  <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="string" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="DS" TypeID="MSMQ.QueueStats.DS">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <ComputerName>$Config/ComputerName$</ComputerName>
				<DebugLogging>$Config/DebugLogging$</DebugLogging>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </DataSource>
              <ConditionDetection ID="Filter" TypeID="System!System.ExpressionFilter">
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Property[@Name='QueueName']</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Config/QueueName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Filter">
                <Node ID="DS" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="MSMQ.ServerStats.DS" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" type="xsd:integer" name="IntervalSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="ComputerName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="DebugLogging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />		  
          <xsd:element minOccurs="1" type="xsd:integer" name="TimeoutSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
          <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="string" />		  
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Scheduler" TypeID="System!System.Scheduler">
                <Scheduler>
                  <SimpleReccuringSchedule>
                    <Interval Unit="Seconds">$Config/IntervalSeconds$</Interval>
                  </SimpleReccuringSchedule>
                  <ExcludeDates />
                </Scheduler>
              </DataSource>
              <ProbeAction ID="PA" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagTriggerOnlyProbe">
                <ScriptName>MSMQ.ServerStats.DS.ps1</ScriptName>
                <ScriptBody>
#=================================================================================
#  MSMQ Server Stats and Performance Script
#
#  Author:  Kevin Holman
#  v1.3
#=================================================================================
param([string]$ComputerName,[string]$DebugLogging)

# Manual Testing section - put stuff here for manually testing script - typically parameters:
#=================================================================================
# $ComputerName = "WS2016CLMQ1.opsmgr.net"
#=================================================================================


# Constants section - modify stuff here:
#=================================================================================
# Assign script name variable for use in event logging.  
$ScriptName = "MSMQ.ServerStats.DS.ps1"
$EventID = "14130"
#=================================================================================


# Starting Script section - All scripts get this
#=================================================================================
# Gather the start time of the script
$StartTime = Get-Date
#Set variable to be used in logging events
$whoami = whoami
# Load MOMScript API
$momapi = New-Object -comObject MOM.ScriptAPI
#=================================================================================


# Begin MAIN script section
#=================================================================================
#Check DebugLogging
IF ($DebugLogging.ToUpper() -eq "TRUE"){$DBL=$true}

#Log script event that we are starting task
IF ($DBL){$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript is starting. `nRunning For: ($ComputerName). `nRunning as: ($whoami). `nDebugLogging: ($DebugLogging).")}

# Load PropertyBag function 
$bag = $momapi.CreatePropertyBag()

#Modify the environment variables for this session if a cluster
$IsCluster = $false
#$ComputerNameFromEnv = $env:computername
$ComputerNameFromEnv = hostname
$NetBIOSName = ($ComputerName.Split("."))[0]
IF ($NetBIOSName -ne $ComputerNameFromEnv)
{
  #The Environment Variable for ComputerName does not match the ComputerName hosting this Queue
  #This is common on clusters so we must set the environment variables for clusters
  IF ($DBL){$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nRunning For: ($ComputerName). `nComputerNameFromEnv: ($ComputerNameFromEnv). `nNetBIOSName: ($NetBIOSName). `nComputerName from Environment did not match NetBIOS name passed to script. `nThis is expected on Clusters so we will modify Cluster Name Environment Variable.")}
  $IsCluster = $true
  #$env:computername = $NetBIOSName
  $env:_CLUSTER_NETWORK_NAME_ = $NetBIOSName
}
ELSE
{
  #Names Match
  #Check to see if this is a Cluster Node MSMQ.  Do not collect performance data from the nodes only the Cluster
  $MQClusterServices = gwmi -Query "SELECT * FROM Win32_Service WHERE Name like 'MSMQ$%'"
  IF ($MQClusterServices)
  {
    This is a cluster node.  Stop the script.
    IF ($DBL){$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nRunning For: ($ComputerName). `nStopping script as we will not gather perf data for nodes on a cluster.")}
	EXIT
  }
}

# Clear any previous errors
$Error.Clear()

$TotalMessagesInAllQueues = (Get-Counter "\MSMQ Service\Total messages in all queues").CounterSamples.CookedValue
$TotalBytesInAllQueues = (Get-Counter "\MSMQ Service\Total bytes in all queues").CounterSamples.CookedValue
$TotalKBytesInAllQueues = [math]::Round(($TotalBytesInAllQueues / 1000),0)
$Sessions = (Get-Counter "\MSMQ Service\Sessions").CounterSamples.CookedValue
$IncomingMessagesSec = (Get-Counter "\MSMQ Service\Incoming Messages/sec").CounterSamples.CookedValue
$OutgoingMessagesSec = (Get-Counter "\MSMQ Service\Outgoing Messages/sec").CounterSamples.CookedValue
$MessagesInDeadLetterQueue = (Get-Counter "\MSMQ Queue(Computer Queues)\Messages in Queue").CounterSamples.CookedValue
$BytesInDeadLetterQueue = (Get-Counter "\MSMQ Queue(Computer Queues)\Bytes in Queue").CounterSamples.CookedValue
$KBytesInDeadLetterQueue = [math]::Round(($BytesInDeadLetterQueue / 1000),0)

IF ($Error)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nError getting Perfmon Performance Data using Get-Counter: ($Error).")
}

#Add values to PropertyBags
$bag.AddValue('NetBIOSName',$NetBIOSName)  
$bag.AddValue('TotalMessagesInAllQueues',$TotalMessagesInAllQueues)
$bag.AddValue('TotalKBytesInAllQueues',$TotalKBytesInAllQueues)
$bag.AddValue('Sessions',$Sessions)
$bag.AddValue('IncomingMessagesSec',$IncomingMessagesSec)
$bag.AddValue('OutgoingMessagesSec',$OutgoingMessagesSec)
$bag.AddValue('MessagesInDeadLetterQueue',$MessagesInDeadLetterQueue)
$bag.AddValue('KBytesInDeadLetterQueue',$KBytesInDeadLetterQueue)


##### Begin Process section
### Begin Process Memory
#Clear any errors
IF ($Error){$Error.Clear()}
[string]$ProcessName = "mqsvc"

#Get the process values into an array
[array]$ProcessPBArr = Get-Process -Name $ProcessName | select PrivateMemorySize64
[int]$ProcessPBArrCount = $ProcessPBArr.Count

#Check if error or null here because process is not running
IF ($Error)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nError getting Process info from Powershell.  Error is ($Error).")
  $bag.AddValue("MemoryValueMB","0")
  $bag.AddValue("ProcessesRunning","0")
}
ELSEIF ($ProcessPBArrCount -eq 0)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nProcess with name: ($ProcessName) does not exist.")
  $bag.AddValue("MemoryValueMB","0")
  $bag.AddValue("ProcessesRunning","0")
}
ELSE
{
  #Set sum to zero
  $ProcessValueSumBytes = 0

  #Loop through each process and get sum of values
  FOREACH ($ProcessPBObj in $ProcessPBArr)
  {
    $ProcessValue = $ProcessPBObj.PrivateMemorySize64
    $ProcessValueSumBytes = $ProcessValueSumBytes + $ProcessValue
  }

  # Divide bytes value to get Megabytes
  $ProcessValueSumMBytes = $ProcessValueSumBytes / 1000000
  # Round the value to no decimals
  $ProcessValueSumMBytes = [math]::Round($ProcessValueSumMBytes)
  $bag.AddValue("MemoryValueMB",$ProcessValueSumMBytes)
  $bag.AddValue("ProcessesRunning",$ProcessPBArrCount)
}

### Begin Process CPU
# Clear any errors
IF ($Error){$Error.Clear()}

#This is the fastest way to get cores
[int]$LogicalCPUs = (Get-CimInstance Win32_ComputerSystem).NumberOfLogicalProcessors

#Get the process values into an array.  Divide the value from perfmon by the number of cores
[string]$Filter = "Name like '" + $ProcessName + "%" + "'"
$ProcArr = Get-WmiObject win32_PerfFormattedData_PerfProc_Process -Filter $Filter
$ProcArrCount = $ProcArr.Count

[int]$CPUTotal = 0
[int]$CPUTime = 0

FOREACH ($Proc in $ProcArr)
{
  [int]$ProcCPUTime = $Proc.PercentProcessorTime
  #Divide the process CPU value by the total number of cores to get real total consumption
  $CPUTime = $ProcCPUTime / $LogicalCPUs
  #Keep track of the max value for any process we examine
  IF ($CPUTime -gt $CPUProcessMax){$CPUProcessMax = $CPUTime}
  #Keep a sum of all process CPU total
  $CPUTotal += $CPUTime
}

#Check if error or null here because process is not running
IF ($Error)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nError getting CPU Process value.  Error is ($Error).")
  $bag.AddValue("CPUValue","0")
}
ELSEIF ($ProcArrCount -eq 0)
{
  $momapi.LogScriptEvent($ScriptName,$EventID,2,"`nProcess with name: ($ProcessName) does not exist.")
  $bag.AddValue("CPUValue","0")
}
ELSE
{
  $bag.AddValue("CPUValue",$CPUTotal)
}

#Return property bags
$bag

IF ($IsCluster)
{
  #Set Environment Variable back to default
#  $env:computername = $ComputerNameFromEnv
  Remove-Item env:_CLUSTER_NETWORK_NAME_
}
#=================================================================================
# End MAIN script section


# End of script section
#=================================================================================
#Log an event for script ending and total execution time.
$EndTime = Get-Date
$ScriptTime = ($EndTime - $StartTime).TotalSeconds
$momapi.LogScriptEvent($ScriptName,$EventID,0,"`nScript Completed. `nRunning as ($whoami). `nScript Runtime: ($ScriptTime) seconds. `nComputerName: ($ComputerName). `nTotalMessagesInAllQueues: ($TotalMessagesInAllQueues). `nTotalKBytesInAllQueues: ($TotalKBytesInAllQueues). `nSessions: ($Sessions). `nIncomingMessagesSec: ($IncomingMessagesSec). `nOutgoingMessagesSec: ($OutgoingMessagesSec). `nMessagesInDeadLetterQueue: ($MessagesInDeadLetterQueue). `nKBytesInDeadLetterQueue: ($KBytesInDeadLetterQueue). `nNumber of MSMQ Processes Running: ($ProcessPBArrCount). `nCPU Percent Time Value For All MSMQ Processes: ($CPUTotal). `nMemory MB Value For All MSMQ Processes: ($ProcessValueSumMBytes).")
#=================================================================================
# End of script
                </ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>ComputerName</Name>
                    <Value>$Config/ComputerName$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>DebugLogging</Name>
                    <Value>$Config/DebugLogging$</Value>
                  </Parameter>				  
                </Parameters>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="PA">
                <Node ID="Scheduler" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>	  
      <DataSourceModuleType ID="MSMQ.Queue.Discovery.DS" Accessibility="Internal" RunAs="MSMQ.RunAsProfile" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ComputerName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ServiceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="DiscoverPublic" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="DiscoverPrivate" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="WorkgroupServer" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="LogDetail" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="TimeoutSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
          <OverrideableParameter ID="DiscoverPublic" Selector="$Config/DiscoverPublic$" ParameterType="bool" />
          <OverrideableParameter ID="DiscoverPrivate" Selector="$Config/DiscoverPrivate$" ParameterType="bool" />
          <OverrideableParameter ID="LogDetail" Selector="$Config/LogDetail$" ParameterType="bool" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.TimedScript.DiscoveryProvider">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime />
                <ScriptName>MSMQ.Queue.Discovery.DS.vbs</ScriptName>
                <Arguments>$MPElement$ $Target/Id$ "$Config/ComputerName$" "$Config/ServiceName$" "$Config/DiscoverPublic$" "$Config/DiscoverPrivate$" "$Config/WorkgroupServer$" "$Config/LogDetail$"</Arguments>
                <ScriptBody>option explicit
SetLocale("en-us")

Const SCRIPT_NAME = "MSMQ.Queue.Discovery.DS.vbs"

Const EVENTNO_SCRIPT_STARTED			= 14110
Const EVENTNO_SCRIPT_ENDED				= 14110
Const EVENTNO_DISCOVER_PRIVATEQUEUES	= 14110
Const EVENTNO_BYPASS_PRIVATEQUEUES		= 14110
Const EVENTNO_DISCOVER_PUBLICQUEUES		= 14110
Const EVENTNO_BYPASS_PUBLICQUEUES		= 14110
Const EVENTNO_FOUND_QUEUE 				= 14110
Const EVENTNO_MSMQSERVICE_NOTRUNNING	= 14110
Const EVENTNO_ERROR_ADLOOKUP			= 14110
Const EVENTNO_ERROR_COULDNOTOPENQUEUE	= 14110

Const EVENT_LEVEL_ERROR = 1
Const EVENT_LEVEL_WARNING = 2
Const EVENT_LEVEL_INFO = 4

Const HKEY_LOCAL_MACHINE = &amp;H80000002

Const MSMQ_REGROOT = "SOFTWARE\Microsoft\Microsoft Operations Manager\3.0\Modules\MSMQ Management Pack"
Const PUBLICQUEUE_VALUENAME = "Public Queues"

Dim SourceId, ManagedentityId, sComputer, sServiceName, bDiscoverPublicQueues, bDiscoverPrivateQueues, bWorkgroupServer, bLogDetail
Dim oApi, oDiscoveryData
Dim wshNetwork, sUser, sDomain, sMessage
Dim bIsCluster, WshShell, objWshShell, sName
Dim oMSMQApp
Dim sQueue, oQueue
Dim aPublicQueues, i

If WScript.Arguments.Count &lt; 7 Then Call ShowUsage()
SourceId = WScript.Arguments(0)
ManagedEntityId = WScript.Arguments(1)
sComputer = WScript.Arguments(2)
sServiceName = WScript.Arguments(3)
bDiscoverPublicQueues = cbool(WScript.Arguments(4))
bDiscoverPrivateQueues = cbool(WScript.Arguments(5))
bWorkgroupServer = cbool(WScript.Arguments(6))
bLogDetail = CBool(WScript.Arguments(7))

If IsMSMQServiceRunning = False Then
Call ThrowScriptError(EVENTNO_MSMQSERVICE_NOTRUNNING,EVENT_LEVEL_WARNING,"Queue Discovery did not execute because the MSMQ service is not running.",True)
End If

Set oAPI = CreateObject("MOM.ScriptAPI")
Set oDiscoveryData = oAPI.CreateDiscoveryData(0, SourceId, ManagedEntityId)

Set wshNetwork = CreateObject("Wscript.Network")
sUser = wshNetwork.UserName
sDomain = wshNetwork.UserDomain

sMessage = 	"Discovery started with following parameters: " &amp; VbCrLf &amp; _
"Source ID: " &amp; SourceId &amp; VbCrLf &amp; _
"Managed Entity ID: " &amp; ManagedEntityId &amp; VbCrLf &amp; _
"Computer: " &amp; sComputer  &amp; VbCrLf &amp; _
"Network: " &amp; wshNetwork.ComputerName  &amp; VbCrLf &amp; _
"Discover Public Queues: " &amp; bDiscoverPublicQueues &amp; VbCrLf &amp; _
"Discover Private Queues: " &amp; bDiscoverPrivateQueues &amp; VbCrLf &amp; _
"User credentials: " &amp; sDomain &amp; "\" &amp; sUser

Call LogDetail(EVENTNO_SCRIPT_STARTED,sMessage)

bIsCluster = false
If IsCluster = True then
bIsCluster = true
set WshShell = CreateObject("WScript.Shell")
set objWshShell = WshShell.Environment("Process")
sName = GetQueueServer(sComputer)
objWshShell("_CLUSTER_NETWORK_NAME_") = sName
objWshShell("_CLUSTER_NETWORK_HOSTNAME_") = sName
End If

Set oMSMQApp = CreateObject("MSMQ.MSMQApplication")
oMSMQApp.Machine = sComputer
oMSMQApp.Connect

'Private Queues
If bDiscoverPrivateQueues = True Then
Call LogDetail(EVENTNO_DISCOVER_PRIVATEQUEUES,"Discovering private queues.")
For Each sQueue In oMSMQApp.PrivateQueues
Set oQueue = NewQueueInstance(sComputer,sQueue,False)
If Not oQueue Is Nothing Then
Call SubmitQueue(oQueue)
Call WriteDetailEvent(oQueue)
End If
Next
Else
Call LogDetail(EVENTNO_BYPASS_PRIVATEQUEUES,"Bypassed discovery of private queues.")
End If

'Public Queues
Call InitializeRegistry(sComputer,MSMQ_REGROOT,PUBLICQUEUE_VALUENAME)
If bDiscoverPublicQueues = True And bWorkgroupServer = False Then

Call LogDetail(EVENTNO_DISCOVER_PUBLICQUEUES,"Discovering public queues.")

aPublicQueues = GetPublicQueues(sComputer)
For i = 0 To UBound(aPublicQueues)
Set oQueue = NewQueueInstance(sComputer,aPublicQueues(i),True)
If Not oQueue Is Nothing Then
Call SubmitQueue(oQueue)
Call WriteDetailEvent(oQueue)
Call WriteQueueToRegistry(oQueue,sComputer)
End If
Next
Else
Call LogDetail(EVENTNO_BYPASS_PUBLICQUEUES,"Bypassed discovery of public queues.")

End If

if bIsCluster = true then
objWshShell.Remove("_CLUSTER_NETWORK_NAME_")
objWshShell.Remove("_CLUSTER_NETWORK_HOSTNAME_")
End If

Call oAPI.Return(oDiscoveryData)
Call LogDetail(EVENTNO_SCRIPT_ENDED,"Queue Discovery script ended.")

Function GetQueueServer(Path)

If InStr(Path,".") &gt; 0 THEN
GetQueueServer = Left(Path, InStr(Path,".")-1)
Else
GetQueueServer = Path
End if

End Function

Function IsCluster()

Dim wshNetwork

Set wshNetwork = CreateObject("Wscript.Network")
if StrComp(wshNetwork.ComputerName, GetQueueServer(sComputer), 1) &lt;&gt; 0 then
IsCluster = True
else
IsCluster = False
End if

End Function

Function GetPublicQueues(Computer)
Dim MSMQQuery, Queues, QueueInfo, QueueServer, Message
Dim PublicQueues()
ReDim PublicQueues(0)

Set MSMQQuery = CreateObject("MSMQ.MSMQQuery")

On Error Resume Next
Set Queues = MSMQQuery.LookupQueue()
Set QueueInfo = Queues.Next
If Err = 0 Then
On Error GoTo 0
While Not QueueInfo Is Nothing
QueueServer = Split(QueueInfo.PathNameDNS,"\")(0)
If lcase(Computer) = lcase(QueueServer) Then
PublicQueues(UBound(PublicQueues)) = QueueInfo.PathName
ReDim Preserve PublicQueues(UBound(PublicQueues)+1)
End If
Set QueueInfo = Queues.Next
Wend
Else
Message =	"Error searching Active Directory while discovering public queues." &amp; VbCrLf &amp; _
"Error number: " &amp; Err.Number &amp; VbCrLf &amp; _
"Error Description: " &amp; Err.Description
On Error GoTo 0
Call ThrowScriptError(EVENTNO_ERROR_ADLOOKUP,EVENT_LEVEL_ERROR,Message,False)
End If

ReDim Preserve PublicQueues(UBound(PublicQueues)-1)
GetPublicQueues = PublicQueues

End Function

Function NewQueueInstance(Computer,QueuePath,PublicQueue)

Dim oQueue, QueueInfo, sMessage

Set oQueue = New Queue
oQueue.ComputerName = Computer
oQueue.PathName = QueuePath
oQueue.IsPublic = CBool(PublicQueue)

'Validate that we have access to the queue.
'If not, we will throw an error and continue.
'If so, we will gather available settings.
On Error Resume Next
Set QueueInfo = CreateObject("MSMQ.MSMQQueueInfo")
QueueInfo.PathName = QueuePath
QueueInfo.Refresh

If Err = 0 Then

On Error GoTo 0
oQueue.FormatName = QueueInfo.FormatName
oQueue.IsTransactional = CBool(QueueInfo.IsTransactional)
oQueue.Label = QueueInfo.Label
oQueue.PrivilegeLevel = QueueInfo.PrivLevel
oQueue.Quota = QueueInfo.Quota
oQueue.JournalEnabled = CBool(QueueInfo.Journal)
oQueue.JournalQuota = QueueInfo.JournalQuota

If oQueue.IsPublic = True Then oQueue.AdsPath = QueueInfo.ADsPath
If QueueInfo.ServiceTypeGuid = "{55EE8F33-CCE9-11CF-B108-0020AFD61CE9}" Then
oQueue.IsTestQueue = True
Else
oQueue.IsTestQueue = False
End If

Set NewQueueInstance = oQueue

Else

On Error GoTo 0
sMessage = 	"Error connecting to queue: " &amp; QueuePath &amp; "." &amp; VbCrLf &amp; _
"Validate that the MSMQ Queue Access profile has access to read the queue properties."
Call ThrowScriptError(EVENTNO_ERROR_COULDNOTOPENQUEUE,EVENT_LEVEL_ERROR,sMessage,False)

Set NewQueueInstance = Nothing

End If

End Function

Sub SubmitQueue(NewQueue)
Dim oInstance
Set oInstance = oDiscoveryData.CreateClassInstance("$MPElement[Name='MSMQ.Queue']$")
With oInstance
.AddProperty "$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", NewQueue.ComputerName
.AddProperty "$MPElement[Name='MSMQ.Queue']/PathName$",NewQueue.PathName
.AddProperty "$MPElement[Name='MSMQ.Queue']/IsPublic$",NewQueue.IsPublic
.AddProperty "$MPElement[Name='MSMQ.Queue']/FormatName$",NewQueue.FormatName
.AddProperty "$MPElement[Name='MSMQ.Queue']/IsTransactional$",NewQueue.IsTransactional
.AddProperty "$MPElement[Name='MSMQ.Queue']/Label$",NewQueue.Label
.AddProperty "$MPElement[Name='MSMQ.Queue']/PrivilegeLevel$",NewQueue.PrivilegeLevel
.AddProperty "$MPElement[Name='MSMQ.Queue']/Quota$",NewQueue.Quota
.AddProperty "$MPElement[Name='MSMQ.Queue']/JournalEnabled$",NewQueue.JournalEnabled
.AddProperty "$MPElement[Name='MSMQ.Queue']/JournalQuota$",NewQueue.JournalQuota
.AddProperty "$MPElement[Name='MSMQ.Queue']/ADsPath$",NewQueue.ADsPath
.AddProperty "$MPElement[Name='MSMQ.Queue']/IsTestQueue$",NewQueue.IsTestQueue
End With

Call oDiscoveryData.AddInstance(oInstance)

End Sub

Sub WriteDetailEvent(NewQueue)
Dim sMessage
sMessage = 	"PrincipalName: " &amp; NewQueue.ComputerName &amp; VbCrLf &amp; _
"Public: " &amp; NewQueue.IsPublic &amp; VbCrLf &amp; _
"PathName: " &amp; NewQueue.PathName &amp; VbCrLf &amp; _
"ADsPath: "  &amp; NewQueue.ADsPath &amp; VbCrLf &amp; _
"Format Name: "  &amp; NewQueue.FormatName &amp; VbCrLf &amp; _
"IsTransactional: " &amp; NewQueue.IsTransactional &amp; VbCrLf &amp; _
"Label: " &amp; NewQueue.Label &amp; VbCrLf &amp; _
"PrivilegeLevel: "  &amp; NewQueue.PrivilegeLevel
Call LogDetail(EVENTNO_FOUND_QUEUE,sMessage)

End Sub

Sub WriteQueueToRegistry(NewQueue,Computer)
Dim oReg, sRegRoot
Set oReg=GetObject("winmgmts:\\" &amp; Computer &amp; "\root\default:StdRegProv")

If NewQueue.IsPublic = True Then

sRegRoot = MSMQ_REGROOT &amp; "\" &amp; Computer &amp; "\" &amp; PUBLICQUEUE_VALUENAME &amp; "\" &amp; NewQueue.Label
oReg.CreateKey HKEY_LOCAL_MACHINE,sRegRoot
oReg.SetStringValue HKEY_LOCAL_MACHINE,sRegRoot,"PathName",NewQueue.PathName
oReg.SetStringValue HKEY_LOCAL_MACHINE,sRegRoot,"FormatName",NewQueue.FormatName
oReg.SetStringValue HKEY_LOCAL_MACHINE,sRegRoot,"Quota",NewQueue.Quota
oReg.SetStringValue HKEY_LOCAL_MACHINE,sRegRoot,"JournalEnabled",NewQueue.JournalEnabled
oReg.SetStringValue HKEY_LOCAL_MACHINE,sRegRoot,"JournalQuota",NewQueue.JournalQuota

End If

End Sub


Sub InitializeRegistry(Computer,KeyPath,ValueName)
Dim oReg
Set oReg=GetObject("winmgmts:\\" &amp; Computer &amp; "\root\default:StdRegProv")

oReg.CreateKey HKEY_LOCAL_MACHINE,KeyPath
oReg.CreateKey HKEY_LOCAL_MACHINE,KeyPath &amp; "\" &amp; Computer
oReg.CreateKey HKEY_LOCAL_MACHINE,KeyPath &amp; "\" &amp; Computer &amp; "\" &amp; PUBLICQUEUE_VALUENAME

End Sub


Sub AddToPublicQueuesRegistry(Computer,KeyPath,ValueName,Value)
Dim oReg, sValue, i

Set oReg=GetObject("winmgmts:\\" &amp; Computer &amp; "\root\default:StdRegProv")
Call oReg.GetMultiStringValue(HKEY_LOCAL_MACHINE,KeyPath,ValueName,aValues)
i = 0

For Each sValue In aValues
ReDim Preserve aNewValues(i)
aNewValues(i) = sValue
i=i+1
Next

ReDim Preserve aNewValues(i)
aNewValues(i) = Value
Call oReg.SetMultiStringValue(HKEY_LOCAL_MACHINE,KeyPath,ValueName,aNewValues)

End Sub

Sub ThrowScriptError(EventNo,Severity,Message,Abort)

Message = VbCrLf &amp; Message
Call oAPI.LogScriptEvent(SCRIPT_NAME,EventNo,Severity,Message)
If Abort = True Then WScript.Quit

End Sub


Sub LogDetail(EventNo,Message)

Message = VbCrLf &amp; "Calling MP Element ID: $MPElement$" &amp; vbcrlf &amp;  Message
If bLogDetail = True Then
Call oAPI.LogScriptEvent(SCRIPT_NAME,EventNo,EVENT_LEVEL_INFO,Message)
End If

End Sub

Function IsMSMQServiceRunning()
Dim WMI, Services, Service
Set WMI = GetObject("winmgmts:\\" &amp; sComputer &amp; "\root\cimv2")
Set Services = WMI.ExecQuery("select * from win32_service where name = '" &amp; sServiceName &amp; "'")
For Each Service In Services
If lcase(Service.State) = "running" Then
IsMSMQServiceRunning = True
Else
IsMSMQServiceRunning = False
End If
Next

End Function

Sub ShowUsage

WScript.Echo "Usage: "
WScript.Echo "cscript DiscoverQueues.vbs &lt;CallingRuleGUID&gt; &lt;TargetEntityGUID&gt; &lt;Computer&gt; &lt;ServiceName&gt; &lt;DiscoverPublicQueues&gt; &lt;DiscoverPrivateQueues&gt; &lt;WorkgroupServer&gt; &lt;LogDetail&gt;"
WScript.Echo
WScript.Echo "Example:"
WScript.Echo "cscript DiscoverQueues.vbs {b3e9befe-173b-78a2-3e41-e19ecb58d9d5} {2fa43439-afc4-cc64-9b3a-9642ec898c1c} srv1.contoso.com true true false false"

WScript.Quit

End Sub

Class Queue

Public ComputerName
Public PathName
Public FormatName
Public IsPublic
Public IsTransactional
Public Label
Public PrivilegeLevel
Public Quota
Public JournalEnabled
Public JournalQuota
Public AdsPath
Public IsTestQueue

End Class</ScriptBody>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </DataSource>
            </MemberModules>
            <Composition>
              <Node ID="DS" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.Discovery.Data</OutputType>
      </DataSourceModuleType>
      <WriteActionModuleType ID="MSMQ.PurgeQueue.WA" Accessibility="Public" RunAs="MSMQ.RunAsProfile" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Computer" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="QueuePath" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="TimeoutSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <WriteAction ID="WA" TypeID="Windows!Microsoft.Windows.ScriptWriteAction">
                <ScriptName>PurgeQueue.js</ScriptName>
                <Arguments>"$Config/Computer$" "$Config/QueuePath$"</Arguments>
                <ScriptBody>var SCRIPT_NAME = "PurgeQueue.js";

var MQ_RECEIVE_ACCESS = 1;
var MQ_SEND_ACCESS = 2;
var MQ_PEEK_ACCESS = 32;
var MQ_DENY_NONE = 0;
var MQ_DENY_RECEIVE_SHARE = 1;

var SCRIPT_PURGE_ERROR = -2;

var objArgs = WScript.Arguments;
var strComputer = objArgs(0);
var strQueuePathName = objArgs(1);

var bIsCluster = false;
var objWshShell;

if(IsCluster(strComputer))
{
    bIsCluster = true;
    var WshShell = new ActiveXObject("WScript.Shell");
    objWshShell = WshShell.Environment("Process");
    var sName = GetQueueServer(strComputer);
    objWshShell("_CLUSTER_NETWORK_NAME_") = sName;
    objWshShell("_CLUSTER_NETWORK_HOSTNAME_") = sName;
}

try
{
    var objMSMQQueueInfo = new ActiveXObject("MSMQ.MSMQQueueInfo");
    objMSMQQueueInfo.PathName = strQueuePathName;
    objMSMQQueueInfo.Refresh();
    var objQueue = objMSMQQueueInfo.Open(MQ_RECEIVE_ACCESS,MQ_DENY_NONE);
    objQueue.Purge();
}
catch (e)
{
    PrintError(e);
    FailScript(SCRIPT_PURGE_ERROR,"Failed on attempt to purge queue.");
}

if(bIsCluster)
{
    objWshShell.Remove("_CLUSTER_NETWORK_NAME_");
    objWshShell.Remove("_CLUSTER_NETWORK_HOSTNAME_");
}

WScript.Echo("Successfully purged queue.")

function GetQueueServer(Path)
{
    return (Path.split(".",1))
}


function IsCluster(sComputer)
{
    var wshNetwork = new ActiveXObject("Wscript.Network");
    var st1 = String(wshNetwork.ComputerName);
    var st2 = String(GetQueueServer(sComputer));

    if (st1.toLowerCase() != st2.toLowerCase())
    {
        return (true)
    }
    else
    {
        return (false)
    }
}

function PrintError(error)
{
    WScript.Echo("============================ BEGIN SCRIPT ERROR ================================\n");
    WScript.Echo("Script Name : " + SCRIPT_NAME);
    WScript.Echo("Error Type : " + error);
    WScript.Echo("Error Number : " + error.number);
    WScript.Echo("Error Code : " + (error.number &amp;0xFFFF));
    WScript.Echo("Win32 Facility : " + (error.number&gt;&gt;16 &amp;0x1FFF));
    WScript.Echo("Error Source : " + error.Source);
    WScript.Echo("Error Description : " + error.description + "\n");
    WScript.Echo("============================= END SCRIPT ERROR =================================\n");
}

function FailScript(errorCode, errorDescription)
{
    WScript.Echo("============================ BEGIN SCRIPT ERROR ================================\n");
    WScript.Echo("Script Name : " + SCRIPT_NAME);
    WScript.Echo("Script Exit Code : " + errorCode);
    WScript.Echo("Script Error Message : " +errorDescription + "\n");
    WScript.Echo("============================= END SCRIPT ERROR =================================");
    WScript.Quit(errorCode);
}
</ScriptBody>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </WriteAction>
            </MemberModules>
            <Composition>
              <Node ID="WA" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <InputType>System!System.BaseData</InputType>
      </WriteActionModuleType>
      <WriteActionModuleType ID="MSMQ.TrimQueue.WA" Accessibility="Public" RunAs="MSMQ.RunAsProfile" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Computer" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="QueuePath" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="0" maxOccurs="1" name="TargetQueue" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="TrimLogic" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="0" maxOccurs="1" name="NumericParameter" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="TimeoutSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="TrimLogic" Selector="$Config/TrimLogic$" ParameterType="string" />
          <OverrideableParameter ID="NumericParameter" Selector="$Config/NumericParameter$" ParameterType="int" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <WriteAction ID="WA" TypeID="Windows!Microsoft.Windows.ScriptWriteAction">
                <ScriptName>TrimQueue.vbs</ScriptName>
                <Arguments>"$Config/Computer$" "$Config/QueuePath$" "$Config/TrimLogic$" $Config/NumericParameter$</Arguments>
                <ScriptBody>option explicit
SetLocale("en-us")

Const SCRIPT_NAME = "TrimQueue.vbs"

Const MQ_RECEIVE_ACCESS	= 1
Const MQ_SEND_ACCESS	= 2
Const MQ_PEEK_ACCESS	= 32
Const MQ_ADMIN_ACCESS	= 128

Const MQ_DENY_NONE	= 0
Const MQ_DENY_RECEIVE_SHARE	= 1

Const MQ_MTS_TRANSACTION	= 1
Const MQ_XA_TRANSACTION		= 2
Const MQ_SINGLE_MESSAGE		= 3

Const EVENTNO_SCRIPT_STARTED	= 14501
Const EVENTNO_SCRIPT_ENDED		= 14502
Const EVENTNO_MESSAGES_REMOVED	= 14531
Const EVENTNO_QUEUE_PURGED		= 14532
Const EVENTNO_ERROR_BADLOGIC	= 14590


Const EVENT_LEVEL_ERROR 	= 1
Const EVENT_LEVEL_WARNING 	= 2
Const EVENT_LEVEL_INFO 		= 4

Dim oApi
Dim sComputer, sQueuePath, sLogic, wshNetwork, sDomain, sUser, sMessage
Dim bIsCluster, WshShell, objWshShell, sName
Dim oQueueInfo, oJournalInfo, oMgmt, oJournalMgmt, oJournal, oMessage
Dim oInitialStats, oRunningStats, iMessagesRemoved, dKBytesRemoved, bShowSummary, dLatestDateRemoved, dCutoffDate
Dim dTargetQuotaPctg, iMinutes, dKbytes, dTargetSize

sComputer = WScript.Arguments(0)
sQueuePath = WScript.Arguments(1)
sLogic = WScript.Arguments(2)

Set oAPI = CreateObject("MOM.ScriptAPI")

Set wshNetwork = CreateObject("Wscript.Network")
sDomain = wshNetwork.UserDomain
sUser = wshNetwork.UserName
sMessage =	"Starting Script: " &amp; SCRIPT_NAME &amp; VbCrLf &amp; _
"User credentials: " &amp; sDomain &amp; "\" &amp; sUser &amp; VbCrLf &amp; _
"Network  Name: " &amp; wshNetwork.ComputerName &amp; VbCrLf &amp; _
"Computer Name: " &amp; sComputer &amp; VbCrLf &amp; _
"Queue Path: " &amp; sQueuePath &amp; VbCrLf &amp; _
"Logic: " &amp; sLogic

Call oAPI.LogScriptEvent(SCRIPT_NAME,EVENTNO_SCRIPT_STARTED,EVENT_LEVEL_INFO,sMessage)
Wscript.Echo sMessage

bIsCluster = false
If IsCluster = True then
bIsCluster = true
set WshShell = CreateObject("WScript.Shell")
set objWshShell = WshShell.Environment("Process")
sName = GetQueueServer(sComputer)
objWshShell("_CLUSTER_NETWORK_NAME_") = sName
objWshShell("_CLUSTER_NETWORK_HOSTNAME_") = sName
End If

Set oQueueInfo = CreateObject("MSMQ.MSMQQueueInfo")
Set oJournalInfo = CreateObject("MSMQ.MSMQQueueInfo")
Set oMgmt = CreateObject("MSMQ.MSMQManagement")
Set oJournalMgmt = CreateObject("MSMQ.MSMQManagement")

On Error resume next
oQueueInfo.PathName = sQueuePath
oQueueInfo.Refresh
oJournalInfo.FormatName = oQueueInfo.FormatName &amp; ";JOURNAL"
Set oJournal = oJournalInfo.Open(MQ_RECEIVE_ACCESS,MQ_DENY_NONE)
Call oMgmt.Init(sComputer, , "DIRECT=OS:" &amp; sQueuePath)
if Err &lt;&gt; 0 then
sMessage =  "There was an error" &amp; VbCrLf &amp; _
"Error Number: " &amp; Err.Number &amp; VbCrLf &amp; _
"Error Description: " &amp; Err.Description
Call ThrowScriptError(EVENTNO_ERROR_BADLOGIC,EVENT_LEVEL_WARNING,sMessage)
End if

Set oInitialStats = New QueueStat
Set oRunningStats = New QueueStat

iMessagesRemoved = 0
dKBytesRemoved = 0
Select Case lcase(sLogic)

Case "quota"
bShowSummary = True
dTargetQuotaPctg = CDbl(WScript.Arguments(3))
While oRunningStats.JournalQuotaPctg &gt; dTargetQuotaPctg
Set oMessage = oJournal.Receive(MQ_SINGLE_MESSAGE, False, True, 5, False)
oRunningStats.Refresh
iMessagesRemoved = iMessagesRemoved + 1
dLatestDateRemoved = oMessage.ArrivedTime
Wend

Case "time"
bShowSummary = True
iMinutes = WScript.Arguments(3)
dCutoffDate = DateAdd("n",-iMinutes,Now)
Set oMessage = oJournal.Receive(MQ_SINGLE_MESSAGE, False, True, 5, False)
oRunningStats.Refresh
iMessagesRemoved = 1
While oMessage.ArrivedTime &lt; dCutoffDate
Set oMessage = oJournal.Receive(MQ_SINGLE_MESSAGE, False, True, 5, False)
iMessagesRemoved = iMessagesRemoved + 1
dKBytesRemoved = dKBytesRemoved + (CDbl(oMgmt.BytesInJournal) / 1000)
dLatestDateRemoved = oMessage.ArrivedTime
Wend

Case "kbytes"
bShowSummary = True
dKbytes = WScript.Arguments(3)
Set oMessage = oJournal.Receive(MQ_SINGLE_MESSAGE, False, True, 5, False)
oRunningStats.Refresh
dTargetSize = oInitialStats.KBytesInJournalQueue - dKbytes
While oRunningStats.KBytesInJournalQueue &gt; dTargetSize
Set oMessage = oJournal.Receive(MQ_SINGLE_MESSAGE, False, True, 5, False)
iMessagesRemoved = iMessagesRemoved + 1
dKBytesRemoved = dKBytesRemoved + (CDbl(oMgmt.BytesInJournal) / 1000)
dLatestDateRemoved = oMessage.ArrivedTime
oRunningStats.Refresh
Wend

Case "purge"
bShowSummary = True
oJournal.Purge
oRunningStats.Refresh

Case "statistics"
bShowSummary = False
WScript.Echo oInitialStats.GetSummary

Case Else
sMessage = 	"Bad argument provided for trimming logic." &amp; VbCrLf &amp; _
"Possible values are quota, time, kbytes, or purge." &amp; VbCrLf &amp; _
"Argument provided: " &amp; sLogic
Call ThrowScriptError(EVENTNO_ERROR_BADLOGIC,EVENT_LEVEL_WARNING,sMessage)

End Select

If bShowSummary = True Then
sMessage = 	"Messages were removed from queue journal." &amp; VbCrLf &amp; _
"Queue: " &amp; sQueuePath &amp; VbCrLf &amp; _
"Algorithm: " &amp; sLogic &amp; VbCrLf &amp; _
"Messages removed: " &amp; iMessagesRemoved &amp; VbCrLf &amp; _
"KBytes removed: " &amp; dKBytesRemoved &amp; VbCrLf &amp; _
"Latest date removed: " &amp; dLatestDateRemoved &amp; VbCrLf &amp; _
VbCrLf &amp; _
"Initial statistics: " &amp; VbCrLf &amp; _
oInitialStats.GetSummary &amp; VbCrLf &amp; _
VbCrLf &amp; _
"Final statistics: " &amp; VbCrLf &amp; _
oRunningStats.GetSummary

Call oAPI.LogScriptEvent(SCRIPT_NAME,EVENTNO_MESSAGES_REMOVED,EVENT_LEVEL_WARNING,sMessage)
WScript.Echo sMessage
End If

if bIsCluster = true then
objWshShell.Remove("_CLUSTER_NETWORK_NAME_")
objWshShell.Remove("_CLUSTER_NETWORK_HOSTNAME_")
End If

Call oAPI.LogScriptEvent(SCRIPT_NAME,EVENTNO_SCRIPT_ENDED,EVENT_LEVEL_INFO,"TrimQueue.vbs finished.")

Function GetQueueServer(Path)

	If InStr(Path,".") &gt; 0 Then
		GetQueueServer = Left(Path,InStr(Path,".")-1)
	Else
		GetQueueServer = Path
	End If

End Function

Function IsCluster()
Dim wshNetwork

Set wshNetwork = CreateObject("Wscript.Network")
if StrComp(wshNetwork.ComputerName, GetQueueServer(sComputer), 1) &lt;&gt; 0 then
IsCluster = True
else
IsCluster = False
End if

End Function

Sub ThrowScriptError(EventNo,Severity,Message)

Message = "Script aborted due to the following script error:" &amp; VbCrLf &amp; Message
Call oAPI.LogScriptEvent(SCRIPT_NAME,EventNo,Severity,Message)
WScript.Quit

End Sub

Class QueueStat

Private Sub Class_Initialize()
ComputerName = sComputer
QueuePath = sQueuePath
Me.Refresh
End Sub

Public Sub Refresh()

Quota = oQueueInfo.Quota
JournalQuota = oQueueInfo.JournalQuota
MessagesInQueue = oMgmt.MessageCount
KBytesInQueue = CDbl(oMgmt.BytesInQueue) / 1000
MessagesInJournalQueue = oMgmt.JournalMessageCount
KBytesInJournalQueue = CDbl(oMgmt.BytesInJournal) / 1000
If oQueueInfo.Quota &gt; 0 Then
QuotaPctg = (CDbl(oMgmt.BytesInQueue) / 1000) / (CDbl(oQueueInfo.Quota)) * 100
Else
QuotaPctg = 0
End If
If oQueueInfo.JournalQuota &gt; 0 Then
JournalQuotaPctg = (CDbl(oMgmt.BytesInJournal) / 1000) / (CDbl(oQueueInfo.JournalQuota)) * 100
Else
JournalQuotaPctg = 0
End If

End Sub

Public Function GetSummary

With Me

GetSummary =	"Computer Name: " &amp; .ComputerName &amp; VbCrLf &amp; _
"Queue Path: " &amp; .QueuePath &amp; VbCrLf &amp; _
"Quota: " &amp; .Quota &amp; VbCrLf &amp; _
"Journal Quota: " &amp; .JournalQuota &amp; VbCrLf &amp; _
"Messages in Queue: " &amp; .MessagesInQueue &amp; VbCrLf &amp; _
"KBytes in Queue: " &amp; .KBytesInQueue &amp; VbCrLf &amp; _
"Quota Pctg: " &amp; .QuotaPctg &amp; VbCrLf &amp; _
"Messages in Journal Queue: " &amp; .MessagesInJournalQueue &amp; VbCrLf &amp; _
"KBytes in Journal Queue: " &amp; .KBytesInJournalQueue &amp; VbCrLf &amp; _
"Journal Quota Pctg: " &amp; .JournalQuotaPctg
End With

End Function

Public ComputerName
Public QueuePath
Public Quota
Public JournalQuota
Public MessagesInQueue
Public KBytesInQueue
Public QuotaPctg
Public MessagesInJournalQueue
Public KBytesInJournalQueue
Public JournalQuotaPctg

End Class</ScriptBody>
                <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              </WriteAction>
            </MemberModules>
            <Composition>
              <Node ID="WA" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <InputType>System!System.BaseData</InputType>
      </WriteActionModuleType>
    </ModuleTypes>
    <MonitorTypes>
      <UnitMonitorType ID="MSMQ.QueuePerformance.MonitorType" Accessibility="Internal">
        <MonitorTypeStates>
          <MonitorTypeState ID="Error" NoDetection="false" />
          <MonitorTypeState ID="Warning" NoDetection="false" />
          <MonitorTypeState ID="Success" NoDetection="false" />
        </MonitorTypeStates>
        <Configuration>
          <xsd:element minOccurs="1" type="xsd:integer" name="IntervalSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="ComputerName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
		  <xsd:element minOccurs="1" type="xsd:string" name="DebugLogging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />	
          <xsd:element minOccurs="1" type="xsd:integer" name="TimeoutSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="QueueName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="CounterName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="WarningThreshold" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="CriticalThreshold" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
		  <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="string" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
          <OverrideableParameter ID="WarningThreshold" Selector="$Config/WarningThreshold$" ParameterType="int" />
          <OverrideableParameter ID="CriticalThreshold" Selector="$Config/CriticalThreshold$" ParameterType="int" />
        </OverrideableParameters>
        <MonitorImplementation>
          <MemberModules>
            <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
              <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
              <ComputerName>$Config/ComputerName$</ComputerName>
              <DebugLogging>$Config/DebugLogging$</DebugLogging>			  
              <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
              <QueueName>$Config/QueueName$</QueueName>
            </DataSource>
            <ConditionDetection ID="HealthyCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                  </ValueExpression>
                  <Operator>Less</Operator>
                  <ValueExpression>
                    <Value Type="Integer">$Config/WarningThreshold$</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="WarningCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <And>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                      </ValueExpression>
                      <Operator>GreaterEqual</Operator>
                      <ValueExpression>
                        <Value Type="Integer">$Config/WarningThreshold$</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                      </ValueExpression>
                      <Operator>Less</Operator>
                      <ValueExpression>
                        <Value Type="Integer">$Config/CriticalThreshold$</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                </And>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="CriticalCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                  </ValueExpression>
                  <Operator>GreaterEqual</Operator>
                  <ValueExpression>
                    <Value Type="Integer">$Config/CriticalThreshold$</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
          </MemberModules>
          <RegularDetections>
            <RegularDetection MonitorTypeStateID="Error">
              <Node ID="CriticalCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Success">
              <Node ID="HealthyCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Warning">
              <Node ID="WarningCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
          </RegularDetections>
        </MonitorImplementation>
      </UnitMonitorType>
      <UnitMonitorType ID="MSMQ.ServerPerformance.MonitorType" Accessibility="Internal">
        <MonitorTypeStates>
          <MonitorTypeState ID="Error" NoDetection="false" />
          <MonitorTypeState ID="Warning" NoDetection="false" />
          <MonitorTypeState ID="Success" NoDetection="false" />
        </MonitorTypeStates>
        <Configuration>
          <xsd:element minOccurs="1" type="xsd:integer" name="IntervalSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="ComputerName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
		  <xsd:element minOccurs="1" type="xsd:string" name="DebugLogging" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="TimeoutSeconds" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:string" name="CounterName" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="WarningThreshold" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" type="xsd:integer" name="CriticalThreshold" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
		  <OverrideableParameter ID="DebugLogging" Selector="$Config/DebugLogging$" ParameterType="string" />
          <OverrideableParameter ID="TimeoutSeconds" Selector="$Config/TimeoutSeconds$" ParameterType="int" />
          <OverrideableParameter ID="WarningThreshold" Selector="$Config/WarningThreshold$" ParameterType="int" />
          <OverrideableParameter ID="CriticalThreshold" Selector="$Config/CriticalThreshold$" ParameterType="int" />
        </OverrideableParameters>
        <MonitorImplementation>
          <MemberModules>
            <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
              <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
              <ComputerName>$Config/ComputerName$</ComputerName>
			  <DebugLogging>$Config/DebugLogging$</DebugLogging>
              <TimeoutSeconds>$Config/TimeoutSeconds$</TimeoutSeconds>
            </DataSource>
            <ConditionDetection ID="HealthyCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                  </ValueExpression>
                  <Operator>Less</Operator>
                  <ValueExpression>
                    <Value Type="Integer">$Config/WarningThreshold$</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="WarningCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <And>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                      </ValueExpression>
                      <Operator>GreaterEqual</Operator>
                      <ValueExpression>
                        <Value Type="Integer">$Config/WarningThreshold$</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                      </ValueExpression>
                      <Operator>Less</Operator>
                      <ValueExpression>
                        <Value Type="Integer">$Config/CriticalThreshold$</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                </And>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="CriticalCondition" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery Type="Integer">Property[@Name='$Config/CounterName$']</XPathQuery>
                  </ValueExpression>
                  <Operator>GreaterEqual</Operator>
                  <ValueExpression>
                    <Value Type="Integer">$Config/CriticalThreshold$</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
          </MemberModules>
          <RegularDetections>
            <RegularDetection MonitorTypeStateID="Error">
              <Node ID="CriticalCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Success">
              <Node ID="HealthyCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Warning">
              <Node ID="WarningCondition">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
          </RegularDetections>
        </MonitorImplementation>
      </UnitMonitorType>	  
    </MonitorTypes>
  </TypeDefinitions>
  <Monitoring>
    <Discoveries>
      <Discovery ID="MSMQ.Client.Discovery" Enabled="false" Target="Windows!Microsoft.Windows.Client.Computer" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="MSMQ.Server" />
          <DiscoveryClass TypeID="MSMQ.Trigger" />			  
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="MSMQ.Server.Discovery.DS">
          <IntervalSeconds>86403</IntervalSeconds>
          <ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <IsVirtualNode>false</IsVirtualNode>
          <DebugLogging>true</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.ComputersAndWatchers.Group.Discovery" Enabled="true" Target="MSMQ.ComputersAndWatchers.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="Windows!Microsoft.Windows.Computer"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <Contains>
                  <MonitoringClass>$MPElement[Name="MSMQ.Server"]$</MonitoringClass>
                </Contains>
              </Expression>
            </MembershipRule>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="SC!Microsoft.SystemCenter.HealthServiceWatcher"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <Contains>
                  <MonitoringClass>$MPElement[Name="SC!Microsoft.SystemCenter.HealthService"]$</MonitoringClass>
                  <Expression>
                    <Contained>
                      <MonitoringClass>$MPElement[Name="Windows!Microsoft.Windows.Computer"]$</MonitoringClass>
                      <Expression>
                        <Contained>
                          <MonitoringClass>$Target/Id$</MonitoringClass>
                        </Contained>
                      </Expression>
                    </Contained>
                  </Expression>
                </Contains>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.Discovery" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="MSMQ.Queue" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="MSMQ.Queue.Discovery.DS">
          <IntervalSeconds>86405</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
          <ServiceName>$Target/Property[Type="MSMQ.Server"]/ServiceName$</ServiceName>
          <DiscoverPublic>true</DiscoverPublic>
          <DiscoverPrivate>true</DiscoverPrivate>
          <WorkgroupServer>$Target/Property[Type="MSMQ.Server"]/Workgroup$</WorkgroupServer>
          <LogDetail>true</LogDetail>
          <TimeoutSeconds>300</TimeoutSeconds>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.NonTransactional.Group.Discovery" Enabled="true" Target="MSMQ.Queue.NonTransactional.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="GP" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="MSMQ.Queue"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Property>$MPElement[Name="MSMQ.Queue"]/IsTransactional$</Property>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>false</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.PrivateQueues.Group.Discovery" Enabled="true" Target="MSMQ.Queue.Private.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="GroupPopulation" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="MSMQ.Queue"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Property>$MPElement[Name="MSMQ.Queue"]/IsPublic$</Property>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>false</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.PublicQueues.Group.Discovery" Enabled="true" Target="MSMQ.Queue.Public.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="GroupPopulation" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="MSMQ.Queue"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Property>$MPElement[Name="MSMQ.Queue"]/IsPublic$</Property>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.TestQueues.Group.Discovery" Enabled="true" Target="MSMQ.Queue.Test.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="GroupPopulation" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="MSMQ.Queue"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Property>$MPElement[Name="MSMQ.Queue"]/IsTestQueue$</Property>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>false</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Queue.Transactional.Group.Discovery" Enabled="true" Target="MSMQ.Queue.Transactional.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities" />
        </DiscoveryTypes>
        <DataSource ID="GP" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="MSMQ.Queue"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="MSIL!Microsoft.SystemCenter.InstanceGroupContainsEntities"]$</RelationshipClass>
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Property>$MPElement[Name="MSMQ.Queue"]/IsTransactional$</Property>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value>true</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Seed.Discovery" Enabled="true" Target="Windows!Microsoft.Windows.Server.Computer" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="MSMQ.Seed">
            <Property PropertyID="IsVirtualNode" />
          </DiscoveryClass>
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.WmiProviderWithClassSnapshotDataMapper">
          <NameSpace>root\cimv2</NameSpace>
          <Query>SELECT Name FROM Win32_ServerFeature WHERE ID = 49</Query>
          <Frequency>86397</Frequency>
          <ClassId>$MPElement[Name="MSMQ.Seed"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="MSMQ.Seed"]/IsVirtualNode$</Name>
                <Value>$Target/Property[Type="Windows!Microsoft.Windows.Server.Computer"]/IsVirtualNode$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
        </DataSource>
      </Discovery>
      <Discovery ID="MSMQ.Server.Discovery" Enabled="true" Target="MSMQ.Seed" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="MSMQ.Server" />
          <DiscoveryClass TypeID="MSMQ.Trigger" />		  
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="MSMQ.Server.Discovery.DS">
          <IntervalSeconds>86399</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
          <IsVirtualNode>$Target/Property[Type="MSMQ.Seed"]/IsVirtualNode$</IsVirtualNode>
          <DebugLogging>true</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
        </DataSource>
      </Discovery>
    </Discoveries>
    <Rules>
      <Rule ID="MSMQ.Server.ProcessPercentProcessorTime.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>Process</ObjectName>
          <CounterName>% Processor Time</CounterName>
          <InstanceName>mqsvc</InstanceName>
          <Value>$Data/Property[@Name='CPUValue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>	
      <Rule ID="MSMQ.Server.ProcessPrivateMBytes.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>Process</ObjectName>
          <CounterName>Private MBytes</CounterName>
          <InstanceName>mqsvc</InstanceName>
          <Value>$Data/Property[@Name='MemoryValueMB']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>	
      <Rule ID="MSMQ.Server.TotalMessagesInAllQueues.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Total messages in all queues</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='TotalMessagesInAllQueues']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>	
      <Rule ID="MSMQ.Server.TotalKBytesInAllQueues.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Total Kbytes in all queues</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='TotalKBytesInAllQueues']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
	  <Rule ID="MSMQ.Server.Sessions.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Sessions</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='Sessions']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
	  <Rule ID="MSMQ.Server.IncomingMessagesSec.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Incoming Messages/sec</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='IncomingMessagesSec']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
	  <Rule ID="MSMQ.Server.OutgoingMessagesSec.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Outgoing Messages/sec</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='OutgoingMessagesSec']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
	  <Rule ID="MSMQ.Server.KBytesInDeadLetterQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>KBytes In Dead Letter Queue</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='KBytesInDeadLetterQueue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
	  <Rule ID="MSMQ.Server.MessagesInDeadLetterQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Server" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.ServerStats.DS">
            <IntervalSeconds>901</IntervalSeconds>
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Service</ObjectName>
          <CounterName>Messages In Dead Letter Queue</CounterName>
          <InstanceName></InstanceName>
          <Value>$Data/Property[@Name='MessagesInDeadLetterQueue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>	
      <Rule ID="MSMQ.Queue.QueuePercentUsed.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>Queue Percent Used</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='Queue Percent Used']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Queue.JournalPercentUsed.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>Journal Percent Used</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='Journal Percent Used']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>	  
      <Rule ID="MSMQ.Queue.KBytesInJournalQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>KBytes In Journal Queue</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='KBytes In Journal Queue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Queue.KBytesInQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>KBytes In Queue</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='KBytes In Queue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Queue.MessagesInJournalQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>Messages In Journal Queue</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='Messages In Journal Queue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Queue.MessagesInQueue.PerformanceCollection.Rule" Enabled="true" Target="MSMQ.Queue" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="MSMQ.QueueStats.Filtered.DS">
            <IntervalSeconds>903</IntervalSeconds>
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
			<DebugLogging>false</DebugLogging>
            <TimeoutSeconds>300</TimeoutSeconds>
            <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="System.Performance.DataGenericMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>MSMQ Queue</ObjectName>
          <CounterName>Messages In Queue</CounterName>
          <InstanceName>$Data/Property[@Name='NetBIOSName']$\$Data/Property[@Name='QueueName']$</InstanceName>
          <Value>$Data/Property[@Name='Messages In Queue']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2000" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2000</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2000.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2001" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2001</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2001.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2002" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>MSMQ Cluster Resource DLL</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2002</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2002.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2003" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>MSMQ Cluster Resource DLL</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2003</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2003.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2015" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2015</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2015.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2020" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2020</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2020.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2023" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2023</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2023.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2035" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2035</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2035.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2043" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2043</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2043.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2044" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2044</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2044.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2047" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2047</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2047.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2053" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2053</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2053.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2059" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2059</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2059.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2061" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2061</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2061.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2064" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2064</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2064.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2068" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2068</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2068.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2076" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2076</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2076.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2079" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2079</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>2</Priority>
            <Severity>2</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2079.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2083" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2083</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2083.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2084" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2084</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2084.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2085" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2085</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2085.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2096" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2096</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2096.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2097" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2097</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2097.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2116" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2116</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2116.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2117" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2117</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2117.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2118" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2118</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2118.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2120" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2120</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2120.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2122" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2122</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2122.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2123" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2123</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2123.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2124" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2124</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2124.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2127" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2197</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2127.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2140" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2140</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2140.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2141" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2141</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2141.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2142" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2142</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2142.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2143" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2143</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2143.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2145" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2145</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2145.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2147" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2147</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2147.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2148" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2148</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2148.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2155" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2155</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2155.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2156" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2156</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2156.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2157" Enabled="false" Target="MSMQ.Queue" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2157</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Params/Param[2]</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Queue"]/PathName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2157.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2158" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2158</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2158.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2160" Enabled="false" Target="MSMQ.Queue" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2160</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2160.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2161" Enabled="false" Target="MSMQ.Queue" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2161</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Params/Param[2]</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Queue"]/PathName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2161.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2164" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2164</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2164.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2165" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2165</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2165.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2168" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2168</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2168.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2169" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2169</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2169.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2170" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2170</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2170.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2171" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2171</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2171.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2172" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2172</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2172.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2175" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2175</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2175.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2177" Enabled="false" Target="MSMQ.Queue" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2177</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Params/Param[1]</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Queue"]/PathName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2177.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2182" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2182</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2182.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2183" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2183</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GeneralAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2183.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2184" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2184</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2184.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2185" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2185</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2185.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2187" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2187</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2187.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2188" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2188</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2188.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2189" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2189</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GeneralAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2189.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2190" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2190</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2190.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2191" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2192</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2191.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2192" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2192</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2192.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2193" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2193</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2193.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2194" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2194</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2194.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression />
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2195" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2195</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2195.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2196" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2196</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2196.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2197" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2197</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2197.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2198" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2198</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2198.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2199" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2199</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>2</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2199.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2201" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2201</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2201.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2202" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2202</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2202.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2203" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2203</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2203.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2204" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2204</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2204.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2205" Enabled="false" Target="MSMQ.Queue" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2205</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Params/Param[1]</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Queue"]/PathName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2205.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2206" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2206</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2206.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2207" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2207</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2207.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2208" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2208</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2208.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2209" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2209</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2209.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2210" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2210</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2210.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2212" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2212</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2212.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2213" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>MSMQ Triggers Cluster Resource DLL</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2213</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2213.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2214" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>MSMQ Triggers Cluster Resource DLL</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2214</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2214.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2215" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2215</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2215.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2219" Enabled="false" Target="MSMQ.Trigger" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Host/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2219</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2219.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2220" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2220</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2220.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2250" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery>EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value>2250</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GeneralAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2250.AlertName"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2251" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>AvailabilityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2251</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2251.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2253" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2253</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2253.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2254" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>SecurityHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2254</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2254.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2255" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2255</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2255.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
      <Rule ID="MSMQ.Rule.Alert.Event2256" Enabled="false" Target="MSMQ.Server" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>ConfigurationHealth</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider">
            <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
            <LogName>Application</LogName>
            <Expression>
              <And>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="UnsignedInteger">2256</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">PublisherName</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Target/Property[Type="MSMQ.Server"]/ServiceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </And>
            </Expression>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>1</Priority>
            <Severity>1</Severity>
            <AlertName />
            <AlertDescription />
            <AlertOwner />
            <AlertMessageId>$MPElement[Name="MSMQ.Rule.Alert.Event2256.AlertMessage"]$</AlertMessageId>
            <AlertParameters>
              <AlertParameter1>$Data/EventDescription$</AlertParameter1>
            </AlertParameters>
            <Suppression>
              <SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue>
              <SuppressionValue>$Data/LoggingComputer$</SuppressionValue>
            </Suppression>
            <Custom1 />
            <Custom2 />
            <Custom3 />
            <Custom4 />
            <Custom5 />
            <Custom6 />
            <Custom7 />
            <Custom8 />
            <Custom9 />
            <Custom10 />
          </WriteAction>
        </WriteActions>
      </Rule>
    </Rules>
    <Tasks>
      <Task ID="MSMQ.GetQueueStats.Task" Accessibility="Internal" Enabled="true" Target="MSMQ.Queue" Timeout="300" Remotable="true">
        <Category>Maintenance</Category>
        <WriteAction ID="WA" TypeID="MSMQ.TrimQueue.WA">
          <Computer>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</Computer>
          <QueuePath>$Target/Property[Type="MSMQ.Queue"]/PathName$</QueuePath>
          <TrimLogic>statistics</TrimLogic>
          <TimeoutSeconds>300</TimeoutSeconds>
        </WriteAction>
      </Task>
      <Task ID="MSMQ.PurgeQueue.Task" Accessibility="Internal" Enabled="true" Target="MSMQ.Queue" Timeout="300" Remotable="true">
        <Category>Maintenance</Category>
        <WriteAction ID="WA" TypeID="MSMQ.PurgeQueue.WA">
          <Computer>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</Computer>
          <QueuePath>$Target/Property[Type="MSMQ.Queue"]/PathName$</QueuePath>
          <TimeoutSeconds>300</TimeoutSeconds>
        </WriteAction>
      </Task>
      <Task ID="MSMQ.StartService.Task" Accessibility="Public" Enabled="true" Target="MSMQ.Server" Timeout="300" Remotable="true">
        <Category>Custom</Category>
        <WriteAction ID="PA" TypeID="System!System.CommandExecuter">
          <ApplicationName>%windir%\system32\net.exe</ApplicationName>
          <WorkingDirectory />
          <CommandLine>start $Target/Property[Type="MSMQ.Server"]/ServiceName$ /y</CommandLine>
          <TimeoutSeconds>300</TimeoutSeconds>
          <RequireOutput>true</RequireOutput>
          <Files />
        </WriteAction>
      </Task>
      <Task ID="MSMQ.StartService.Triggers.Task" Accessibility="Public" Enabled="true" Target="MSMQ.Trigger" Timeout="300" Remotable="true">
        <Category>Custom</Category>
        <WriteAction ID="PA" TypeID="System!System.CommandExecuter">
          <ApplicationName>%windir%\system32\net.exe</ApplicationName>
          <WorkingDirectory />
          <CommandLine>start $Target/Property[Type="MSMQ.Trigger"]/ServiceName$ /y</CommandLine>
          <TimeoutSeconds>300</TimeoutSeconds>
          <RequireOutput>true</RequireOutput>
        </WriteAction>
      </Task>
      <Task ID="MSMQ.StopService.Task" Accessibility="Public" Enabled="true" Target="MSMQ.Server" Timeout="300" Remotable="true">
        <Category>Custom</Category>
        <WriteAction ID="PA" TypeID="System!System.CommandExecuter">
          <ApplicationName>%windir%\system32\net.exe</ApplicationName>
          <WorkingDirectory />
          <CommandLine>stop $Target/Property[Type="MSMQ.Server"]/ServiceName$ /y</CommandLine>
          <TimeoutSeconds>300</TimeoutSeconds>
          <RequireOutput>true</RequireOutput>
          <Files />
        </WriteAction>
      </Task>
      <Task ID="MSMQ.StopService.Triggers.Task" Accessibility="Public" Enabled="true" Target="MSMQ.Trigger" Timeout="300" Remotable="true">
        <Category>Custom</Category>
        <WriteAction ID="PA" TypeID="System!System.CommandExecuter">
          <ApplicationName>%windir%\system32\net.exe</ApplicationName>
          <WorkingDirectory />
          <CommandLine>stop $Target/Property[Type="MSMQ.Trigger"]/ServiceName$ /y</CommandLine>
          <TimeoutSeconds>30</TimeoutSeconds>
          <RequireOutput>true</RequireOutput>
        </WriteAction>
      </Task>
      <Task ID="MSMQ.TrimJournalQueue.Task" Accessibility="Internal" Enabled="true" Target="MSMQ.Queue" Timeout="300" Remotable="true">
        <Category>Maintenance</Category>
        <WriteAction ID="WA" TypeID="MSMQ.TrimQueue.WA">
          <Computer>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</Computer>
          <QueuePath>$Target/Property[Type="MSMQ.Queue"]/PathName$</QueuePath>
          <TargetQueue>journal</TargetQueue>
          <TrimLogic>quota</TrimLogic>
          <NumericParameter>60</NumericParameter>
          <TimeoutSeconds>300</TimeoutSeconds>
        </WriteAction>
      </Task>
    </Tasks>
    <Monitors>
      <UnitMonitor ID="MSMQ.Server.ProcessPercentProcessorTime.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.ProcessPercentProcessorTime.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="CPUValue"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>CPUValue</CounterName>
          <WarningThreshold>60</WarningThreshold>
          <CriticalThreshold>80</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Server.ProcessPrivateMBytes.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.ProcessPrivateMBytes.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="MemoryValueMB"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>MemoryValueMB</CounterName>
          <WarningThreshold>2048</WarningThreshold>
          <CriticalThreshold>4096</CriticalThreshold>
        </Configuration>
      </UnitMonitor>	  
      <UnitMonitor ID="MSMQ.Server.IncomingMessagesSec.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.IncomingMessagesSec.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="IncomingMessagesSec"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>IncomingMessagesSec</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Server.OutgoingMessagesSec.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.OutgoingMessagesSec.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="OutgoingMessagesSec"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>OutgoingMessagesSec</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Server.TotalKBytesInAllQueues.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.TotalKBytesInAllQueues.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="TotalKBytesInAllQueues"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>TotalKBytesInAllQueues</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Server.TotalMessagesInAllQueues.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.ServerPerformance.MonitorType" ConfirmDelivery="false">
        <Category>PerformanceHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Server.TotalMessagesInAllQueues.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="TotalMessagesInAllQueues"]$</AlertParameter1>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>901</IntervalSeconds>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <CounterName>TotalMessagesInAllQueues</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Queue.QueuePercentUsed.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.QueuePercentUsed.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="Queue Percent Used"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>Queue Percent Used</CounterName>
          <WarningThreshold>60</WarningThreshold>
          <CriticalThreshold>80</CriticalThreshold>
        </Configuration>
      </UnitMonitor>	  
      <UnitMonitor ID="MSMQ.Queue.JournalPercentUsed.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.JournalPercentUsed.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="Journal Percent Used"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>Journal Percent Used</CounterName>
          <WarningThreshold>60</WarningThreshold>
          <CriticalThreshold>80</CriticalThreshold>
        </Configuration>
      </UnitMonitor>	  
      <UnitMonitor ID="MSMQ.Queue.KBytesInJournalQueue.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.KBytesInJournalQueue.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="KBytes In Journal Queue"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>KBytes In Journal Queue</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Queue.KBytesInQueue.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.KBytesInQueue.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="KBytes In Queue"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>KBytes In Queue</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Queue.MessagesInJournalQueue.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.MessagesInJournalQueue.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="Messages In Journal Queue"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>Messages In Journal Queue</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Queue.MessagesInQueue.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" TypeID="MSMQ.QueuePerformance.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Queue.MessagesInQueue.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Data/Context/Property[@Name="QueueName"]$</AlertParameter1>
            <AlertParameter2>$Data/Context/Property[@Name="Messages In Queue"]$</AlertParameter2>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <IntervalSeconds>903</IntervalSeconds>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</ComputerName>
		  <DebugLogging>false</DebugLogging>
          <TimeoutSeconds>300</TimeoutSeconds>
          <QueueName>$Target/Property[Type="MSMQ.Queue"]/Label$</QueueName>
          <CounterName>Messages In Queue</CounterName>
          <WarningThreshold>500</WarningThreshold>
          <CriticalThreshold>1000</CriticalThreshold>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Service.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Service.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>Error</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" />
          <OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
          <ServiceName>$Target/Property[Type="MSMQ.Server"]/ServiceName$</ServiceName>
          <CheckStartupType>true</CheckStartupType>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="MSMQ.Triggers.Service.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Trigger" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="MSMQ.Triggers.Service.Monitor.AlertMessage">
          <AlertOnState>Error</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>Error</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" />
          <OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <ComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
          <ServiceName>$Target/Property[Type="MSMQ.Trigger"]/ServiceName$</ServiceName>
          <CheckStartupType>true</CheckStartupType>
        </Configuration>
      </UnitMonitor>
      <DependencyMonitor ID="MSMQ.QueueToServer.Availability.Rollup.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" RelationshipType="MSMQ.ServerHostsQueue.Relationship" MemberMonitor="Health!System.Health.AvailabilityState">
        <Category>AvailabilityHealth</Category>
        <Algorithm>WorstOf</Algorithm>
        <MemberUnAvailable>Error</MemberUnAvailable>
      </DependencyMonitor>
      <DependencyMonitor ID="MSMQ.QueueToServer.Performance.Rollup.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" RelationshipType="MSMQ.ServerHostsQueue.Relationship" MemberMonitor="Health!System.Health.PerformanceState">
        <Category>PerformanceHealth</Category>
        <Algorithm>WorstOf</Algorithm>
        <MemberUnAvailable>Error</MemberUnAvailable>
      </DependencyMonitor>
      <DependencyMonitor ID="MSMQ.TriggerToServer.Availability.Rollup.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" RelationshipType="MSMQ.ServerHostsTriggers.Relationship" MemberMonitor="Health!System.Health.AvailabilityState">
        <Category>AvailabilityHealth</Category>
        <Algorithm>WorstOf</Algorithm>
        <MemberUnAvailable>Error</MemberUnAvailable>
      </DependencyMonitor>
      <DependencyMonitor ID="MSMQ.TriggerToServer.Performance.Rollup.Monitor" Accessibility="Public" Enabled="true" Target="MSMQ.Server" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="true" Priority="Normal" RelationshipType="MSMQ.ServerHostsTriggers.Relationship" MemberMonitor="Health!System.Health.PerformanceState">
        <Category>PerformanceHealth</Category>
        <Algorithm>WorstOf</Algorithm>
        <MemberUnAvailable>Error</MemberUnAvailable>
      </DependencyMonitor>
    </Monitors>
  </Monitoring>
  <Presentation>
    <Views>
      <View ID="MSMQ.All.Alerts.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <ResolutionState>
            <StateRange Operator="NotEquals">255</StateRange>
          </ResolutionState>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="1" Width="22" Grouped="true" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Severity</Name>
            <Id>Severity</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="54" Grouped="false" Sorted="false" IsSortable="false" Visible="true" SortOrder="Ascending">
            <Name>Icon</Name>
            <Id>Icon</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Path</Name>
            <Id>MonitoringObjectPath</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Source</Name>
            <Id>MonitoringObjectDisplayName</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="22" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>MonitoringObjectInMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="250" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>Name</Id>
          </ColumnInfo>
          <ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Resolution State</Name>
            <Id>ResolutionState</Id>
          </ColumnInfo>
          <ColumnInfo Index="7" SortIndex="0" Width="150" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>Created</Name>
            <Id>TimeRaised</Id>
          </ColumnInfo>
          <ColumnInfo Index="8" SortIndex="1" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Age</Name>
            <Id>Age</Id>
          </ColumnInfo>
          <ColumnInfo Index="9" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Type</Name>
            <Id>Category</Id>
          </ColumnInfo>
          <ColumnInfo Index="10" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Owner</Name>
            <Id>Owner</Id>
          </ColumnInfo>
          <ColumnInfo Index="11" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Priority</Name>
            <Id>Priority</Id>
          </ColumnInfo>
          <ColumnInfo Index="12" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Latency</Name>
            <Id>Latency</Id>
          </ColumnInfo>
          <ColumnInfo Index="13" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Description</Name>
            <Id>Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="14" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Connector</Name>
            <Id>ConnectorId</Id>
          </ColumnInfo>
          <ColumnInfo Index="15" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Forwarding Status</Name>
            <Id>ConnectorStatus</Id>
          </ColumnInfo>
          <ColumnInfo Index="16" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Class</Name>
            <Id>Class</Id>
          </ColumnInfo>
          <ColumnInfo Index="17" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Time in State</Name>
            <Id>TimeInState</Id>
          </ColumnInfo>
        </Presentation>
        <Target />
      </View>
      <View ID="MSMQ.MessagesInDeadLetterQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Messages in Dead Letter Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.KBytesInDeadLetterQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>KBytes in Dead Letter Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.KBytesInJournalQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>KBytes In Journal Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.KBytesInQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>KBytes In Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.MessagesInJournalQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Messages In Journal Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.MessagesInQueue.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Messages In Queue</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.TotalKBytesInAllQueues.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Total Kbytes in all queues</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.TotalMessagesInAllQueues.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Total messages in all queues</Counter>
        </Criteria>
        <Target />
      </View>
      <View ID="MSMQ.Queues.State.View" Accessibility="Public" Enabled="true" Target="MSMQ.Queue" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria />
        <Presentation>
          <ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>State</Name>
            <Id>MSMQ.Queue</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="22" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="150" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Display Name</Name>
            <Id>DisplayName</Id>
          </ColumnInfo>	
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Label</Name>
            <Id>Label</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Quota</Name>
            <Id>Quota</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>JournalQuota</Name>
            <Id>JournalQuota</Id>
          </ColumnInfo>
          <ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>IsTransactional</Name>
            <Id>IsTransactional</Id>
          </ColumnInfo>			  
        </Presentation>		
      </View>
      <View ID="MSMQ.Server.State.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria />
        <Presentation>
          <ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>State</Name>
            <Id>MSMQ.Server</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="22" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="150" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Display Name</Name>
            <Id>DisplayName</Id>
          </ColumnInfo>	
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Version</Name>
            <Id>Version</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="150" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>ServiceName</Name>
            <Id>ServiceName</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="80" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>IsClustered</Name>
            <Id>IsClustered</Id>
          </ColumnInfo>			  
        </Presentation>		  
      </View>
      <View ID="MSMQ.Triggers.State.View" Accessibility="Public" Enabled="true" Target="MSMQ.Trigger" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria />
        <Presentation>
          <ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>State</Name>
            <Id>MSMQ.Trigger</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="22" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="150" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Display Name</Name>
            <Id>DisplayName</Id>
          </ColumnInfo>	
          <ColumnInfo Index="3" SortIndex="-1" Width="200" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>ServiceName</Name>
            <Id>ServiceName</Id>
          </ColumnInfo>
        </Presentation>			
      </View>
      <View ID="MSMQ.All.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria />
        <Target />
      </View>
      <View ID="MSMQ.Sessions.Performance.View" Accessibility="Public" Enabled="true" Target="MSMQ.Server" TypeID="SC!Microsoft.SystemCenter.PerformanceViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <Counter>Sessions</Counter>
        </Criteria>
        <Target />
      </View>
    </Views>
    <Folders>
      <Folder ID="MSMQ.Root.Folder" Accessibility="Public" ParentFolder="SC!Microsoft.SystemCenter.Monitoring.ViewFolder.Root" />
      <Folder ID="MSMQ.PerformanceViews.Folder" Accessibility="Public" ParentFolder="MSMQ.Root.Folder" />
    </Folders>
    <FolderItems>
      <FolderItem ElementID="MSMQ.All.Alerts.View" ID="MSMQ.All.Alerts.View.FolderItem" Folder="MSMQ.Root.Folder" />
      <FolderItem ElementID="MSMQ.Queues.State.View" ID="MSMQ.Queues.State.View.FolderItem" Folder="MSMQ.Root.Folder" />
      <FolderItem ElementID="MSMQ.MessagesInDeadLetterQueue.Performance.View" ID="MSMQ.MessagesInDeadLetterQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.KBytesInDeadLetterQueue.Performance.View" ID="MSMQ.KBytesInDeadLetterQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.KBytesInJournalQueue.Performance.View" ID="MSMQ.KBytesInJournalQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.KBytesInQueue.Performance.View" ID="MSMQ.KBytesInQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.MessagesInJournalQueue.Performance.View" ID="MSMQ.MessagesInJournalQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.MessagesInQueue.Performance.View" ID="MSMQ.MessagesInQueue.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.Server.State.View" ID="MSMQ.Server.State.View.FolderItem" Folder="MSMQ.Root.Folder" />
      <FolderItem ElementID="MSMQ.TotalKBytesInAllQueues.Performance.View" ID="MSMQ.TotalKBytesInAllQueues.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.TotalMessagesInAllQueues.Performance.View" ID="MSMQ.TotalMessagesInAllQueues.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.Triggers.State.View" ID="MSMQ.Triggers.State.View.FolderItem" Folder="MSMQ.Root.Folder" />
      <FolderItem ElementID="MSMQ.All.Performance.View" ID="MSMQ.All.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
      <FolderItem ElementID="MSMQ.Sessions.Performance.View" ID="MSMQ.Sessions.Performance.View.FolderItem" Folder="MSMQ.PerformanceViews.Folder" />
    </FolderItems>
    <StringResources>
      <StringResource ID="MSMQ.Server.ProcessPercentProcessorTime.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Server.ProcessPrivateMBytes.Monitor.AlertMessage" />	  
      <StringResource ID="MSMQ.Server.IncomingMessagesSec.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Server.OutgoingMessagesSec.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Server.TotalKBytesInAllQueues.Monitor.AlertMessage" />	  
      <StringResource ID="MSMQ.Server.TotalMessagesInAllQueues.Monitor.AlertMessage" />
	  <StringResource ID="MSMQ.Queue.QueuePercentUsed.Monitor.AlertMessage" />
	  <StringResource ID="MSMQ.Queue.JournalPercentUsed.Monitor.AlertMessage" />	  
	  <StringResource ID="MSMQ.Queue.MessagesInQueue.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Queue.KBytesInQueue.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Queue.MessagesInJournalQueue.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Queue.KBytesInJournalQueue.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Service.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Triggers.Service.Monitor.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2199.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2000.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2001.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2002.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2003.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2015.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2020.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2023.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2035.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2043.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2044.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2047.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2053.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2059.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2061.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2064.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2068.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2076.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2079.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2083.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2084.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2085.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2096.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2097.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2116.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2117.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2118.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2120.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2122.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2123.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2124.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2127.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2140.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2141.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2142.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2143.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2145.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2147.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2148.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2155.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2156.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2157.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2158.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2160.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2161.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2164.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2165.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2168.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2169.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2170.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2171.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2172.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2175.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2177.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2182.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2183.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2184.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2185.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2187.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2188.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2189.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2190.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2191.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2192.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2193.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2194.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2195.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2196.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2197.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2198.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2201.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2202.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2203.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2204.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2205.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2206.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2207.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2208.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2209.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2210.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2212.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2213.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2214.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2215.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2219.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2220.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2250.AlertName" />
      <StringResource ID="MSMQ.Rule.Alert.Event2251.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2253.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2254.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2255.AlertMessage" />
      <StringResource ID="MSMQ.Rule.Alert.Event2256.AlertMessage" />
    </StringResources>
  </Presentation>
  <LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="MSMQ">
          <Name>MSMQ Management Pack</Name>
          <Description>MSMQ MP for Windows Server 2012 and Later.  This Management Pack will discover and monitor Microsoft Message Queuing Version 6 and later.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.Monitor">
          <Name>MSMQ Queue Percent Used Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.Monitor.AlertMessage">
          <Name>MSMQ Queue Percent Used exceeds threshold</Name>
          <Description>The current Queue Percent Used is above the threshold.
Queue Percent Used: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.Monitor">
          <Name>MSMQ Journal Percent Used Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.Monitor.AlertMessage">
          <Name>MSMQ Journal Percent Used exceeds threshold</Name>
          <Description>The current Journal Percent Used is above the threshold.
Journal Percent Used: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.Monitor">
          <Name>MSMQ Server Process Percent ProcessorTime Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.Monitor.AlertMessage">
          <Name>MSMQ Server Process Percent Processor Time exceeds threshold</Name>
          <Description>The current Process Percent Processor Time is above the threshold.
CPU Value of all processes: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.Monitor">
          <Name>MSMQ Server Process Private MBytes Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.Monitor.AlertMessage">
          <Name>MSMQ Server Process Private MBytes exceeds threshold</Name>
          <Description>The current Process Private MBytes is above the threshold.
Value in MB of all processes: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.Monitor">
          <Name>MSMQ Server Total Messages In All Queues Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.Monitor.AlertMessage">
          <Name>MSMQ Server Total Messages In All Queues exceeds threshold</Name>
          <Description>The current Total Messages In All Queues is above the threshold.
Value: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.Monitor">
          <Name>MSMQ Server Total KBytes In All Queues Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.Monitor.AlertMessage">
          <Name>MSMQ Server Total KBytes In All Queues exceeds threshold</Name>
          <Description>The current Total KBytes In All Queues is above the threshold.
Value: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.Monitor">
          <Name>MSMQ Server Outgoing Messages/sec Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.Monitor.AlertMessage">
          <Name>MSMQ Server Outgoing Messages/sec exceeds threshold</Name>
          <Description>The current Outgoing Messages/sec is above the threshold.
Value: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.Monitor">
          <Name>MSMQ Server Incoming Messages/sec Monitor</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.Monitor.AlertMessage">
          <Name>MSMQ Server Incoming Messages/sec exceeds threshold</Name>
          <Description>The current Incoming Messages/sec is above the threshold.
Value: {0}
</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.All.Alerts.View">
          <Name>Alerts</Name>
          <Description>All alerts generated from the Message Queuing management pack.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.All.Performance.View">
          <Name>All Performance</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.Monitor">
          <Name>MSMQ KBytes In Journal Queue Monitor</Name>
          <Description>Monitor the number of KBytes in the Journal queue against a threshold.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.Monitor.AlertMessage">
          <Name>MSMQ KBytes In Journal Queue exceeds threshold</Name>
          <Description>The current KBytes In Journal Queue is above the threshold.
Queue Name: {0}
KBytes In Journal Queue: {1}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInJournalQueue.PerformanceCollection.Rule">
          <Name>MSMQ - KBytes In Journal Queue PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.QueuePercentUsed.PerformanceCollection.Rule">
          <Name>MSMQ - Queue Percent Used PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.JournalPercentUsed.PerformanceCollection.Rule">
          <Name>MSMQ - Journal Percent Used PerformanceCollection Rule</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.Monitor">
          <Name>MSMQ KBytes In Queue Monitor</Name>
          <Description>Monitor the number of KBytes in the queue against a threshold.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.Monitor.AlertMessage">
          <Name>MSMQ KBytes In Queue exceeds threshold</Name>
          <Description>The current KBytes In Queue is above the threshold.
Queue Name: {0}
KBytes In Queue: {1}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.KBytesInQueue.PerformanceCollection.Rule">
          <Name>MSMQ - KBytes In Queue PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPercentProcessorTime.PerformanceCollection.Rule">
          <Name>MSMQ - Server Process Percent Processor Time PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.ProcessPrivateMBytes.PerformanceCollection.Rule">
          <Name>MSMQ - Server Process Private MBytes PerformanceCollection Rule</Name>
        </DisplayString>		
        <DisplayString ElementID="MSMQ.Client.Discovery">
          <Name>Discover MSMQ Clients</Name>
          <Description>Discover MSMQ Clients</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.ComputersAndWatchers.Group">
          <Name>MSMQ Servers - Group</Name>
          <Description>Group of all MSMQ Servers</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.ComputersAndWatchers.Group.Discovery">
          <Name>Populate MSMQ Servers - Group</Name>
          <Description>This discovery rule populates the group 'MSMQ Servers - Group'</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.MessagesInDeadLetterQueue.Performance.View">
          <Name>Messages in Dead Letter Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.KBytesInDeadLetterQueue.Performance.View">
          <Name>KBytes In Dead Letter Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.GetQueueStats.Task">
          <Name>Get Queue Statistics</Name>
          <Description>Gets the real time statistics from the queue selected.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.KBytesInJournalQueue.Performance.View">
          <Name>KBytes In Journal Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.KBytesInQueue.Performance.View">
          <Name>KBytes In Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.Monitor">
          <Name>MSMQ Messages In Journal Queue Monitor</Name>
          <Description>Monitor the number of messages in the Journal queue against a threshold.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.Monitor.AlertMessage">
          <Name>MSMQ Messages In Journal Queue exceeds threshold</Name>
          <Description>The current Messages In Journal Queue is above the threshold.
Queue Name: {0}
Messages In Journal Queue: {1}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.MessagesInJournalQueue.Performance.View">
          <Name>Messages In Journal Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInJournalQueue.PerformanceCollection.Rule">
          <Name>MSMQ - Messages In Journal Queue PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.Monitor">
          <Name>MSMQ Messages In Queue Monitor</Name>
          <Description>Monitor the number of messages in the queue against a threshold.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.Monitor.AlertMessage">
          <Name>MSMQ Messages In Queue exceeds threshold</Name>
          <Description>The current Messages In Queue is above the threshold.
Queue Name: {0}
Messages In Queue: {1}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.Monitor" SubElementID="Error">
          <Name>Error</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.Monitor" SubElementID="Success">
          <Name>Success</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.MessagesInQueue.PerformanceCollection.Rule">
          <Name>MSMQ - Messages In Queue PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.PerformanceViews.Folder">
          <Name>Performance</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.PurgeQueue.Task">
          <Name>Purge Queue</Name>
          <Description>Removes all messages in the Queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue">
          <Name>MSMQ Queue</Name>
          <Description>An MSMQ Queue</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Discovery">
          <Name>Discover MSMQ Queues</Name>
          <Description>Discover MSMQ Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.NonTransactional.Group">
          <Name>MSMQ NonTransactional Queues - Group</Name>
          <Description>Group of all MSMQ NonTransactional Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.NonTransactional.Group.Discovery">
          <Name>Populate MSMQ NonTransactional Queues Group</Name>
          <Description>This Discovery populates the group "MSMQ NonTransactional Queues - Group".</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Private.Group">
          <Name>MSMQ Private Queues - Group</Name>
          <Description>Group of all MSMQ Private Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.PrivateQueues.Group.Discovery">
          <Name>Populate MSMQ Private Queues Group</Name>
          <Description>This discovery rule populates the group 'MSMQ Private Queues - Group'</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Public.Group">
          <Name>MSMQ Public Queues - Group</Name>
          <Description>Group of all MSMQ Public Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.PublicQueues.Group.Discovery">
          <Name>Populate MSMQ Public Queues Group</Name>
          <Description>This discovery rule populates the group 'MSMQ Public Queues - Group'</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Test.Group">
          <Name>MSMQ Test Queues Group</Name>
          <Description>Group of all MSMQ Test Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.TestQueues.Group.Discovery">
          <Name>Populate MSMQ Test Queues - Group</Name>
          <Description>This discovery rule populates the group 'MSMQ Test Queues - Group'</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Transactional.Group">
          <Name>MSMQ Transactional Queues - Group</Name>
          <Description>Group of all MSMQ Transactional Queues</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue.Transactional.Group.Discovery">
          <Name>Populate MSMQ Transactional Queues - Group</Name>
          <Description>This discovery populates the group 'MSMQ Transactional Queues - Group'</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="ADsPath">
          <Name>ADsPath</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="FormatName">
          <Name>Format Name</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="IsPublic">
          <Name>Public</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="IsTestQueue">
          <Name>Test Queue</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="IsTransactional">
          <Name>Transactional</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="JournalEnabled">
          <Name>Journal Enabled</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="JournalQuota">
          <Name>Journal Quota</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="Label">
          <Name>Label</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.MessagesInQueue.Performance.View">
          <Name>Messages In Queue</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="PathName">
          <Name>Path Name</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="PrivilegeLevel">
          <Name>Privilege Level</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queue" SubElementID="Quota">
          <Name>Quota</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Queues.State.View">
          <Name>Queues</Name>
          <Description>State of all queues with its complete set of properties for columns.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.QueueToServer.Availability.Rollup.Monitor">
          <Name>MSMQ Queues Availability Health Rollup Monitor</Name>
          <Description>MSMQ Queue Health Rollup</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.QueueToServer.Performance.Rollup.Monitor">
          <Name>MSMQ Queues Performance Health Rollup Monitor</Name>
          <Description>MSMQ Queue Health Rollup</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Root.Folder">
          <Name>MSMQ</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2000">
          <Name>The Message Queuing service cannot start due to bad registry value.</Name>
          <Description>The Message Queuing service cannot start due to bad registry value.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2000.AlertName">
          <Name>The Message Queuing service cannot start due to bad registry value.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2001">
          <Name>The Message Queuing service cannot start due to inability to write a registry key.</Name>
          <Description>The Message Queuing service cannot start due to inability to write a registry key.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2001.AlertName">
          <Name>The Message Queuing service cannot start due to inability to write a registry key.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2002">
          <Name>At least one of the required dependencies was not found. </Name>
          <Description>At least one of the required dependencies was not found. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2002.AlertName">
          <Name>At least one of the required dependencies was not found. </Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2003">
          <Name>There are insufficient memory resources.</Name>
          <Description>There are insufficient memory resources.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2003.AlertName">
          <Name>There are insufficient memory resources.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2015">
          <Name>The Message Queuing service is not online with Active Directory.</Name>
          <Description>The Message Queuing service is not online with Active Directory.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2015.AlertName">
          <Name>The Message Queuing service is not online with Active Directory.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2020">
          <Name>The Message Queuing service cannot start due to internal private queue problem.</Name>
          <Description>The Message Queuing service cannot start due to internal private queue problem.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2020.AlertName">
          <Name>The Message Queuing service cannot start due to internal private queue problem.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2023">
          <Name>The Message Queuing service cannot start due to problem with message store.</Name>
          <Description>The Message Queuing service cannot start due to problem with message store.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2023.AlertName">
          <Name>The Message Queuing service cannot start due to problem with message store.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2035">
          <Name>The Message Queuing service cannot start due to problem with Active Directory interface.</Name>
          <Description>The Message Queuing service cannot start due to problem with Active Directory interface.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2035.AlertName">
          <Name>The Message Queuing service cannot start due to problem with Active Directory interface.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2043">
          <Name>The Message Queuing service deleted a message that couldn't be restored because the queue doesn't exist.</Name>
          <Description>The Message Queuing service deleted a message that couldn't be restored because the queue doesn't exist.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2043.AlertMessage">
          <Name>The Message Queuing service deleted a message that couldn't be restored because the queue doesn't exist.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2044">
          <Name>The Message Queuing service has insufficient privileges to create audit log messages.</Name>
          <Description>The Message Queuing service has insufficient privileges to create audit log messages.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2044.AlertName">
          <Name>The Message Queuing service has insufficient privileges to create audit log messages.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2047">
          <Name>The Message Queuing service cannot start due to problem with DTC.</Name>
          <Description>The Message Queuing service cannot start due to problem with DTC.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2047.AlertName">
          <Name>The Message Queuing service cannot start due to problem with DTC.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2053">
          <Name>The Message Queuing service cannot start due to problem with incoming sequences checkpoint file.</Name>
          <Description>The Message Queuing service cannot start due to problem with incoming sequences checkpoint file.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2053.AlertName">
          <Name>The Message Queuing service cannot start due to problem with incoming sequences checkpoint file.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2059">
          <Name>MSMQ Server RPC interface cannot use the TCP/IP protocol.</Name>
          <Description>MSMQ Server RPC interface cannot use the TCP/IP protocol.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2059.AlertName">
          <Name>MSMQ Server RPC interface cannot use the TCP/IP protocol.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2061">
          <Name>The Message Queuing service cannot start due to problem with local RPC interface.</Name>
          <Description>The Message Queuing service cannot start due to problem with local RPC interface.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2061.AlertName">
          <Name>The Message Queuing service cannot start due to problem with local RPC interface.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2064">
          <Name>The Message Queuing service cannot start due to problem with transactions checkpoint file.</Name>
          <Description>The Message Queuing service cannot start due to problem with transactions checkpoint file.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2064.AlertName">
          <Name>The Message Queuing service cannot start due to problem with transactions checkpoint file.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2068">
          <Name>The list of Message Queuing servers with directory service functionality in the Windows registry is empty.</Name>
          <Description>The list of Message Queuing servers with directory service functionality in the Windows registry is empty.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2068.AlertName">
          <Name>The list of Message Queuing servers with directory service functionality in the Windows registry is empty.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2076">
          <Name>Logger files cannot be initialized.</Name>
          <Description>Logger files cannot be initialized.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2076.AlertName">
          <Name>Logger files cannot be initialized.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2079">
          <Name>The Message Queueing sevice cannot start.</Name>
          <Description>The Message Queuing service cannot start because the log file cannot be recovered.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2079.AlertMessage">
          <Name>The Message Queuing service cannot start</Name>
          <Description>The Message Queuing service cannot start because the log file cannot be recovered. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2083">
          <Name>The Message Queuing service cannot start due to problem with log files.</Name>
          <Description>The Message Queuing service cannot start due to problem with log files.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2083.AlertName">
          <Name>The Message Queuing service cannot start due to problem with log files.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2084">
          <Name>The Message Queuing service cannot start because a queue is in an inconsistent state.</Name>
          <Description>The Message Queuing service cannot start because a queue is in an inconsistent state.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2084.AlertName">
          <Name>The Message Queuing service cannot start because a queue is in an inconsistent state.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2085">
          <Name>The message file cannot be created due to insufficient disk space or memory</Name>
          <Description>The message file cannot be created due to insufficient disk space or memory</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2085.AlertName">
          <Name>The message file cannot be created due to insufficient disk space or memory.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2096">
          <Name>The Message Queuing folder cannot be created.</Name>
          <Description>The Message Queuing folder cannot be created.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2096.AlertMessage">
          <Name>The Message Queuing folder cannot be created.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2097">
          <Name>The Message Queuing registry values cannot be read. The registry is probably corrupted.</Name>
          <Description>The Message Queuing registry values cannot be read. The registry is probably corrupted.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2097.AlertMessage">
          <Name>The Message Queuing registry values cannot be read. The registry is probably corrupted.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2116">
          <Name>Message Queuing was unable to create the MSMQ object in Active Directory.</Name>
          <Description>Message Queuing was unable to create the MSMQ object in Active Directory.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2116.AlertName">
          <Name>Message Queuing was unable to create the MSMQ object in Active Directory.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2117">
          <Name>Message Queuing was unable to load Mqupgrd.dll.</Name>
          <Description>Message Queuing was unable to load Mqupgrd.dll.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2117.AlertName">
          <Name>Message Queuing was unable to load Mqupgrd.dll.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2118">
          <Name>Message Queuing was unable to find the address of MqCreateMsmqObj in Mqupgrd.dll.</Name>
          <Description>Message Queuing was unable to find the address of MqCreateMsmqObj in Mqupgrd.dll.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2118.AlertName">
          <Name>Message Queuing was unable to find the address of MqCreateMsmqObj in Mqupgrd.dll.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2120">
          <Name>The Message Queuing service was unable to obtain the properties of the MSMQ object from Active Directory.</Name>
          <Description>The Message Queuing service was unable to obtain the properties of the MSMQ object from Active Directory.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2120.AlertName">
          <Name>The Message Queuing service was unable to obtain the properties of the MSMQ object from Active Directory.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2122">
          <Name>This domain controller is not trusted for delegation.</Name>
          <Description>This domain controller is not trusted for delegation. Therefore, the Message Queuing server cannot run.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2122.AlertMessage">
          <Name>This domain controller is not trusted for delegation.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2123">
          <Name>The Message Queuing server cannot determine if the local domain controller is trusted for delegation.</Name>
          <Description>The Message Queuing server cannot determine if the local domain controller is trusted for delegation.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2123.AlertName">
          <Name>The Message Queuing server cannot determine if the local domain controller is trusted for delegation.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2124">
          <Name>The Message Queuing service failed to join the computer's domain.</Name>
          <Description>The Message Queuing service failed to join the computer's domain.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2124.AlertName">
          <Name>The Message Queuing service failed to join the computer's domain.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2127">
          <Name>Message Queuing objects cannot move automatically between domains</Name>
          <Description>Message Queuing objects cannot move automatically between domains</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2127.AlertMessage">
          <Name>Message Queuing objects cannot move automatically between domains</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2140">
          <Name>This server was unable to resolve the IP addresses of other routing servers.</Name>
          <Description>This server was unable to resolve the IP addresses of other routing servers.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2140.AlertName">
          <Name>This server was unable to resolve the IP addresses of other routing servers.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2141">
          <Name>The properties of the queue cannot be set. Copying the queue file to the temporary file returned an error.</Name>
          <Description>The properties of the queue cannot be set. Copying the queue file to the temporary file returned an error.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2141.AlertMessage">
          <Name>The properties of the queue cannot be set. Copying the queue file to the temporary file returned an error.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2142">
          <Name>The properties of the queue cannot be set. Replacing the queue fil with the temporary file returned error.</Name>
          <Description>The properties of the queue cannot be set. Replacing the queue fil with the temporary file returned error.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2142.AlertMessage">
          <Name>The properties of the queue cannot be set. Replacing the queue fil with the temporary file returned error.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2143">
          <Name>The Microsoft Distributed Transaction Coordinator (DTC) failed.</Name>
          <Description>The Microsoft Distributed Transaction Coordinator (DTC) failed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2143.AlertName">
          <Name>The Microsoft Distributed Transaction Coordinator (DTC) failed.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2145">
          <Name>Computer object not found in Active Directory.</Name>
          <Description>Computer object not found in Active Directory, possibly because of Active Directory replication delays.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2145.AlertName">
          <Name>Computer object not found in Active Directory.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2147">
          <Name>MSMQ service cannot start due to insufficient disk space or memory.</Name>
          <Description>MSMQ service cannot start due to insufficient disk space or memory.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2147.AlertName">
          <Name>MSMQ service cannot start due to insufficient disk space or memory.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2148">
          <Name>MSMQ service cannot start due to its failure to connect to its device driver.</Name>
          <Description>MSMQ service cannot start due to its failure to connect to its device driver.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2148.AlertName">
          <Name>MSMQ service cannot start due to its failure to connect to its device driver.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2155">
          <Name>The Message Queuing service stopped monitoring a mapping folder.</Name>
          <Description>The Message Queuing service stopped monitoring a mapping folder.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2155.AlertName">
          <Name>The Message Queuing service stopped monitoring a mapping folder.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2156">
          <Name>Mapping file contents cannot be read.</Name>
          <Description>Mapping file contents cannot be read.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2156.AlertName">
          <Name>Mapping file contents cannot be read.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2157">
          <Name>MSMQ - Mapping file URL already mapped to another queue Rule</Name>
          <Description>Mapping file URL already mapped to another queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2157.AlertName">
          <Name>Mapping file URL already mapped to another queue.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2157" SubElementID="DS">
          <Name>DS</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2157" SubElementID="GenerateAlert">
          <Name>GenerateAlert</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2158">
          <Name>MSMQ mapping file was ignored.</Name>
          <Description>MSMQ mapping file was ignored.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2158.AlertName">
          <Name>MSMQ mapping file was ignored.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2160">
          <Name>MSMQ - A queue cannot listen/bind to multicast address Rule</Name>
          <Description>A queue cannot listen/bind to multicast address.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2160.AlertName">
          <Name>A queue cannot listen/bind to multicast address.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2160" SubElementID="DS">
          <Name>DS</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2160" SubElementID="GenerateAlert">
          <Name>GenerateAlert</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2161">
          <Name>MSMQ - Invalid URL mapped to queue Rule</Name>
          <Description>Invalid URL mapped to queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2161.AlertName">
          <Name>Invalid URL mapped to queue.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2161" SubElementID="DS">
          <Name>DS</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2161" SubElementID="GenerateAlert">
          <Name>GenerateAlert</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2164">
          <Name>Message Queueing service cannot join the domain.</Name>
          <Description>Message Queueing service cannot join the domain.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2164.AlertName">
          <Name>Message Queueing service cannot join the domain.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2165">
          <Name>The sites where the computer resides cannot be resolved.</Name>
          <Description>The sites where the computer resides cannot be resolved.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2165.AlertName">
          <Name>The sites where the computer resides cannot be resolved.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2168">
          <Name>The Message Queuing service resource cannot bind to the cluster IP address.</Name>
          <Description>The Message Queuing service resource cannot bind to the cluster IP address.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2168.AlertName">
          <Name>The Message Queuing service resource cannot bind to the cluster IP address.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2169">
          <Name>Message Queueing routing server is operating in workgroup mode.</Name>
          <Description>Message Queueing routing server is operating in workgroup mode.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2169.AlertName">
          <Name>Message Queueing routing server is operating in workgroup mode.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2170">
          <Name>Message Queuing failed to bind to port 1801.</Name>
          <Description>Message Queuing failed to bind to port 1801.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2170.AlertName">
          <Name>Message Queuing failed to bind to port 1801.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2171">
          <Name>Message Queuing cannot bind to UDP port 3527.</Name>
          <Description>Message Queuing cannot bind to UDP port 3527.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2171.AlertName">
          <Name>Message Queuing cannot bind to UDP port 3527.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2172">
          <Name>The MsmqServices object is configured with weakened security to support MSMQ 1.</Name>
          <Description>The MsmqServices object is configured with weakened security to support MSMQ 1.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2172.AlertName">
          <Name>The MsmqServices object is configured with weakened security to support MSMQ 1.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2175">
          <Name>Message Queueing not using strong encryption.</Name>
          <Description>Message Queueing not using strong encryption.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2175.AlertName">
          <Name>Message Queueing not using strong encryption.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2177">
          <Name>MSMQ - MQ service unable to check sender access Rule</Name>
          <Description>Message Queueing service unable to check sender access.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2177.AlertName">
          <Name>Message Queueing service unable to check sender access.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2177" SubElementID="DS">
          <Name>DS</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2177" SubElementID="GenerateAlert">
          <Name>GenerateAlert</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2182">
          <Name>Storage quota exceeded for MSMQ queue. No more messages can be stored in the queue.</Name>
          <Description>Storage quota exceeded for MSMQ queue. No more messages can be stored in the queue. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2182.AlertMessage">
          <Name>Storage quota exceeded for MSMQ queue. No more messages can be stored in the queue.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2183">
          <Name>Machine MSMQ storage quota was exceeded or there is insufficient disk space.</Name>
          <Description>Machine MSMQ storage quota was exceeded or there is insufficient disk space. No more Messages can be stored in user queues. Need to get message storage below the quota.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2183.AlertName">
          <Name>Event 2183 - Machine MSMQ storage quota was exceeded or there is insufficient disk space.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2184">
          <Name>Message Queuing could not resolve a name to an IP address.</Name>
          <Description>Message Queuing could not resolve a name to an IP address.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2184.AlertMessage">
          <Name>Message Queuing could not resolve a name to an IP address.</Name>
          <Description>
                        Message Queuing could not resolve a name to an IP address.
                        Event Description: {0}
                    </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2185">
          <Name>A socket operation failed.</Name>
          <Description>A socket operation failed. Message Queuing cannot send the message now, but it will retry to send the message.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2185.AlertMessage">
          <Name>A socket operation failed.</Name>
          <Description>
                        A socket operation failed.
                        Event Description: {0}
                    </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2187">
          <Name>Message Queuing connection was refused by the recipient computer.</Name>
          <Description>Message Queuing connection was refused by the recipient computer</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2187.AlertMessage">
          <Name>Message Queuing connection was refused by the recipient computer.</Name>
          <Description>
                        Message Queuing connection was refused by the recipient computer.
                        Event Description: {0}
                    </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2188">
          <Name>Message Queuing could not access Active Directory and failed to compute routing path</Name>
          <Description>Message Queuing could not access Active Directory and failed to compute routing path for messages sent to queue. Messages will wait in the outgoing queue until connection with Active Directory is restored.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2188.AlertMessage">
          <Name>Message Queuing could not access Active Directory and failed to compute routing path</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2189">
          <Name>Message Queuing failed to send a message due to low memory.</Name>
          <Description>Message Queuing failed to send a message due to low memory.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2189.AlertName">
          <Name>Message Queuing failed to send a message due to low memory.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2190">
          <Name>Message Queuing could not complete SSL negotiation with the remote computer. </Name>
          <Description>Message Queuing could not complete SSL negotiation with the remote computer. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2190.AlertMessage">
          <Name>Message Queuing could not complete SSL negotiation with the remote computer.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2191">
          <Name>Message Queuing could not validate server certificate in HTTPS scenario. This certificate cannot be trusted.</Name>
          <Description>Message Queuing could not validate server certificate in HTTPS scenario because the certificate was found in disallowed store. This means the certificate cannot be trusted.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2191.AlertMessage">
          <Name>Message Queuing could not validate server certificate in HTTPS scenario.This certificate cannot be trusted.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2192">
          <Name>Message Queuing could not establish SSL connection with the recipient computer.</Name>
          <Description>Message Queuing could not establish SSL connection with the recipient computer because a trust chain from the server certificate to a trusted Certificate Authority certificate could not be established.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2192.AlertMessage">
          <Name>Message Queuing could not establish SSL connection with the recipient computer.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2193">
          <Name>Message Queuing could not establish SSL connection with the recipient computer</Name>
          <Description>Message Queuing could not establish SSL connection with the recipient computer because the computer name specified in the HTTP queue format name does not match the name of the recipient server certificate.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2193.AlertMessage">
          <Name>Message Queuing could not establish SSL connection with the recipient computer</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2194">
          <Name>The Message Queuing service cannot communicate with other computers.</Name>
          <Description>The Message Queuing service cannot communicate with other computers, because the select API for socket failed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2194.AlertMessage">
          <Name>The Message Queuing service cannot communicate with other computers.</Name>
          <Description>
                        The Message Queuing service cannot communicate with other computers.

                        Event Description: {0}
                    </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2195">
          <Name>Message Queuing could not authenticate a message sent to queue.</Name>
          <Description>Message Queuing could not authenticate a message sent to queue. The message was rejected because the queue only accepts authenticated messages. A negative arrival acknowledgement will be sent if requested by the sender. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2195.AlertMessage">
          <Name>Message Queuing could not authenticate a message sent to queue.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2196">
          <Name>Message Queuing failed to verify digital signature of a message sent to queue.</Name>
          <Description>Message Queuing failed to verify digital signature of a message sent to queue. The message was rejected. A negative arrival acknowledgement will be sent if requested by the sender.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2196.AlertMessage">
          <Name>Message Queuing failed to verify digital signature of a message sent to queue.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2197">
          <Name>Message Queuing failed to listen on the IPv6 protocol.</Name>
          <Description>Message Queuing failed to listen on the IPv6 protocol. Messages will not be accepted on IPv6.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2197.AlertMessage">
          <Name>Message Queuing failed to listen on the IPv6 protocol.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2198">
          <Name>Message Queuing failed to listen on IPv4 protocol</Name>
          <Description>Message Queuing failed to listen on IPv4 protocol. Messages will not be accepted on IPv4.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2198.AlertMessage">
          <Name>Message Queuing failed to listen on IPv4 protocol</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2199">
          <Name>Message Queuing Service failed to listen on both IPv4 and IPv6 protocol</Name>
          <Description>Message Queuing Service failed to listen on both IPv4 and IPv6 protocol. Messages will not be accepted from the network through TCP/IP protocols. Messages addressed to this machine using TCP/IP protocols will not arrive but will accumulate in sender's outgoing queues.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2199.AlertMessage">
          <Name>Message Queuing Service failed to listen on both IPv4 and IPv6 protocol</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2201">
          <Name>Message Queuing Triggers initialization failed.</Name>
          <Description>Message Queuing Triggers initialization failed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2201.AlertName">
          <Name>Message Queuing Triggers initialization failed.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2202">
          <Name>Message Queuing Triggers failed to create an instance of the Triggers Transactional object.</Name>
          <Description>Message Queuing Triggers failed to create an instance of the Triggers Transactional object.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2202.AlertName">
          <Name>Message Queuing Triggers failed to create an instance of the Triggers Transactional object.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2203">
          <Name>The trigger information cannot be retrieved from the trigger store in registry. At least one trigger is nonfunctional.</Name>
          <Description>The trigger information cannot be retrieved from the trigger store in registry. At least one trigger is nonfunctional.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2203.AlertMessage">
          <Name>The trigger information cannot be retrieved from the trigger store in registry. At least one trigger is nonfunctional.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2204">
          <Name>The information for the attached rule cannot be retrieved from the trigger store.</Name>
          <Description>The information for the attached rule cannot be retrieved from the trigger store.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2204.AlertName">
          <Name>The information for the attached rule cannot be retrieved from the trigger store.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2205">
          <Name>MSMQ - Opening the queue  for peeking at or retrieving messages failed Rule</Name>
          <Description>Opening the queue  for peeking at or retrieving messages failed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2205.AlertName">
          <Name>Opening the queue  for peeking at or retrieving messages failed.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2205" SubElementID="DS">
          <Name>DS</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2205" SubElementID="GenerateAlert">
          <Name>GenerateAlert</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2206">
          <Name>Opening an internal queue needed by the Triggers service failed.</Name>
          <Description>Opening an internal queue needed by the Triggers service failed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2206.AlertName">
          <Name>Opening an internal queue needed by the Triggers service failed.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2207">
          <Name>An instance of a rule handler for the rule was not created.</Name>
          <Description>An instance of a rule handler for the rule was not created. The rule cannot be evaluated and executed. The MSMQTriggerObjects.MSMQRuleHandler class may not be registered, or your System folder does not contain mqtrig.dll. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2207.AlertMessage">
          <Name>An instance of a rule handler for the rule was not created.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2208">
          <Name>The action or a condition parameter for the rule was not parsed.</Name>
          <Description>The action or a condition parameter for the rule was not parsed. The rule cannot be evaluated and executed.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2208.AlertMessage">
          <Name>The action or a condition parameter for the rule was not parsed.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2209">
          <Name>The action defined by the rule was not invoked.</Name>
          <Description>The action defined by the rule was not invoked.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2209.AlertMessage">
          <Name>The action defined by the rule was not invoked.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2210">
          <Name>Rule evaluation or execution failed for the transactional trigger.</Name>
          <Description>Rule evaluation or execution failed for the transactional trigger.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2210.AlertMessage">
          <Name>Rule evaluation or execution failed for the transactional trigger.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2212">
          <Name>Trigger associated with this queue is nonfunctional.</Name>
          <Description>Trigger associated with this queue is nonfunctional.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2212.AlertName">
          <Name>Trigger associated with this queue is nonfunctional.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2213">
          <Name>At least one of the required dependencies was not found.</Name>
          <Description>At least one of the required dependencies was not found. Please verify that MSMQ Triggers resources are dependent on Message Queue resources.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2213.AlertName">
          <Name>At least one of the required dependencies was not found.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2214">
          <Name>Unable to update EventLog information in registry.</Name>
          <Description>Unable to update EventLog information in registry.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2214.AlertName">
          <Name>Unable to update EventLog information in registry.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2215">
          <Name>The Triggers transactional component could not be registered in COM+.</Name>
          <Description>The Triggers transactional component could not be registered in COM+.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2215.AlertName">
          <Name>The Triggers transactional component could not be registered in COM+.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2219">
          <Name>Network Service account will not take effect until Triggers service is restarted.</Name>
          <Description>Network Service account will not take effect until Triggers service is restarted.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2219.AlertName">
          <Name>Network Service account will not take effect until Triggers service is restarted.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2220">
          <Name>Configured IP address is not valid.</Name>
          <Description>Configured IP address is not valid.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2220.AlertName">
          <Name>Configured IP address is not valid.</Name>
          <Description>{0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2250">
          <Name>Message Queuing will not be able to accept messages temporarily because system paged pool is low.</Name>
          <Description>Message Queuing will not be able to accept messages temporarily because system paged pool is low.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2250.AlertName">
          <Name>Message Queuing will not be able to accept messages temporarily because system paged pool is low.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2251">
          <Name>Message Queuing will not be able to accept messages temporarily because system commit is high.</Name>
          <Description>Message Queuing will not be able to accept messages temporarily because system commit is high. No manual intervention is required at this stage. Once memory utilization has normalized, Message Queuing will automatically resume accepting messages.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2251.AlertMessage">
          <Name>Message Queuing will not be able to accept messages temporarily because system commit is high.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2253">
          <Name>The message could not be moved to deadletter queue.</Name>
          <Description>The message could not be moved to deadletter queue. The message was moved to the system transactional dead letter queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2253.AlertMessage">
          <Name>The message could not be moved to deadletter queue.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2254">
          <Name>The message could not be moved to deadletter queue. The authenticity of the message could not be verified.</Name>
          <Description>The message could not be moved to deadletter queue. The deadletter queue is authenticated and the authenticity of the message could not be verified. The message will be moved to the system transactional dead letter queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2254.AlertMessage">
          <Name>The message could not be moved to deadletter queue. The authenticity of the message could not be verified.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2255">
          <Name>The message could not be moved to deadletter queue. Deadletter queues should not require privacy of messages.</Name>
          <Description>The message could not be moved to deadletter queue. Deadletter queues should not require privacy of messages. The message will be moved to the system transactional dead letter queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2255.AlertMessage">
          <Name>The message could not be moved to deadletter queue. Deadletter queues should not require privacy of messages.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2256">
          <Name>The message could not be moved to deadletter queue. The deadletter queue needs to be transactional.</Name>
          <Description>The message could not be moved to deadletter queue. The deadletter queue needs to be transactional. The message will be moved to the system transactional dead letter queue.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Rule.Alert.Event2256.AlertMessage">
          <Name>The message could not be moved to deadletter queue. The deadletter queue needs to be transactional.</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.KBytesInDeadLetterQueue.PerformanceCollection.Rule">
          <Name>MSMQ - KBytes In Dead Letter Queue Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.MessagesInDeadLetterQueue.PerformanceCollection.Rule">
          <Name>MSMQ - Messages In Dead Letter Queue PerformanceCollection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.RunAsProfile">
          <Name>MSMQ Queue RunAs Profile</Name>
          <Description>This account is used for discovery and analysis of MSMQ queues.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Seed">
          <Name>MSMQ Seed Class</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Seed" SubElementID="IsVirtualNode">
          <Name>IsVirtualNode</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server">
          <Name>MSMQ Server</Name>
          <Description>A server where the MSMQ service is present.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.Discovery">
          <Name>Discover MSMQ Servers</Name>
          <Description>Discover MSMQ Servers</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.IncomingMessagesSec.PerformanceCollection.Rule">
          <Name>MSMQ - Server Incoming Messages/sec Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.OutgoingMessagesSec.PerformanceCollection.Rule">
          <Name>MSMQ - Server Outgoing Messages/sec Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.Sessions.PerformanceCollection.Rule">
          <Name>MSMQ - Server Sessions Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.State.View">
          <Name>Servers</Name>
          <Description>State of each Message Queuing Server with its complete set of properties for columns.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalKBytesInAllQueues.PerformanceCollection.Rule">
          <Name>MSMQ - Server Total Kbytes in all queues Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server.TotalMessagesInAllQueues.PerformanceCollection.Rule">
          <Name>MSMQ - Server Total messages in all queues Performance Collection Rule</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="ClusterResourceName">
          <Name>Cluster Resource Name</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="DependentClients">
          <Name>Dependent Clients</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.ServerHostsQueue.Relationship">
          <Name>MSMQ Server Hosts Queue</Name>
          <Description>MSMQ Server Hosts Queue</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.ServerHostsTriggers.Relationship">
          <Name>MSMQ Server Hosts Triggers</Name>
          <Description>MSMQ Server Hosts Triggers</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="IsClustered">
          <Name>Clustered</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="JournalQuota">
          <Name>Journal Quota</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="MessageFilesFolder">
          <Name>Message Files Folder</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="MessageLoggerFolder">
          <Name>Message Logger Folder</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="Quota">
          <Name>Quota</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="Routing">
          <Name>Routing</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="ServiceName">
          <Name>ServiceName</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="SiteName">
          <Name>Site Name</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="SourceName">
          <Name>Source Name</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="TransactionLoggerFolder">
          <Name>Transaction Logger Folder</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="Version">
          <Name>Version</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Server" SubElementID="Workgroup">
          <Name>Workgroup</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Service.Monitor">
          <Name>MSMQ Service Monitor</Name>
          <Description>Message Queuing Service State</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Service.Monitor.AlertMessage">
          <Name>The MSMQ Service is not running</Name>
          <Description>The MSMQ Service is not running.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Service.Monitor" SubElementID="NotRunning">
          <Name>Not Running</Name>
          <Description>The service is not running.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Service.Monitor" SubElementID="Running">
          <Name>Running</Name>
          <Description>The service is running.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.StartService.Task">
          <Name>Start Service</Name>
          <Description>Starts the MSMQ Service at the server. </Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.StartService.Triggers.Task">
          <Name>Start Service - Triggers</Name>
          <Description>Starts the MSMQ Triggers Service at the server</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.StopService.Task">
          <Name>Stop Service</Name>
          <Description>Stops the MSMQ Service at the server.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.StopService.Triggers.Task">
          <Name>Stop Service - Triggers</Name>
          <Description>Stops the MSMQ Triggers Service at the server.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.TotalKBytesInAllQueues.Performance.View">
          <Name>Total KBytes In All Queues</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.TotalMessagesInAllQueues.Performance.View">
          <Name>Total Messages In All Queues</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Trigger">
          <Name>MSMQ Trigger</Name>
          <Description>A server where the MSMQTriggers service is present.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Triggers.Service.Monitor">
          <Name>MSMQ Triggers Service Monitor</Name>
          <Description>Triggers Service State</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Triggers.Service.Monitor.AlertMessage">
          <Name>The MSMQ Triggers Service is stopped.</Name>
          <Description>The MSMQ Triggers Service is stopped.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Triggers.Service.Monitor" SubElementID="NotRunning">
          <Name>Not Running</Name>
          <Description>The service is not running.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Triggers.Service.Monitor" SubElementID="Running">
          <Name>Running</Name>
          <Description>The service is running</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Triggers.State.View">
          <Name>Triggers</Name>
          <Description>State of each Message Queuing Triggers Service.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Trigger" SubElementID="ServiceName">
          <Name>ServiceName</Name>
        </DisplayString>
        <DisplayString ElementID="MSMQ.TriggerToServer.Availability.Rollup.Monitor">
          <Name>MSMQ Triggers Availability Health Rollup Monitor</Name>
          <Description>Triggers Health Rollup</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.TriggerToServer.Performance.Rollup.Monitor">
          <Name>MSMQ Triggers Performance Health Rollup Monitor</Name>
          <Description>Triggers Health Rollup</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.TrimJournalQueue.Task">
          <Name>Trim Journal Queue</Name>
          <Description>Removes messages from journal queue until specified quota usage is reached.</Description>
        </DisplayString>
        <DisplayString ElementID="MSMQ.Sessions.Performance.View">
          <Name>Sessions</Name>
          <Description />
        </DisplayString>
      </DisplayStrings>
      <KnowledgeArticles>
        <KnowledgeArticle ElementID="MSMQ" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.</maml:para>
              <maml:para>By using embedded expertise, this Management Pack highlights performance, health, and availability conditions that indicate problems. It can in some cases even identify issues before they become critical thus providing you with a level of customer responsiveness that increases the overall availability and performance of your MSMQ infrastructure. As a result this Management Pack will reduce the total cost of ownership (TOC) by enabling proactive management and reducing resolution times for the issues defined.</maml:para>
              <maml:para />
              <maml:para>The Message Queuing Management Pack includes the following features and capabilities:</maml:para>
              <maml:para>
                <maml:ui>Monitors and Rules</maml:ui>
              </maml:para>
              <maml:para>A complete set of Monitors and Rules have been provided to monitor Message Queuing. The Management Pack includes monitoring capabilities for:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Service Management</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Queue availability</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Message Queuing Service Performance</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Tasks</maml:ui>
              </maml:para>
              <maml:para>A set of tasks that will allow restarting the service or collecting data from a queue in real-time.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Knowledge</maml:ui>
              </maml:para>
              <maml:para>A complete set of Knowledge has been provided for the Monitors, Rules, and Discoveries.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:para>This Management pack doesn’t require any out of box configuration. Overrides may be applied to features to modify the out of box configuration (eg: enable/disable monitors and rules, change thresholds, etc)</maml:para>
              <maml:para>Note: This Management Pack depends on the appropriate configuration of the “MSMQ Queue Access Account”</maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2000" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start due to bad registry value.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service cannot start because it cannot read configuration information from the registry, due to a bad value. This may indicate either that the registry is corrupted or that Message Queuing was not installed properly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete Message Queuing registry values and reinstall Message Queuing</maml:ui>
              </maml:para>
              <maml:para>
                <maml:ui>Note:</maml:ui> The following procedure will erase previous Message Queuing entries that are stored in the registry.
                            </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>
                <maml:ui>Delete registry values</maml:ui>
              </maml:para>
              <maml:para>To delete registry values: </maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open Registry Editor. To open Registry Editor, click Start. Click Run. In the open box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Browse to HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Delete all registry keys beneath the MSMQ key. </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows XP)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows XP:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Clear the Microsoft Message Queue (MSMQ) server check box, and then click Remove.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Repeat steps 1 and 2. </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Turn Windows features on or off section, select the desired Message Queuing components to install.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows Server 2016)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows Server 2016:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, then click Server Manager.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the console tree, click Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the details pane, in the Feature Summary section, click Remove Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Remove Features Wizard, clear the Message Queue check box, and then click Remove.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>After Message Queuing has been removed, in Server Manager, click Add Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Add Features Wizard, select the desired Message Queuing components to install, and then click Install.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2001" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start due to inability to write a registry key.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service cannot start because it cannot write configuration information into the registry. This may indicate either that the registry is corrupted or that Message Queuing was not installed properly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete Message Queuing registry values and reinstall Message Queuing</maml:ui>
              </maml:para>
              <maml:para>
                <maml:ui>Note:</maml:ui> The following procedure will erase previous Message Queuing entries that are stored in the registry.
                            </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>
                <maml:ui>Delete registry values</maml:ui>
              </maml:para>
              <maml:para>To delete registry values: </maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Open Registry Editor. To open Registry Editor, click Start. Click Run. In the open box, type regedit, and then press ENTER.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Browse to HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Delete all registry keys beneath the MSMQ key. </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows XP)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows XP:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Clear the Microsoft Message Queue (MSMQ) server check box, and then click Remove.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Repeat steps 1 and 2. </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Turn Windows features on or off section, select the desired Message Queuing components to install.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows Server 2016)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows Server 2016:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, then click Server Manager.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the console tree, click Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the details pane, in the Feature Summary section, click Remove Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Remove Features Wizard, clear the Message Queue check box, and then click Remove.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>After Message Queuing has been removed, in Server Manager, click Add Features.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>In the Add Features Wizard, select the desired Message Queuing components to install, and then click Install.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2002" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service needs access to the required cluster resources when the Message Queuing services are configured for high availability on a Windows Server cluster. Ensure that the MSMQ service has access to the cluster resources that it requires.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:para>The MSMQ service dependencies are:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Network Name</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Physical Disk</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>At least one of the required dependencies was not found.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the trigger service can access necessary cluster resources:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open the Cluster Management snap-in. To open Cluster Management, click <maml:ui>Start</maml:ui>, click <maml:ui>Control Panel,</maml:ui> click <maml:ui>Administrative Tools</maml:ui>, and then click <maml:ui>Failover Cluster Management</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the console tree, under <maml:ui>Services and Applications</maml:ui>, click the desired application.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the details pane, right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Properties</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Click the <maml:ui>Dependencies</maml:ui> tab.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Look at the <maml:ui>Dependencies</maml:ui> list, and ensure that the cluster resources are in the list.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2003" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>There are insufficient memory resources. Message Queuing operation will be experimenting problems.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>There are insufficient memory resources for MSMQ to operate.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Free memory from other applications</maml:ui>
              </maml:para>
              <maml:para>The MSMQ Service needs adequate memory resources to function properly. </maml:para>
              <maml:para>
                                Try identifying and closing other applications that may be consuming a large amount of memory. If it turns out that the MSMQ Service is the only program consuming a large amount of memory, try receiving the messages from the queues or increasing the rate of message processing. For more information, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2015" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service is not online with Active Directory.</maml:para>
              <maml:para>Message Queuing must integrate successfully with Active Directory Domain Services (AD DS) to function properly in domain mode. The integration of the Active Directory interface, configuration, and other related issues can affect Message Queuing.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ configuration object cannot be created in Active Directory Domain Services (AD DS). This error might be caused by one of the following conditions:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Replication delays are not configured properly.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>A corrupted computer object exists in AD DS.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and a member of the local administrators security group:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open the Computer Management console. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the console tree, expand <maml:ui>System Tools</maml:ui>, expand <maml:ui>Local Users and Groups</maml:ui>, and then click <maml:ui>Groups</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the details pane, double-click <maml:ui>Administrators</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the <maml:ui>Members</maml:ui> section, confirm that the user is member of this group (Administrators).
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If the user is not a member of the group, see the section titled "Grant appropriate permissions."</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                <maml:ui>Replication delays are not configured properly</maml:ui>
              </maml:para>
              <maml:para>There is an issue with replication delays. This issue should be resolved after Active Directory Domain Services (AD DS) replicates itself. After replication is complete, try to create the Active Directory object again:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>For smaller networks, replication should take a few minutes. </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>For larger networks, the replication may take a long time.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>
                                Advanced users and domain administrators can also use the Knowledge Consistency Checker (KCC) to configure replication delays. For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>A corrupted computer object exists in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that there are stale computer objects:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Click <maml:ui>Start</maml:ui>, point to <maml:ui>AdministrativeTools</maml:ui>, right-click <maml:ui>ActiveDirectoryUsers and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users</maml:ui>, <maml:ui>Contacts</maml:ui>, <maml:ui>Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, these objects are stale.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If you determine that there are stale objects, follow the steps below</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>Stale objects can cause issues that prevent the MSMQ Service from operating properly. Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before you delete the computer object, make sure that no services that are running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer. </maml:para>
              <maml:para>You must have the Active Directory service tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that Active Directory service tools are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory service tools are installed:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui> Run as administrator</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Active Directory Domains and Trusts</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Active Directory Sites and Services</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Active Directory Users and Computers</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            On the <maml:ui>View </maml:ui>menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as Containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, this object is stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2020" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start due to internal private queue problem.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:para>To backup and restore Message Queuing messages using a command line</maml:para>
              <maml:para>At a command prompt, type the following, and then press ENTER:</maml:para>
              <maml:para>mqbkup {-bfolderpath | -rfolderpath| -?} [-y] [-cmsmq_resource_name]</maml:para>
              <maml:para> </maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Value </maml:ui>
                    </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Description </maml:ui>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-bfolderpath</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>backs up the files to the specified folder</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-rfolderpath</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>restores the files from the specified folder</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-y</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>don't prompt (yes to all questions)</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-cmsmq_resource_name</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>used when MSMQ is configured as a clustered resource, specify the clustered MSMQ resource name</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-?</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>displays help for the utility</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This problem can be caused because a file in the MSMQ\Storage\LQS directory is corrupted. This directory contains the definitions of all private queues in the machine.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Before restoring messages, you must close Control Panel and all Message Queuing applications or any application that holds open a registry key handle to the HKLM\Software\MSMQ\Parameters registry key. Such applications typically include the Computer Management console if the Message Queuing snap-in is loaded, the MSMQ trigger service, the Message Queuing service, and some third party applications.</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Note: </maml:ui>Closing the control panel is not an issue on Windows XP and above because these versions of Windows do not include an MSMQ control panel extension.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>Additional considerations</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>The Mqbkup utility cannot be used to backup or restore objects stored in Active Directory Domain Services. Therefore, the Mqbkup utility cannot backup or restore public queues since public queues are objects in Active Directory Domain Services. The Mqbkup utility does backup or restore any Message Queuing messages stored on the local computer that are referenced by public queues but the public queues themselves must be backed up or restored independently of the Mqbkup utility.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>This utility backs up recoverable and transactional messages; including those in the outgoing queues. It does not back up or restore express messages.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Certificate and cryptographic key information is not backed up using this utility.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>After a restore operation, you must register a new user certificate. For information about how to register a certificate, see Additional references.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>This utility stops and restarts the Message Queuing service, which will cause any express messages to be lost. For more information about express messages, see Additional references.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If a COM+ application has been invoked by a rule that is bound to a trigger, then restoring of messages may fail with an "access is denied" error. To resolve this issue, follow these steps:</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On Windows Vista® computers, start mqbkup from a command prompt that is running with local Administrator privileges.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Ensure that all user applications and services that are using the MSMQ API's are stopped.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If restoring of messages still fails, wait for 10 minutes and try again. COM+ applications can take up to 10 minutes to unload from memory after all objects are released.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Back Up and Restore Messages (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc771016(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc771016(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Register Certificates for Message Queuing (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc753651(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc753651(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Message Delivery Methods (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc771721(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc771721(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2023" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start due to problem with message store.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:para>To backup and restore Message Queuing messages using a command line</maml:para>
              <maml:para>At a command prompt, type the following, and then press ENTER:</maml:para>
              <maml:para>mqbkup {-bfolderpath | -rfolderpath| -?} [-y] [-cmsmq_resource_name]</maml:para>
              <maml:para> </maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Value </maml:ui>
                    </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Description </maml:ui>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-bfolderpath</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>backs up the files to the specified folder</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-rfolderpath</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>restores the files from the specified folder</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-y</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>don't prompt (yes to all questions)</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-cmsmq_resource_name</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>used when MSMQ is configured as a clustered resource, specify the clustered MSMQ resource name</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>-?</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>displays help for the utility</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message store is causing problems to the Message Queuing Service.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Before restoring messages, you must close Control Panel and all Message Queuing applications or any application that holds open a registry key handle to the HKLM\Software\MSMQ\Parameters registry key. Such applications typically include the Computer Management console if the Message Queuing snap-in is loaded, the MSMQ trigger service, the Message Queuing service, and some third party applications.</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Note: </maml:ui>Closing the control panel is not an issue on Windows XP and above because these versions of Windows do not include an MSMQ control panel extension.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>Additional considerations</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>The Mqbkup utility cannot be used to backup or restore objects stored in Active Directory Domain Services. Therefore, the Mqbkup utility cannot backup or restore public queues since public queues are objects in Active Directory Domain Services. The Mqbkup utility does backup or restore any Message Queuing messages stored on the local computer that are referenced by public queues but the public queues themselves must be backed up or restored independently of the Mqbkup utility.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>This utility backs up recoverable and transactional messages; including those in the outgoing queues. It does not back up or restore express messages.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Certificate and cryptographic key information is not backed up using this utility.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>After a restore operation, you must register a new user certificate. For information about how to register a certificate, see Additional references.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>This utility stops and restarts the Message Queuing service, which will cause any express messages to be lost. For more information about express messages, see Additional references.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If a COM+ application has been invoked by a rule that is bound to a trigger, then restoring of messages may fail with an "access is denied" error. To resolve this issue, follow these steps:</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>On Windows Vista® computers, start mqbkup from a command prompt that is running with local Administrator privileges.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Ensure that all user applications and services that are using the MSMQ API's are stopped.</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>If restoring of messages still fails, wait for 10 minutes and try again. COM+ applications can take up to 10 minutes to unload from memory after all objects are released.</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Back Up and Restore Messages (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc771016(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc771016(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Register Certificates for Message Queuing (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc753651(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc753651(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Message Delivery Methods (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc771721(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc771721(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2035" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start. The Active Directory interface cannot be initialized</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>There may be several reasons why the Active Directory interface cannot be initialized. Possible actions include the following: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Configuring Message Queuing objects to be accessible in Active Directory Domain Services (AD DS).</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Making modifications so that Message Queuing can find and bind to the directory service. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Resolving issues that are preventing Message Queuing from synchronizing with AD DS. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                Contact your domain admistrator to help troubleshoot and resolve this issue. You can also contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2035 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337479(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337479(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2043" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service deleted a message. This message cannot be restored because the queue in which it was placed doesn’t exist</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing service deleted a message. This message cannot be restored because the queue in which it was placed doesn’t exist.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Contact Microsoft</maml:ui>
              </maml:para>
              <maml:para>The event indicates that the message refers to a queue that no longer exists. This might be due to the message pointing to the wrong queue or the absence of the specified queue. </maml:para>
              <maml:para>
                                If this event is reported for a number of messages, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2043 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337428(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337428(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2044" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service has insufficient privileges to create audit log messages.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The user that the MSMQ Service runs under must be able to set the SE_AUDIT_NAME privilege. This privilege is automatically granted to the Network Service. To resolve this issue, confirm that the MSMQ Service is running as a Network Service.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that the MSMQ Service is running as a Network Service</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the MSMQ Service is running as a Network Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Log On</maml:ui>. Confirm that <maml:ui>This account</maml:ui> is set to <maml:ui>Network Service</maml:ui>. If not, click <maml:ui>Browse</maml:ui> to change the user.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2044 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337467(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337467(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2047" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start. A connection with the Distributed Transaction Coordinator cannot be established. Confirm the MSDTC is started and the MSMQ Service is running.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing service cannot start because a connection with the Distributed Transaction Coordinator cannot be established.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that MSDTC is started</maml:ui>
              </maml:para>
              <maml:para>The Microsoft Distributed Transaction Coordinator service (MSDTC) must be started. </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that MSDTC is started:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Locate the <maml:ui>Distributed Transaction Coordinator</maml:ui>service, and then confirm that the value in the <maml:ui>Status</maml:ui> column is <maml:ui>Started</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the value is not <maml:ui>Started</maml:ui>, right-click the service, and then click <maml:ui>Start</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Ensure that the service is properly registered as a Component Object Model (COM) server. Click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>cmd</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type your COM server/Regserver, and then press ENTER. The COM server here is %windir%\system32\msdtc.exe.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that the MSMQ Service is running</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the MSMQ Service is installed and running:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Locate the <maml:ui>Message Queuing</maml:ui> service, and then confirm that the value in the <maml:ui>Status </maml:ui>column is <maml:ui>Started</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2047 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337397(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337397(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2053" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The incoming sequences checkpoint file failed to initialize. The file MQInSeqs.lg1 or MQInSeqs.lg2 in the Msmq\Storage folder is corrupted or absent.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Checkpoint files must be available for Message Queuing to function properly. To resolve this issue, you must delete the incoming sequence checkpoint files, as well as the QMLog file in the Message Queuing storage directory. This can result in some messages being duplicated. However, this will get the service running as soon as possible and usually without data loss.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete incoming sequence checkpoint files</maml:ui>
              </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>
                                Important: If you are concerned about data loss, contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Delete checkpoint files</maml:ui>
              </maml:para>
              <maml:para>To delete checkpoint files:</maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Windows Explorer, and then browse to your storage directory. This directory is typically located under C:\Windows\System32\msmq\storage.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Delete the following files: MQInSeqs.lg1, MQInSeqs.lg2, and QMLog file.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type regedit, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Browse to <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters</maml:ui>, and then click <maml:ui>Parameters</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Edit </maml:ui>menu, point to <maml:ui>New</maml:ui>, and then click <maml:ui>DWORD (32-bit) Value</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Name </maml:ui>field, enter "LogDataCreated," and then ensure that the value is set to <maml:ui>0</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Close Registry Editor.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services console. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you are concerned about data loss, contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event 2053 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337465(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337465(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2059" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot communicate with other computers, because the RPC interface cannot use the TCP/IP protocol.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service cannot initialize the remote procedure call (RPC) interface because of TCP/IP issues.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Resolve TCP/IP and RPC issues</maml:ui>
              </maml:para>
              <maml:para>Contact your domain administrator with the error code and description to resolve the specific issues.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about troubleshooting RPC errors, see How It Works: Troubleshooting RPC Errors (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=102329</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=102329" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2059 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337476(WS.10).aspx)</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337476(WS.10).aspx)" /></maml:navigationLink></maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2061" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start. The local RPC interface cannot be initialized.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The local remote procedure call (RPC) endpoint could not be initialized.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Ensure that no other processes are using the RPC endpoint with the name "Qmsvc".</maml:para>
              <maml:para>
                                For more information about how to diagnose and resolve RPC endpoint mapping errors, see article 839880 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107512</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107512" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>External</maml:title>
              <maml:para>
                                For more information, see Event ID 2061 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/cc773618(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/cc773618(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2064" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The transactions checkpoint file failed to initialize. The file MQTrans.lg1 or MQTrans.lg2 in the Msmq\Storage folder are corrupted or absent.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Checkpoint files must be available for Message Queuing to function properly. To resolve this issue, you must delete the transaction checkpoint files, as well as the QMLog file in the Message Queuing storage directory. This can result in some messages being duplicated. However, this resolution will get the service running as soon as possible and usually without data loss. </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete transaction checkpoint files</maml:ui>
              </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>
                                Important: If you are concerned about data loss, contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Delete checkpoint files</maml:ui>
              </maml:para>
              <maml:para>To delete checkpoint files:</maml:para>
              <maml:para>
                <maml:ui>Caution</maml:ui>: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Windows Explorer and browse to your storage directory. This is typically located under C:\Windows\System32\msmq\storage.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Delete the following files: MQTrans.lg1, MQTrans.lg2, and QMLog file.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Open the Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type regedit, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Browse to <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Parameters</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Edit</maml:ui> menu, point to<maml:ui>New</maml:ui>, and then click <maml:ui>DWORD (32-bit) Value</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Name</maml:ui>, type "LogDataCreated" and ensure that the value is set to <maml:ui>0</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Close Registry Editor.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you are concerned about data loss, contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2064 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337438(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337438(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2068" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The list of Message Queuing servers with directory service functionality in the Windows registry is empty.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>There may be several reasons why the server list is empty.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2068 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337510(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337510(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2076" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The logger files cannot be initialized. The file QMLog in the Msmq\Storage folder is corrupted or absent.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service needs access permissions on the checkpoint and log files. If the service has permissions and you receive this error, then the file is probably corrupt. To start the MSMQ Service without losing consistency, you must correct or recover corrupted checkpoint and log files.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Correct or recover corrupt log and checkpoint files</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To correct or recover corrupted checkpoint and log files:</maml:para>
              <maml:para>
                <maml:ui>Caution:</maml:ui> Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>To start the service for emergency use (with a potential loss of data consistency), navigate to the %windir%\System32\msmq\storage folder, and then delete the following files: QMLog, MQTrans.lg1, MQTrans.lg2, MQInSeqs.lg1, MQInSeqs.lg2.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Create the DWORD registry entry <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\LogDataCreated</maml:ui>, and then set to a value of <maml:ui>0</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2076 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337437(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337437(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2079" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start. The log file cannot be recovered.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service needs access permissions on the checkpoint and log files. If the service has permissions and you receive this error, then the file is probably corrupt. To start the MSMQ Service without losing consistency, you must correct or recover corrupted checkpoint and log files.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Correct or recover corrupt log and checkpoint files</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>To correct or recover corrupted checkpoint and log files:</maml:para>
              <maml:para>
                <maml:ui>Caution</maml:ui>: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>To start the service for emergency use (with a potential loss of data consistency), navigate to the %windir%\System32\msmq\storage folder, and then delete the following files: QMLog, MQTrans.lg1, MQTrans.lg2, MQInSeqs.lg1, MQInSeqs.lg2.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Create the <maml:ui>DWORD</maml:ui> registry entry <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\LogDataCreated</maml:ui>, and then set to a value of <maml:ui>0.</maml:ui></maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2079 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337402(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337402(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2083" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start. The message file and the log file cannot be reloaded.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service needs access permissions on the checkpoint and log files. If the service has permissions and you receive this error, then the file is probably corrupt. To start the MSMQ Service without losing consistency, you must correct or recover corrupted checkpoint and log files.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Correct or recover corrupt log and checkpoint files</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>To correct or recover corrupted checkpoint and log files:</maml:para>
              <maml:para>
                <maml:ui>Caution:</maml:ui> Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>To start the service for emergency use (with a potential loss of data consistency), navigate to the %windir%\System32\msmq\storage folder, and then delete the following files: QMLog, MQTrans.lg1, MQTrans.lg2, MQInSeqs.lg1, MQInSeqs.lg2.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Create the DWORD registry entry <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\LogDataCreated</maml:ui>, and then set to a value of <maml:ui>0</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2083 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337408(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337408(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2084" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot start because a queue is in an inconsistent state.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2084 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337499(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337499(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2085" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>A message file cannot be created. There is insufficient disk space or memory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>There is insufficient disk space or memory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Free memory from other applications.</maml:ui>
              </maml:para>
              <maml:para>The MSMQ Service needs adequate memory resources to function properly. </maml:para>
              <maml:para>
                                Try identifying and closing other applications that may be consuming a large amount of memory. If it turns out that the MSMQ Service is the only program consuming a large amount of memory, try receiving the messages from the queues or increasing the rate of message processing. For more information, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2085 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337403(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337403(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2096" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing folder cannot be created.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing access control list (ACL) needs appropriate permissions to the directory that it is trying to write to. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Ensure that ACLs are configured properly</maml:ui>
              </maml:para>
              <maml:para>Make sure that the MSMQ Service is running as an account that has permissions to create and modify directories to be used by the MSMQ Service. (By default, the MSMQ Service creates directories under the %windir%\System32\MSMQ directory.) You can do this by directly giving Modify, Read, and Write permissions to the account that the MSMQ Service runs under.</maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To determine the account that the MSMQ Service runs under: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Locate Message Queuing, and then check the account name in the <maml:ui>Log On As</maml:ui> column.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Open Windows Explorer, and then navigate to the Message Queuing folder, which should be under %windir%\System32\msmq (for example C:\Windows\System32\msmq).</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the <maml:ui>msmq</maml:ui> folder, point to <maml:ui>Properties</maml:ui>, and then click the <maml:ui>Security</maml:ui> tab.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Under <maml:ui>Groups and user names</maml:ui>, click <maml:ui>Edit</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the pop-up window, click <maml:ui>Add</maml:ui>, and then enter the name of the account that the MSMQ Service runs under. This is the name that you found in step 2.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>OK</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Permission s</maml:ui>section, select the <maml:ui>Allow</maml:ui> check box for the following permissions: <maml:ui>Full Control</maml:ui>, <maml:ui>Modify</maml:ui>, <maml:ui>Read &amp; execute</maml:ui>, and <maml:ui>Write</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2096 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337427(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337427(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2097" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing registry values cannot be read (the registry is probably corrupted).</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service cannot read configuration information from the registry. This may indicate either that the registry is corrupted or that Message Queuing was not installed properly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete Message Queuing registry values and reinstall Message Queuing</maml:ui>
              </maml:para>
              <maml:para>
                <maml:ui>Note:</maml:ui> The following procedure will erase previous Message Queuing entries that are stored in the registry.
                            </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>
                <maml:ui>Delete registry values</maml:ui>
              </maml:para>
              <maml:para>To delete registry values: </maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Registry Editor. To open Registry Editor, click Start. In the search box, type regedit, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Delete all registry keys beneath the MSMQ key. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows 7)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows 7:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Clear the Microsoft Message Queue (MSMQ) server check box, and then click Remove.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Repeat steps 1 and 2. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Turn Windows features on or off section, select the desired Message Queuing components to install.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows Server 8)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows Server 8:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, then click Server Manager.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, click Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the details pane, in the Feature Summary section, click Remove Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Remove Features Wizard, clear the Message Queue check box, and then click Remove.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>After Message Queuing has been removed, in Server Manager, click Add Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Add Features Wizard, select the desired Message Queuing components to install, and then click Install.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2097 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337497(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337497(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2116" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing was unable to create the msmq (MSMQ Configuration) object in Active Directory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ configuration object cannot be created in Active Directory Domain Services (AD DS). This error might be caused by one of the following conditions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Replication delays are not configured properly.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>A corrupted computer object exists in AD DS.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and a member of the local administrators security group:</maml:para>
              <maml:para />
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management console. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, expand <maml:ui>Local Users and Groups</maml:ui>, and then click <maml:ui>Groups</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Members</maml:ui> section, confirm that the user is member of this group (Administrators).
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the user is not a member of the group, see the section titled "Grant appropriate permissions."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Replication delays are not configured properly</maml:ui>
              </maml:para>
              <maml:para>There is an issue with replication delays. This issue should be resolved after Active Directory Domain Services (AD DS) replicates itself. After replication is complete, try to create the Active Directory object again:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>For smaller networks, replication should take a few minutes. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>For larger networks, the replication may take a long time.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                Advanced users and domain administrators can also use the Knowledge Consistency Checker (KCC) to configure replication delays. For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>A corrupted computer object exists in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that there are stale computer objects:</maml:para>
              <maml:para />
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>AdministrativeTools</maml:ui>, right-click <maml:ui>ActiveDirectoryUsers and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users</maml:ui>, <maml:ui>Contacts</maml:ui>, <maml:ui>Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, these objects are stale.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there are stale objects, follow the steps below</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>Stale objects can cause issues that prevent the MSMQ Service from operating properly. Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before you delete the computer object, make sure that no services that are running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer. </maml:para>
              <maml:para>You must have the Active Directory service tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that Active Directory service tools are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory service tools are installed:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui> Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View </maml:ui>menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as Containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, this object is stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2116 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337481(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337481(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2117" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing was unable to load Mqupgrd.dll.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This Rule Alert if for tracing.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your domain administrator to help troubleshoot and resolve this issue.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2118" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing was unable to find the address of MqCreateMsmqObj in Mqupgrd.dll.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This Rule Alert is for tracing.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your domain administrator to help troubleshoot and resolve this issue.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2120" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service was unable to obtain the properties of the msmq (MSMQ Configuration) object from Active Directory</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ configuration object cannot be created in Active Directory Domain Services (AD DS). This error might be caused by one of the following conditions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Replication delays are not configured properly.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>A corrupted computer object exists in AD DS.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>The user who is installing Message Queuing does not have the correct permissions to create child objects in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and a member of the local administrators security group:</maml:para>
              <maml:para />
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management console. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, expand <maml:ui>Local Users and Groups</maml:ui>, and then click <maml:ui>Groups</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Members</maml:ui> section, confirm that the user is member of this group (Administrators).
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the user is not a member of the group, see the section titled "Grant appropriate permissions."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Replication delays are not configured properly</maml:ui>
              </maml:para>
              <maml:para>There is an issue with replication delays. This issue should be resolved after Active Directory replicates itself. After replication is complete, try to create the Active Directory object again:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>For smaller networks, replication should take a few minutes. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>For larger networks, the replication may take a long time.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                Advanced users and domain administrators can also use the Knowledge Consistency Checker (KCC) to configure replication delays. For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>A corrupted computer object exists in AD DS</maml:ui>
              </maml:para>
              <maml:para>To confirm that there are stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, these objects are stale.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there are stale objects, refer to the following steps</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Stale objects can cause issues that prevent the MSMQ Service from operating properly. Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before you delete the computer object, make sure that no services that are running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer. </maml:para>
              <maml:para>You must have the Active Directory service tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Confirm that Active Directory service tools are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory service tools are installed:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui> Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View </maml:ui>menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as Containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on that particular computer, this object is stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2120 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337481(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337481(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2122" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This domain controller is not trusted for delegation. Therefore, the Message Queuing server cannot run.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The domain controller must have the Active Directory option Trust computer for delegation enabled.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Enable domain controller delegation</maml:ui>
              </maml:para>
              <maml:para>
                                The domain controller must have the Active Directory option <maml:ui>Trust computer for delegation</maml:ui> enabled.
                            </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Note</maml:ui>: Make sure that this computer really should be trusted for delegation before performing this procedure, as trusting for delegation could be a security risk.
                            </maml:para>
              <maml:para>To enable delegation for the local domain controller:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click A<maml:ui>ctive Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, click <maml:ui>Domain Controllers</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the computer that you want to configure (that is, the local domain controller), and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Trust this computer for delegation to any service (Kerberos only)</maml:ui>, and then click <maml:ui>OK</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Accept any confirmation dialog boxes.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2122 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337485(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337485(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2123" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing server cannot determine if the local domain controller is trusted for delegation. This may indicate a serious problem.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing server cannot determine if the local domain controller is trusted for delegation.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Enable domain controller delegation</maml:ui>
              </maml:para>
              <maml:para>
                                The domain controller must have the Active Directory option <maml:ui>Trust computer for delegation</maml:ui> enabled.
                            </maml:para>
              <maml:para />
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Note: </maml:ui>Make sure that this computer really should be trusted for delegation before performing this procedure, as trusting for delegation could be a security risk.
                            </maml:para>
              <maml:para />
              <maml:para>To enable delegation for the local domain controller:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, click <maml:ui>Domain Controllers</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the computer that you want to configure (that is, the local domain controller), and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Trust this computer for delegation to any service (Kerberos only)</maml:ui>, and then click <maml:ui>OK</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Accept any confirmation dialog boxes.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2123 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337409(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337409(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2124" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service failed to join the computer's domain</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing was not able to join the domain or MSMQ Routing failed because of domain connectivity issues. This error might be caused by one of the following conditions: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Stale objects in Active Directory Domain Services (AD DS) are preventing Message Queuing from joining the domain.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The computer does not have connectivity and cannot join a domain.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Appropriate permissions are needed to create and access objects.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Support Options from Microsoft Services (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Stale objects in AD DS are preventing Message Queuing from joining the domain</maml:ui>
              </maml:para>
              <maml:para />
              <maml:para>To confirm the presence of stale computer objects:</maml:para>
              <maml:para />
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click Active <maml:ui>Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers </maml:ui>is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory integration is not installed on that particular computer, these objects are stale.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there are stale objects, see the section titled "Remove stale Active Directory objects."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>The computer does not have connectivity and cannot join a domain</maml:ui>
              </maml:para>
              <maml:para>If your computer does not have network or domain connectivity, see the section titled "Contact Microsoft."</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Appropriate permissions are needed to create and access objects</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and is a member of the local administrator group:</maml:para>
              <maml:para />
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, and then expand <maml:ui>Local Users and Groups.</maml:ui></maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>, and then confirm that the user is member of this group.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that the user does not have the appropriate permissions, see the section titled "Grant appropriate permissions."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To resolve this issue, use the resolution that corresponds to the cause you identified in the Diagnose section. After performing the resolution, see the Verify section to confirm that the feature is operating properly</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Cause</maml:ui>
                    </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Resolution</maml:ui>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Active Directory Domain Services has stale objects</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Remove stale Active Directory objects</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337405(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Appropriate permissions have not been granted</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Grant appropriate permissions</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337405(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>The computer has no connectivity or is not joined to domain</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Contact Microsoft</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337405(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para>
                <maml:ui>Remove stale Active Directory objects </maml:ui>
              </maml:para>
              <maml:para>Stale objects can prevent the MSMQ Service from operating properly. Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before deleting the computer object, make sure that no services running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer. </maml:para>
              <maml:para>You must have the Active Directory services tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Confirm that Active Directory services and control components are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory services and control components are installed properly:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory integration is not installed on that particular computer, these objects are stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Grant appropriate permissions </maml:ui>
              </maml:para>
              <maml:para>Message Queuing may not be able to create Active Directory objects if the account it is running under does not have appropriate permissions. Check the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Confirm that the user who is installing Message Queuing is a domain user as well as a member of the local administrators group.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the proper Active Directory service tools are installed.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the account is a domain user, contact your domain administrator to check privileges.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you have the appropriate permissions, grant the Message Queuing user account permission to modify child objects.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Confirm that the user who is installing Message Queuing is a domain user and a member of local administrators group</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and a member of the local administrators group:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management console. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, expand <maml:ui>Local Users and Groups</maml:ui>, and then click <maml:ui>Groups</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Members</maml:ui> section, confirm that the user is member of this group. If the user is not a member of the administrators group, add the user to the group.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Confirm that the proper Active Directory service tools are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that the proper Active Directory service tools are installed:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Ensure that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Grant the Message Queuing user account permission to modify child objects</maml:ui>
              </maml:para>
              <maml:para>If you have the appropriate permissions, use the following procedure to grant the Message Queuing user account permission to create and delete child objects. You must have the Active Directory services and control components installed in Role Administration Tools under the Remote Server Administration feature.</maml:para>
              <maml:para>To grant Message Queuing user account permissions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the name of your computer, and then click Properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Security</maml:ui> tab, make sure that the user is a part of a group that has permission to create and delete child objects.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>For more information about the correct access control settings, see your Active Directory documentation.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Contact Microsoft </maml:ui>
              </maml:para>
              <maml:para>If possible, consult with your domain administrator by providing the error description in the event. </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2124(<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337405(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337405(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2127" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing objects cannot move automatically between domains.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This error may be due to a faulty interforrest Message Queuing migration.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Interforrest Message Queuing Migration</maml:ui>
              </maml:para>
              <maml:para>
                                To ensure that this migration is executed correctly, see the Active Directory v3 Migration Guide (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=103526</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=103526" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para>If you were not trying to perform an interforrest migration, uninstall Message Queuing and then reinstall it in the new domain.</maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows 7)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows 7:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, click <maml:ui>Control Panel</maml:ui>, and then double-click <maml:ui>Programs and Features.</maml:ui></maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Turn Windows features on or off</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Clear the <maml:ui>Microsoft Message Queue (MSMQ) server</maml:ui> check box, and then click Remove.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Repeat steps 1 and 2. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Turn Windows features on or off section</maml:ui>, select the desired Message Queuing components to install.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Uninstall and reinstall Message Queuing (Windows Server 8)</maml:ui>
              </maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows Server 8:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Server Manager. To open Server Manager, click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, then click <maml:ui>Server Manager</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, click <maml:ui>Features</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the Details pane, in the <maml:ui>Feature Summary</maml:ui> section, click <maml:ui>Remove Features.</maml:ui></maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the Remove Features Wizard, clear the <maml:ui>Message Queue</maml:ui> check box, and then click <maml:ui>Remove</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        After Message Queuing has been removed, in Server Manager, click <maml:ui>Add Features.</maml:ui></maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the Add Features Wizard, select the desired Message Queuing components to install, and then click <maml:ui>Install</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about Interforrest Message Queuing Migration, see the Active Directory v3 Migration Guide (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=103526</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=103526" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2127 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337491(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337491(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2140" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This server was unable to resolve the IP addresses of other routing servers. </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>IP addresses must be assigned to all routing servers, and they must be registered properly in Domain Name System (DNS).</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Repair DNS issues and confirm that the Message Queuing routing servers have IP addresses</maml:ui>
              </maml:para>
              <maml:para>
                                Assign IP addresses to all routing servers, and make sure that they are registered in DNS. If that does not work, check the routing server configuration to ensure that the routing settings (in/out server, service is running, and others) are correct.
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2140 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337445(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337445(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2141" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The properties of the queue cannot be set. Copying the queue file to the temporary file returned an error.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Internally, the MSMQ Service tries to make a temporary copy of the queue file before changing the queue properties, or it tries to copy the new queue permissions file over the old permissions file. If creation of the temporary file fails, this might indicate insufficient disk space, permission problems, or file system errors. Make sure that the disk is not full and that the MSMQ Service can access the Message Queuing storage directory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm disk space and file permissions </maml:ui>
              </maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the MSMQ Service can access the Message Queuing storage directory: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services console. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, locate <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Check the <maml:ui>Log On As</maml:ui> column to see what user the service runs under.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the user under which the MSMQ Service is running under has permissions on the Message Queuing storage directory (%windir%\System32\msmq\storage).</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2141 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337429(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337429(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2142" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The properties of the queue cannot be set. Replacing the queue fil with the temporary file returned error.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Internally, the MSMQ Service tries to make a temporary copy of the queue file before changing the queue properties, or it tries to copy the new queue permissions file over the old permissions file. If creation of the temporary file fails, this might indicate insufficient disk space, permission problems, or file system errors. Make sure that the disk is not full and that the MSMQ Service can access the Message Queuing storage directory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm disk space and file permissions</maml:ui>
              </maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To confirm that the MSMQ Service can access the Message Queuing storage directory: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Services console. To open Services, click Start. In the search box, type services.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the details pane, locate Message Queuing. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Check the Log On As column to see what user the service runs under.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the user under which the MSMQ Service is running under has permissions on the Message Queuing storage directory (%windir%\System32\msmq\storage).</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2142 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337419(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337419(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2143" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Microsoft Distributed Transaction Coordinator (MSDTC) failed. The Message Queuing service stopped. Confirm the MSDTC and the MSMQ Service are running..</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSDTC failed and caused the MSMQ Service to stop.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that MSDTC is started. </maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that MSDTC is started:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Locate the <maml:ui>Distributed Transaction Coordinator </maml:ui>service, and then confirm that the value in the <maml:ui>Status</maml:ui> column is <maml:ui>Started</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the value is not <maml:ui>Started</maml:ui>, right-click the service, and then click <maml:ui>Start</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Ensure that the service is properly registered as a Component Object Model (COM) server. Click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>cmd</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type your COM server/Regserver, and then press ENTER. The COM server here is %windir%\system32\msdtc.exe.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm the MSMQ Service is running</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the MSMQ Service is installed and running:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Locate the <maml:ui>Message Queuing</maml:ui> service, and then confirm that the value in the <maml:ui>Status </maml:ui>column is <maml:ui>Started</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2143 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337412(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337412(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2145" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The computer object for this computer was not found in Active Directory, possibly because of Active Directory replication delays.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The computer object for this computer was not found in Active Directory, possibly because of Active Directory replication delays.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>There is an issue with replication delays. This issue should be resolved after Active Directory Domain Services (AD DS) replicates itself. After replication is complete, try to create the Active Directory object again:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>For smaller networks, replication should take a few minutes.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>For larger networks, the replication may take a long time.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                                Advanced users and domain administrators can also use the Knowledge Consistency Checker (KCC) to configure replication delays. For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about optimizing Active Directory replication in a large network, see article 244368 in the Microsoft Knowledge base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107511</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107511" /></maml:navigationLink>)
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2145 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337528(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337528(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2147" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The service cannot start due to insufficient disk space or memory.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service needs adequate memory resources to function properly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Try identifying and closing other applications that may be consuming a large amount of memory. If it turns out that the MSMQ Service is the only program consuming a large amount of memory, try receiving the messages from the queues or increasing the rate of message processing. </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Services snap-in. To open Services, click Start. In the search box, type services.msc, and then press ENTER. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the Message Queuing service, and then click Restart. You must restart all the dependent services, as well. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                                If a quota has been set for the Message Queuing service, try increasing it. For more information about Message Queuing computer quotas, see article 899612 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107359</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107359" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2147 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337529(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337529(WS.10).aspx" /></maml:navigationLink></maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2148" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The service cannot start due to its failure to connect to its device driver.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>There is a problem with the Mqac.sys file. This file is located in the System32 folder under the Windows directory (usually C:\Windows).</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>Restart the MSMQ Service</maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the <maml:ui>Message Queuing</maml:ui> service, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>If this does not work, reinstall Message Queuing.</maml:para>
              <maml:para>Uninstall and reinstall Message Queuing (Windows 7)</maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows 7:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Click Start, click Control Panel, and then double-click Programs and Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Clear the Microsoft Message Queue (MSMQ) server check box, and then click Remove.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Repeat steps 1 and 2. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Turn Windows features on or off section, select the desired Message Queuing components to install.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Uninstall and reinstall Message Queuing (Windows Server 8)</maml:para>
              <maml:para>To uninstall Message Queuing and then reinstall it on Windows Server 8:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, then click Server Manager.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, click Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the details pane, in the Feature Summary section, click Remove Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Remove Features Wizard, clear the Message Queue check box, and then click Remove.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>After Message Queuing has been removed, in Server Manager, click Add Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Add Features Wizard, select the desired Message Queuing components to install, and then click Install.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2148 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337502(WS.10).aspx)</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337502(WS.10).aspx)" /></maml:navigationLink></maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2155" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service stopped monitoring the mapping folder. If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing service stopped monitoring the mapping folder.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2155 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337506(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337506(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2156" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>A mapping file was ignored. Its content cannot be read. If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A mapping file was ignored. Its content cannot be read.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more Information, see Event ID 2156 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337507(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337507(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2157" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Mapping file URL already mapped to another queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A queue alias, or URL, is being used multiple times in the Message Queuing mapping file or files.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Eliminate duplicate mappings in the Message Queuing mapping files.</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To eliminate duplicate mappings:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>In Windows Explorer, navigate to %windir%\System32\msmq\Mapping. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Open the desired mapping file, and locate the alias that is indicated in the event description. Note that mapping files are .xml files.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Replace the duplicate queue alias with a unique alias.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2157 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337490(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337490(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2158" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>A mapping file was ignored because it was improperly formatted. Ensure that the XML file is valid and that queue mappings are correct.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A mapping file was ignored because it was improperly formatted. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Ensure that the XML file is valid and that queue mappings are correct</maml:ui>
              </maml:para>
              <maml:para>The mapping file that is referred to is not formatted properly. Confirm that the mapping file is a valid XML document with correct queue mappings.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about Message Queuing mapping files, see HTTP Message Redirection (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104806</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104806" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2158 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337459(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337459(WS.10).aspx" /></maml:navigationLink>).
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2160" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The queue cannot listen/bind to the multicast address.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The multicast address that is specified in the event is not valid. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Change the multicast address</maml:ui>
              </maml:para>
              <maml:para>Enter a valid multicast address for the queue which is using this address. IP multicast addresses must consist of four bytes and must lie in the class D range from 224.0.0.0 to 239.255.255.255. However, only certain ranges of addresses in this range are available for sending multicast messages.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Internet Multicast Addresses (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=94475</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=94475" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information about setting up multicasting queues, see Specify or View Queue Multicast Addresses and Ports (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=102330</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=102330" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2160 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337451(WS.10).aspx)</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337451(WS.10).aspx)" /></maml:navigationLink></maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2161" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Invalid URL mapped to queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The queue that is indicated in the event does not have a correctly formed URL-style queue name in an MSMQ SFD mapping file.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm the existence of a valid queue</maml:ui>
              </maml:para>
              <maml:para>The following are examples of valid name formats: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>HTTP://ComputerAddress/msmq/PublicQueue</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>HTTP://ComputerAddress/msmq/private$\PrivateQueue</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>HTTPS://ComputerAddress/msmq/PublicQueue</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>HTTPS://ComputerAddress/msmq/private$\PrivateQueue</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Note:</maml:ui> In these examples, ComputerAddress can be specified as the name, Hypertext Transfer Protocol (HTTP) URL, or IP address that is associated with the destination computer.
                            </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To fix the queue name:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>In Windows Explorer, navigate to %windir%\System32\msmq\Mapping. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Open the desired mapping file. Note that mapping files are .xml files.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Locate the queue that is indicated in the event, and then modify the name so that it is properly formatted.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about creating valid queue format names, see Queue Names (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104739</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104739" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2161 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337521(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337521(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2164" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service will not join the domain. An MSMQ Configuration (msmq) object exists in the new domain with an ID differing from the service ID.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Stale objects can prevent the MSMQ Service from operating properly. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Remove stale Active Directory objects</maml:ui>
              </maml:para>
              <maml:para>Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before deleting the computer object, make sure that no services running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer.</maml:para>
              <maml:para>You must have the Active Directory services tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that Active Directory services and control components are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory services and control components are installed properly:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui> Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui> Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View </maml:ui>menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory integration is not installed on that particular computer, these objects are stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2164 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337449(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337449(WS.10).aspx" /></maml:navigationLink> )
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2165" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The site where the computer resides cannot be resolved. Check that the subnets in your network are configured correctly in Active Directory and that each site is configured with the appropriate subnet. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The subnets may not be configured correctly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Possible actions include the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Reconfigure the Active Directory subnets in your network.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Configure each site with the appropriate subnet.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>Contact your domain administrator to resolve this issues.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2165 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337454(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337454(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2168" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service resource cannot bind to the cluster IP Address.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The MSMQ Service on the physical node must be cluster aware. If the service is not cluster aware, this prevents the Message Queuing resource from coming online on this node.</maml:para>
              <maml:para>This problem can occur if the MSMQ Service running on the physical node was started before the computer became a member of the server cluster. As a result, the MSMQ Service running on the physical node listens on all IP addresses of the computer and prevents the Message Queuing resource from listening on the cluster IP address.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the <maml:ui>Message Queuing</maml:ui> service, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Verify</maml:ui>
              </maml:para>
              <maml:para>You can use Failover Cluster Management to determine whether the Message Queuing cluster resource is online, or you can use the Cluster.exe tool to determine whether Windows Failover Clustering is installed and running.</maml:para>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2168 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337422(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337422(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2169" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The local computer is a Message Queuing routing server that formerly belonged to a domain and is now operating in workgroup mode. Other Message Queuing clients still regard this computer as a routing server and will try to route messages through this computer</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Stale computer objects can cause the MSMQ Service to not operate properly. Deleting stale computer objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before you delete a computer object, make sure that no services running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on the computer.</maml:para>
              <maml:para>This error might be caused by one of the following conditions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Stale Computer objects</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Configuration errors in the Directory Service Integration feature.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Stale computer objects</maml:ui>
              </maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Determine whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory Integration is not installed on this particular computer, this object is stale. Delete that particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Configuration errors in the Directory Service Integration feature.</maml:ui>
              </maml:para>
              <maml:para>You can confirm the presence of the Directory Service Integration feature by doing the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Verify the registry key setting</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Verify that the computer is joined to the correct domain</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Verify Active Directory operation</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Caution</maml:ui>: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:para>
                <maml:ui>Verify the registry key setting</maml:ui>
              </maml:para>
              <maml:para>To verify the registry key setting:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In Registry Editor, expand <maml:ui>HKEY_LOCAL_MACHINE</maml:ui>, expand <maml:ui>SOFTWARE</maml:ui>, expand <maml:ui>Microsoft</maml:ui>, expand <maml:ui>MSMQ</maml:ui>, and then click <maml:ui>Setup</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>msmq_ADIntegrated</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Confirm that <maml:ui>Value data</maml:ui> is set to <maml:ui>1</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Under <maml:ui>MSMQ</maml:ui>, expand <maml:ui>Parameters</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Workgroup</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Confirm that <maml:ui>Value data</maml:ui> is not set to <maml:ui>1</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Verify that the computer is joined to the correct domain</maml:ui>
              </maml:para>
              <maml:para>To verify that the computer is joined to the correct domain:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Server Manager. To open Server Manager, click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, and then click <maml:ui>Server Manager</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Confirm that the domain that is listed in <maml:ui>Computer Information</maml:ui> is the correct domain.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Verify Active Directory operation</maml:ui>
              </maml:para>
              <maml:para>You can confirm that Active Directory is operating correctly by verifying that the Public Queue feature is enabled in Message Queuing. </maml:para>
              <maml:para>To verify that the Public Queue feature is enabled:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Navigate to <maml:ui>MSMQ</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the <maml:ui>Public Queues</maml:ui> folder exists and you can right-click the folder, Message Queuing is operating correctly in domain mode with Active Directory Integration.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>For further confirmation, run a test application that uses the Active Directory features that you require.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2169 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337420(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337420(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2170" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing failed to bind to port 1801. The port may already be bound to another process. If this problem arises during setup, you must free the port and run setup again.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing failed to bind to port 1801. The port may already be bound to another process. If this problem arises during setup, you must free the port and run setup again. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To optimize the establishment of connections:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Free port 1801</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>and then Restart the MSMQ Service</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Free port 1801</maml:ui>
              </maml:para>
              <maml:para>Message Queuing must bind to port 1801 to function. Make sure that the port is free (no other programs are trying to use it) and try to start the MSMQ Service again after allowing time for the port to close. </maml:para>
              <maml:para>If this problem occurs during setup, you must free the port and run Setup again.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2170 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337489(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337489(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2171" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing cannot bind to UDP port 3527.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing internal ping mechanism uses User Datagram Protocol (UDP) port 3527 to establish network connections. Another process may be using this port. Message Queuing can continue to operate without using this port, but connection times will not be optimal. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To optimize the establishment of connections:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Free port 3527</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>and then Restart the MSMQ Service</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Free port 3527</maml:ui>
              </maml:para>
              <maml:para>Message Queuing must bind to port 3527 to function. Make sure that the port is free (no other programs are trying to use it) and try to start the MSMQ Service again after allowing time for the port to close. </maml:para>
              <maml:para>If this problem occurs during setup, you must free the port and run Setup again.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Restart the MSMQ Service</maml:ui>
              </maml:para>
              <maml:para>To restart the MSMQ Service:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Restart</maml:ui>. You must restart all the dependent services, as well.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2171 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337527(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337527(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2172" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The MsmqServices object is configured with weakened security to support MSMQ 1.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing service needed to modify the security settings to be able to communicate with MSMQ 1.0</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your Domain Administrator to know if this is an expected behavior.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2175" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing will use an encryption key with an effective length of 40 bits when sending messages encrypted with the RC2 encryption algorithm.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>As a result of a bug in CryptoAPI (in Windows NT 4.0 Service Pack 2 (SP2) through Service Pack 5 (SP5)), enhanced RC2 keys were created with an effective length of 40 bits (instead of 128 bits). This bug was fixed in Windows Server 2003, Windows XP Service Pack 1 (SP1), and Windows 2000 Service Pack 4 (SP4).</maml:para>
              <maml:para>If you use enhanced RC2 encryption with the following operating systems, the message cannot be decrypted unless a registry key is set on the sender.</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui> From</maml:ui>
                    </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:ui> To</maml:ui>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Windows Server 2003</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Windows XP</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Windows XP SP1 and SP2 </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Windows 2000 (up to Service Pack 3 (SP3))</maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para />
                  </maml:entry>
                  <maml:entry>
                    <maml:para>Windows NT 4.0</maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para>The fix for Windows 2000 SP4 uses a registry key as well but defaults to compatibility with earlier service packs. </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para> To enable backward compatibility and enhance security, the following registry values were added to all platforms.</maml:para>
              <maml:para>Windows XP Service Pack 1, Windows Server 2003</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                    <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security\SendEnhRC2With40</maml:ui>: The default value is 0; use an effective length of 128 bits. A nonzero value reverts to Windows 2000 behavior, where the key is created with an effective length of 40 bits.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                    <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security\RejectEnhRC2IfLen40</maml:ui>: The default value is 0; all key lengths are accepted. To enhance security so that messages that use an effective length of 40 will be rejected, set this value to 1.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Windows 2000 Service Pack 4</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                    <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security\SendEnhRC2With128</maml:ui>: The default value is 0; use an effective length of 40 bits. A nonzero value forces an effective length of 128 bits. This improves security but might not be compatible with other computers.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                    <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security\RejectEnhRC2IfLen40</maml:ui>: The default value is 0; all key lengths are accepted. To enhance security so that messages that use an effective length of 40 will be rejected, set this value to 1.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>If your enterprise no longer has computers running Message Queuing (also known as MSMQ) on Windows NT 4.0, Windows 2000 Server below SP4, or Windows XP below SP1, consider the following registry modifications:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>On all computers, eliminating the SendEnhRC2With40 key, if it is present. This key needlessly weakens security by forcing computers that can use a 128-bit key to use a 40-bit key instead. For more information, see the "Delete registry key" section.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Adding SendEnhRC2With128 keys to your Windows 2000 SP4 computers, with the value 1. This enhances security by making it possible for these computers to use a 128-bit key instead of a 40-bit key for compatibility. For more information, see the "Add registry key" section.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Adding RejectEnhRC2IfLen40 keys to all of your computers, with the value 1. This enhances security by requiring that incoming messages using enhanced RC2 encryption have a 128-bit key. For more information, see the "Add registry key" section, modifying for this key, as necessary.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Delete a registry key</maml:para>
              <maml:para>To delete a registry key:</maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data. </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type regedit, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Browse to <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security\RejectEnhRC2IfLen40</maml:ui>, and then delete the registry key.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Add a registry key</maml:para>
              <maml:para>To add a registry key (Windows 2000 SP4):</maml:para>
              <maml:para>Caution: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data. </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type regedit, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Browse to <maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Security</maml:ui>, point to <maml:ui>New</maml:ui>, and then click <maml:ui>Add</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Set the value to <maml:ui>1</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2175 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337468(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337468(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2177" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service rejects incoming messages when it is unable to check whether the sender is allowed access to the queue for sending messages. Note that an event might not be issued every time this problem occurs.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This event usually occurs because the MSMQ Service does not have access to the group memberships of the sending user.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Modify permissions</maml:ui>
              </maml:para>
              <maml:para>Add only the computer accounts that need access to the Windows Authorization Access Group. The domain administrator will repeat this operation for other Message Queuing computers that require the permission, manually adding the relevant accounts to the Windows Authorization Access Group.</maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To add the MSMQ Service account:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, and then click <maml:ui>Active Directory Users and Computers</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In Active Directory Users and Computers, click <maml:ui>Builtin</maml:ui>, and then double-click <maml:ui>Windows Authorization Access Group</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>Members</maml:ui> tab, and then add the MSMQ Service account to the members list.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2177 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337504(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337504(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2182" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Storage quota exceeded for MSMQ queue. No more messages can be stored in the queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A Message Queuing queue quota has been reached.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Reduce the outstanding message count</maml:ui>
              </maml:para>
              <maml:para>To resolve this issue:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Process existing messages in the queue to reduce the outstanding message count below the queue quota threshold. Confirm that messages are being processed at a higher rate than they are being queued. This may require additional hardware or changes to solution architecture.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        You may also increase the specific queue quota. For more information about Message Queuing queue quotas, see article 899612 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=107359</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=107359" /></maml:navigationLink>).
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                To avoid this problem in the future, the sending application should request negative acknowledgements (NACK) from the computer to which it is sending messages. If a NACK is returned to the sending application and it indicates that the quota for the destination queue or computer has been reached, the sending application can either stop sending messages or offload the messages to another destination. Nacks and Acks are requested programmatically by the sender. For more information, see Reliable Messaging with MSMQ and .NET (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=95381</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=95381" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>You can use the perfmon command-line tool to monitor various data points related to the incoming and outgoing messages in Message Queuing. </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To use perfmon to monitor data:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open a command prompt. To open a command prompt, click Start. In the search box, type cmd, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type Perfmon, and then press ENTER. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, under Monitoring Tools, click Performance Monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the details pane, click the green plus sign (+) to add a monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Add counters tab, under Counters, click the plus sign (+) next to MSMQ Service. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the appropriate counters that you need.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Add, and then click OK.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2182 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337533(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337533(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2183" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Machine MSMQ storage quota was exceeded or there is insufficient disk space. No more messages can be stored in user queues.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing machine quota has been reached. The sending application should request negative acknowledgements (NACK) from the computer to which it is sending messages. If a NACK is returned to the sending application and indicates that the quota for the destination queue or computer has been reached, the sending application can either stop sending messages or offload the messages to another destination.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Get messages below the quota</maml:para>
              <maml:para>Process existing messages in the queues to reduce the outstanding message count below the machine quota threshold. Confirm that messages are being processed at a higher rate than they are being queued.</maml:para>
              <maml:para>To monitor Message Queuing with Performance Monitor: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open a command prompt. To open a command prompt, click Start. In the search box, type cmd, and then press ENTER. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type Perfmon, and then press ENTER. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, under Monitoring Tools, click Performance Monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the green plus sign to add a monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Add counters tab, in the Counters section, click MSMQ Service. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the Total messages in all queues counter. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Add, and then click OK. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about Message Queuing computer quotas, see article 899612 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107359</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107359" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2183 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337474(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337474(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2184" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not resolve a name to an IP address. </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Network-name-to-IP-address resolution has failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm DNS Settings</maml:ui>
              </maml:para>
              <maml:para>
                              Confirm that the compute name that is specified in the event is a valid computer name on the network. If it is a valid computer name, confirm the recipient computer’s Domain Name System (DNS) settings, and then use the <maml:ui>ping</maml:ui> command to contact the recipient computer by network name to confirm name resolution functionality.
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2184 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337401(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337401(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2185" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>A socket operation failed. Message Queuing cannot send the message now, but will retry to send the message.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A socket operation failed. Message Queuing cannot send the message now, but will retry to send the message.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Ensure network connectivity with the host</maml:ui>
              </maml:para>
              <maml:para>The MSMQ Service failed to connect to the host that is referred to in the event description.</maml:para>
              <maml:para>Make sure that the host computer is online, and ensure that you have network connectivity to the host.</maml:para>
              <maml:para>You may have to contact the domain administrator with the socket error code that is provided in the event.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2185 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337456(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337456(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2187" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not establish connection, because connection was refused by the recipient computer.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing connection was refused by the recipient computer.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Contact your domain administrator</maml:ui>
              </maml:para>
              <maml:para>Confirm network connectivity to the host that is referred in the event description. This error can also occur if there are no more Client Access Licenses (CALs) available on the host or if the connection limit for the host has been reached. Contact your domain administrator for additional information. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2187 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337423(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337423(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2188" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not access Active Directory and failed to compute routing path for messages sent to queue. Messages will wait in the outgoing queue until connection with Active Directory is restored.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing was not able to join the domain or MSMQ Routing failed because of domain connectivity issues. This error might be caused by one of the following conditions: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Stale objects in Active Directory Domain Services (AD DS) are preventing Message Queuing from joining the domain.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The computer does not have connectivity and cannot join a domain.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Appropriate permissions are needed to create and access objects.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Stale objects in AD DS are preventing Message Queuing from joining the domain</maml:ui>
              </maml:para>
              <maml:para>To confirm the presence of stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>,and then click<maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View </maml:ui>menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory integration is not installed on that particular computer, these objects are stale.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there are stale objects, see the section titled "Remove stale Active Directory objects."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>The Computer does not have connectivity and cannot join a domain.</maml:ui>
              </maml:para>
              <maml:para>If your computer does not have network or domain connectivity, see the section titled “Contact Microsoft”</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Appropriate permissions are needed to create and access objects</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and is a member of the local administrator group:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, and then expand <maml:ui>Local Users and Groups</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>, and then confirm that the user is member of this group.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>If you determine that the user does not have the appropriate permissions, see the section titled "Grant appropriate permissions."</maml:para>
              <maml:para>"</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To resolve this issue, use the resolution that corresponds to the cause you identified in the Cause section. After performing the resolution, see the Verify section to confirm that the feature is operating properly</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Cause</maml:ui>
                    </maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:ui>Resolution</maml:ui>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Active Directory Domain Services has stale objects</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Remove stale Active Directory objects</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337487(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>Appropriate permissions have not been granted</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Grant appropriate permissions</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337487(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>The computer has no connectivity or is not joined to domain</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                      <maml:navigationLink>
                        <maml:linkText>Contact Microsoft</maml:linkText>
                        <maml:uri href="http://technet.microsoft.com/en-us/library/dd337487(WS.10).aspx" />
                      </maml:navigationLink>
                    </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para>
                <maml:ui>Remove stale Active Directory objects </maml:ui>
              </maml:para>
              <maml:para>Stale objects can prevent the MSMQ Service from operating properly. Deleting stale objects may solve this problem. However, deleting a computer object in Active Directory Domain Services (AD DS) can cause problems on the client computer. Before deleting the computer object, make sure that no services running on the client computer will be affected. In this case, deleting the Message Queuing Active Directory object will delete public queues on that computer. </maml:para>
              <maml:para>You must have the Active Directory services tools installed in Role Administration tools under Remote Server Administration.</maml:para>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Confirm that Active Directory services and control components are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that Active Directory services and control components are installed properly:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Delete stale computer objects</maml:ui>
              </maml:para>
              <maml:para>To delete stale computer objects:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative</maml:ui><maml:ui>Tools</maml:ui>, right-click Acti<maml:ui>ve Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the particular computer. Check whether there are Message Queuing objects present under that computer. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If there are Message Queuing objects and Message Queuing with Active Directory integration is not installed on that particular computer, these objects are stale. Delete the particular Message Queuing Active Directory object, and then restart the MSMQ Service or, if necessary, restart the computer. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Grant appropriate permissions </maml:ui>
              </maml:para>
              <maml:para>Message Queuing may not be able to create Active Directory objects if the account it is running under does not have appropriate permissions. Check the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Confirm that the user who is installing Message Queuing is a domain user as well as a member of the local administrators group.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the proper Active Directory service tools are installed.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the account is a domain user, contact your domain administrator to check privileges.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you have the appropriate permissions, grant the Message Queuing user account permission to modify child objects.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>
                <maml:ui>Confirm that the user who is installing Message Queuing is a domain user and a member of local administrators group</maml:ui>
              </maml:para>
              <maml:para>To confirm that the user who is installing Message Queuing is a domain user and a member of the local administrators group:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management console. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>System Tools</maml:ui>, expand <maml:ui>Local Users and Groups</maml:ui>, and then click <maml:ui>Groups</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, double-click <maml:ui>Administrators</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Members</maml:ui> section, confirm that the user is member of this group. If the user is not a member of the administrators group, add the user to the group.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Confirm that the proper Active Directory service tools are installed</maml:ui>
              </maml:para>
              <maml:para>To confirm that the proper Active Directory service tools are installed:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then click <maml:ui>Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Ensure that the following Active Directory tools appear in the list: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Domains and Trusts</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Sites and Services</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Active Directory Users and Computers</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Grant the Message Queuing user account permission to modify child objects</maml:ui>
              </maml:para>
              <maml:para>If you have the appropriate permissions, use the following procedure to grant the Message Queuing user account permission to create and delete child objects. You must have the Active Directory services and control components installed in Role Administration Tools under the Remote Server Administration feature.</maml:para>
              <maml:para>To grant Message Queuing user account permissions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Start</maml:ui>, point to <maml:ui>Administrative Tools</maml:ui>, right-click <maml:ui>Active Directory Users and Computers</maml:ui>, and then <maml:ui>click Run as administrator</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>View</maml:ui> menu, ensure that <maml:ui>Users, Contacts, Groups and Computers as containers</maml:ui> is selected and that <maml:ui>Advanced Features</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the name of your computer, and then click Properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Security tab, make sure that the user is a part of a group that has permission to create and delete child objects. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>For more information about the correct access control settings, see your Active Directory documentation.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Contact Microsoft </maml:ui>
              </maml:para>
              <maml:para>If possible, consult with your domain administrator by providing the error description in the event. </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>Verify</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Support Options from Microsoft Services (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2188 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337487(WS.10).aspx)</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337487(WS.10).aspx)" /></maml:navigationLink></maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2189" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing failed to send a message due to low memory. Message Queuing will retry to send the message.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Free memory from other applications</maml:para>
              <maml:para>The MSMQ Service needs adequate memory resources to function properly. </maml:para>
              <maml:para>
                                Try identifying and closing other applications that may be consuming a large amount of memory. If it turns out that the MSMQ Service is the only program consuming a large amount of memory, try receiving the messages from the queues or increasing the rate of message processing. For more information, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2189 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337495(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337495(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2190" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not complete SSL negotiation with the remote computer.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This issue may have one of the following causes:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        The server certificate may not be installed properly. For more information about Message Queuing with Secure Hypertext Transfer Protocol (HTTPS), including information about server certificates as they apply to Message Queuing, see HTTPS Authentication (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104331</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104331" /></maml:navigationLink>).
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The remote computer may not be listening with HTTPS on port 443 (SSL). You can use the procedure "Determine if the computer is listening on port 443" to determine if this is the issue.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The Windows Firewall may be blocking communicaqtion over port 443. You can use the procedure "Ensure that Windows Firewall is allowing communication over port 443" to determine if this is the issue.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm configuration of SSL/HTTPS for Message Queuing </maml:ui>
              </maml:para>
              <maml:para>
                <maml:ui>Determine if the computer is listening on port 443</maml:ui>
              </maml:para>
              <maml:para>To determine if the computer is listening on port 443: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open a command prompt. To run open a command prompt, click Start. In the search box, type cmd, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type netstat -aon, and then press ENTER. A list of listening and active ports and services is output by the command. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>If the computer is listening on TCP port 443, the following local address entries will appear in resulting list when you run the netstat -aon command: 0.0.0.0:443 (IPv4) [::]:443 (IPv6).</maml:para>
              <maml:para>
                <maml:ui>Ensure that Windows Firewall is allowing communication over port 443</maml:ui>
              </maml:para>
              <maml:para>To ensure that Windows Firewall is allowing communication over port 443:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Click Start, point to Administrative Tools, and then click Windows Firewall with Advanced Security. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you are prompted, enter Administrator credentials, and then continue through the User Access Control messages. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, click Inbound Rules. The rules appear in the details pane. Note that it may take a few seconds for the rules to load and appear.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Locate the rule World Wide Web Services (HTTPS Traffic-In) listening on local port 443. (You may have to scroll to see the port that a rule is listening on.)</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Make sure that the rule is Enabled, the rule’s Action is set to Allow the connections, and the network profile type of the computer’s Internet connection matches the profile that the rule applies to (Public, Private, or Domain). The default profile for this rule is Any. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you need help figuring out which machine SSL negotiation failed (the remote computer), contact Microsoft Customer Service and Support (CSS) to take a Message Queuing trace. For information about how to contact CSS, see Enterprise Support  (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2190 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337498(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337498(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2191" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not validate server certificate in HTTPS scenario because the certificate was found in disallowed store. This means the certificate cannot be trusted.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The certificate may have been revoked or otherwise disallowed. Therefore, it could not be trusted.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your domain administrator to decide how to resolve this issue.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2191 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337431(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337431(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2192" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not establish SSL connection with the recipient computer because a trust chain from the server certificate to a trusted Certificate Authority certificate could not be established.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The trust chain could not be established.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>For more information, please contact your domain administrator with the error code to resolve the specific issue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2192 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337452(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337452(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2193" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not establish SSL connection with the recipient computer because the computer name specified in the HTTP queue format name does not match the name of the recipient server certificate.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Although the certificate chain from the server was verified, the computer name that is specified in the queue format is different from the name of the recipient in the server certificate. Make sure that the computer name in the server certificate is correct.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                For more information about server certificates, see “Server certificates” in HTTPS Authentication (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=104331</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=104331" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>To confirm the computer name in the server certificate:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the MMC Certificates snap-in. For information about installing and using MMC Certificates, see How to: View Certificates with the MMC Snap-in (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=94369</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=94369" /></maml:navigationLink>).
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Console Root</maml:ui> window, double-click <maml:ui>Certificates (Local Computer)</maml:ui>, double-click <maml:ui>Personal</maml:ui>, and then double-click <maml:ui>Certificates</maml:ui> to view the certificate stores for the computer.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Double-click the server certificate.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Details </maml:ui>tab of the server certificate, click <maml:ui>Issuer</maml:ui> and make sure that the Common Name (<maml:ui>CN</maml:ui>) matches the computer name in the Secure Hypertext Transfer Protocol (HTTPS) direct format name that is used to send the message.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2193 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337455(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337455(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2194" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Message Queuing service cannot communicate with other computers, because the select API for socket failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The selected application programming interface (API) may have failed for several different reasons. The most common reason for this failure is socket connection time-out.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Provide network connectivity</maml:ui>
              </maml:para>
              <maml:para>Make sure that the computer has connectivity to the network. To resolve the specific issue, contact your system administrator with the error code that indicates why the socket connection failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2194 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337440(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337440(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2195" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing could not authenticate a message sent to queue. The message was rejected because the queue only accepts authenticated messages. A negative arrival acknowledgement will be sent if requested by the sender.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Because the queue accepts only authenticated messages, messages that are sent to the queue must be authenticated and signed with a certificate, which is registered in Active Directory Domain Services (AD DS).</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that messages are authenticated and that the sending computer has a valid certificate</maml:ui>
              </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm the presence of user certificates:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        On any computer in the domain, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Enter administrator credentials, if you are prompted, and then continue through the User Access Control messages.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Navigate to the Message Queuing console tree. Click <maml:ui>Services and Applications</maml:ui>, and then click <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing</maml:ui>, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>User Certificate</maml:ui> tab.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>View</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Determine whether the computer sending the unauthenticated messages is in the <maml:ui>Personal Certificates</maml:ui> list.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the computer is not in the list, a certificate was not registered.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        You can fix this by performing steps 1 through 7 on the computers on which the certificate was not registered. For step 6, click <maml:ui>Register</maml:ui> instead of <maml:ui>View</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about signing messages, see Message Authentication (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=104732</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=104732" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2195 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337486(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337486(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2196" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing failed to verify digital signature of a message sent to queue. The message was rejected. A negative arrival acknowledgement will be sent if requested by the sender</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The message's signature could not be verified. This may indicate the following issues:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Weak hash function issues</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Bad user certificate </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Corruption of the message in transit</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that the Message Queuing application is using a strong hash function and that it has a valid user certificate</maml:ui>
              </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Resolve weak hash function issues</maml:ui>
              </maml:para>
              <maml:para>
                                By default, Message Queuing 4.0 does not support certain weaker security algorithms that were available in earlier versions of Message Queuing. Support for the weaker security algorithms can be enabled with a registry entry. For more information about the security algorithms that are supported by Message Queuing 4.0, see PROPID_M_HASH_ALG (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=91702</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=91702" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>Message Queuing has historically offered four hashing algorithms with which to sign a message: MD2, MD4, MD5, and SHA1. In previous versions of Message Queuing, MD5 was the default for most message and SHA1 was used for Hypertext Transfer Protocol (HTTP) and multicast messaging, which were introduced in Message Queuing 3.0. SHA1 is now the default for all types of messages, because MD2, MD4, and MD5 have been deprecated as weak. Also, by default, Message Queuing 4.0 will neither accept messages that are signed with these weak algorithms nor generate them.</maml:para>
              <maml:para>You can enable weaker algorithms on Message Queuing 4.0 to support any Message Queuing applications that require them by adding the registry key (not value) HKLM\SOFTWARE\Microsoft\MSMQ\Parameters\Security\WeakHashAlgorithms. If this registry key is not present, as is the case by default, all weaker algorithms are disabled. If this registry key is present, all weaker algorithms are enabled. To enable only certain weak algorithms, you must add the registry key and then specify the values of those weaker algorithms that you want to continue to disable.</maml:para>
              <maml:para>
                <maml:ui>Caution</maml:ui>: Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:para>To perform the following procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To continue to disable certain weaker authentication algorithms: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Registry Editor. To open Registry Editor, click Start. In the search box, type regedit, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Navigate to HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ\Parameters\Security.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Edit menu, point to New, and then click Key.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Type WeakHashAlgorithms as the name of the new registry key, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click WeakHashAlgorithms, point to New, click DWORD (32-bit) Value, and then type any name for the new value. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Double-click the new DWORD (32-bit) value, click Decimal, and then in Value data type the appropriate value for the algorithm that you want to disable: </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>32769 for MD2</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>32770 for MD4</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>32771 for MD5</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>32773 for MAC</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click OK to close the Edit DWORD (32-bit) Value dialog box.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Create new DWORD (32-bit) values for additional algorithms that you also want to disable.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the File menu, click Exit to close Registry Editor.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>If your Message Queuing application is running on Windows 7 and it chooses a weaker authentication algorithm, Message Queuing will override the choice and use SHA1 instead, by default. If you need to generate messages on Message Queuing 4.0 with one of the weak algorithms, there is a registry key that will turn off the upgrading and make Message Queuing 4.0 honor the algorithm requested by your code. Create a DWORD registry value named WeakHashAlgUpgrade under the key HKLM\SOFTWARE\Microsoft\MSMQ\Parameters\security and set it to 0, and then restart the MSMQ Service. </maml:para>
              <maml:para />
              <maml:para>For more information, see the following resources:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        PROPID_M_HASH_ALG (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=91702</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=91702" /></maml:navigationLink>)
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Authentication for Message Queuing (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104934</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104934" /></maml:navigationLink>)
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Fix an issue with a bad user certificate</maml:ui>
              </maml:para>
              <maml:para>To fix an issue with a bad user certificate:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>On any computer in the domain, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Enter administrator credentials, if you are prompted, and continue through the User Access Control messages.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Navigate to the Message Queuing console tree (Services and Applications\Message Queuing).</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click Message Queuing, and then click Properties.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the User Certificate tab.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click View.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Check to see whether the computer sending the unauthenticated messages is in the Personal Certificates list.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If the computer is not in the list, a certificate was not registered.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>You can fix this by performing steps 1 through 7 on the computers on which the certificate was not registered. Then, for step 6, click Register instead of View.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Fix a corrupted message</maml:ui>
              </maml:para>
              <maml:para>If you think the message was corrupted in transit, there is probably an issue with a level below Message Queuing.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2196 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337461(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337461(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2197" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing failed to listen on the IPv6 protocol. Messages will not be accepted on IPv6.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing is not able to listen to messages on IP version 6 (IPv6). This problem might be caused by one of the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>IPv6 is not supported.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>IPv6 is not Installed</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>IPv6 is not supported</maml:ui>
              </maml:para>
              <maml:para>Contact your domain administrator to find out if IPv6 can be installed on this computer, because your hardware or software may not support IPv6.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>IPv6 is not Installed</maml:ui>
              </maml:para>
              <maml:para>To enable the protocol yourself or to determine whether it is supported:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Control Panel. To open Control Panel, click <maml:ui>Start</maml:ui>, and then click <maml:ui>Control Panel</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Double-click <maml:ui>Network and Sharing Center</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Tasks </maml:ui>section, click <maml:ui>Manage Network Connections</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Network Connections</maml:ui>, right-click the local area network (LAN) icon or your appropriate network controller, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Networking</maml:ui> tab, make sure that the <maml:ui>Internet Protocol Version 6 (TCP/IPv6)</maml:ui> check box is selected.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2197 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337400(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337400(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2198" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing failed to listen on the IPv4 protocol. Messages will not be accepted on IPv4.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing is not able to listen to messages on IP version 4 (IPv4). This problem might be caused by one of the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>IPv4 is not enabled</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>IPv4 is not supported by hardware or software</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>IPv4 is not enabled</maml:ui>
              </maml:para>
              <maml:para>If IPv4 is disabled, you can enable it yourself by using the following procedure</maml:para>
              <maml:para>To enable IPv4:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Control Panel. Click <maml:ui>Start</maml:ui>, and then click <maml:ui>Control Panel</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Double-click <maml:ui>Network and Sharing Center</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Tasks </maml:ui>section, click <maml:ui>Manage Network Connections</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Network Connections</maml:ui>, right-click the local area network (LAN) icon or your appropriate network controller, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Networking</maml:ui> tab, make sure that the <maml:ui>Internet Protocol Version 4 (TCP/IPv4)</maml:ui> check box is selected.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>IPv4 is not supported by hardware or software</maml:ui>
              </maml:para>
              <maml:para>Check with your domain administrator for more details.</maml:para>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2198 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337418(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337418(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2199" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing Service failed to listen on both IPv4 and IPv6 protocol. Messages will not be accepted from the network through TCP/IP protocols. Messages addressed to this machine using TCP/IP protocols will not arrive but will accumulate in sender's outgoing queues.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The TCP/IP communication protocols are not functioning as expected. Contact your domain administrator to resolve problems with TCP/IP, and then restart the computer.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your domain administrator to find out if IPv6 and IPv4 can be installed on this computer.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Enable IPv6 Protocol</maml:ui>
              </maml:para>
              <maml:para>To enable the protocol yourself or to determine whether it is supported:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open Control Panel. To open Control Panel, click <maml:ui>Start</maml:ui>, and then click <maml:ui>Control Panel</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Double-click <maml:ui>Network and Sharing Center</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the <maml:ui>Tasks </maml:ui>section, click <maml:ui>Manage Network Connections</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In <maml:ui>Network Connections</maml:ui>, right-click the local area network (LAN) icon or your appropriate network controller, and then click <maml:ui>Properties</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            On the <maml:ui>Networking</maml:ui> tab, make sure that the <maml:ui>Internet Protocol Version 6 (TCP/IPv6)</maml:ui> check box is selected.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para>
                <maml:ui>Enable IPv4 protocol</maml:ui>
              </maml:para>
              <maml:para>To enable IPv4:</maml:para>
              <maml:table>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Open Control Panel. Click <maml:ui>Start</maml:ui>, and then click <maml:ui>Control Panel</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            Double-click <maml:ui>Network and Sharing Center</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In the <maml:ui>Tasks </maml:ui>section, click <maml:ui>Manage Network Connections</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            In <maml:ui>Network Connections</maml:ui>, right-click the local area network (LAN) icon or your appropriate network controller, and then click <maml:ui>Properties</maml:ui>.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
                <maml:row>
                  <maml:entry>
                    <maml:para>•</maml:para>
                  </maml:entry>
                  <maml:entry>
                    <maml:para>
                                            On the <maml:ui>Networking</maml:ui> tab, make sure that the <maml:ui>Internet Protocol Version 4 (TCP/IPv4)</maml:ui> check box is selected.
                                        </maml:para>
                  </maml:entry>
                </maml:row>
              </maml:table>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2199 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337523(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337523(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2201" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing Triggers initialization failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing needs full permission on its registry node. The Message Queuing Triggers service will fail to start if Message Queuing is not able to read certain information from the registry.</maml:para>
              <maml:para>You must run the registry editor as an administrator, which is the only way to edit registry keys with the user interface (UI). By default, local administrators have full permissions on the entire registry.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para> To confirm the registry key and permissions:</maml:para>
              <maml:para>
                <maml:ui>Caution:</maml:ui> Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open Registry Editor. To open Registry Editor, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>regedit</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Expand <maml:ui>HKEY_LOCAL_MACHINE</maml:ui>, expand <maml:ui>SOFTWARE</maml:ui>, expand <maml:ui>Microsoft</maml:ui>, and then expand <maml:ui>MSMQ</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Confirm that the <maml:ui>Triggers</maml:ui> registry key is available and that Message Queuing can read the registry values.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the MSMQ Registry node (<maml:ui>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSMQ</maml:ui>), and then click <maml:ui>Permissions</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Group or user names</maml:ui>, confirm that <maml:ui>MSMQ</maml:ui> is included. If it is not included, click <maml:ui>Add</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Group or user names</maml:ui>, click <maml:ui>MSMQ</maml:ui>, and then click <maml:ui>Advanced</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Permission entries</maml:ui>, click <maml:ui>MSMQ</maml:ui>, and then click <maml:ui>Edit</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        For <maml:ui>Full Control</maml:ui>, confirm that <maml:ui>MSMQ</maml:ui> has the <maml:ui>Allow</maml:ui> check box selected. This action selects all the other <maml:ui>Allow</maml:ui> check boxes.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Apply to</maml:ui> list, confirm that <maml:ui>This key and subkeys</maml:ui> is selected.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                If you continue to receive this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support <maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2201 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337511(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337511(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2202" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing Triggers failed to create an instance of the Triggers Transactional object. </maml:para>
              <maml:para>This Rule Alert is for Tracing.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Contact your domain administrator to help troubleshoot and resolve this issue.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2203" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The trigger information cannot be retrieved from the trigger store in registry. At least one trigger is nonfunctional.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The trigger information cannot be retrieved from the trigger store in registry. At least one trigger is nonfunctional.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Uninstall and reinstall Message Queuing triggers.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>External</maml:title>
              <maml:para>http://technet.microsoft.com/en-us/library/dd338552(WS.10).aspx</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2204" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The information for the attached rule cannot be retrieved from the trigger store.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The information for the attached rule cannot be retrieved from the trigger store.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Rules must be loaded successfully to operate properly.</maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To delete and recreate a specified rule:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>compmgmt.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>Computer Management</maml:ui>, expand <maml:ui>Services and Applications</maml:ui>, expand <maml:ui>Message Queuing</maml:ui>, expand <maml:ui>Triggers</maml:ui>, expand <maml:ui>Rules</maml:ui>, and then click <maml:ui>Rules</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the rule that is specified in the error message, and then delete it.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the rule, point to <maml:ui>New</maml:ui>, and then click <maml:ui>Rule</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Specify your parameters again.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2205" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Opening the queue  for peeking at or retrieving messages failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Network Service user account is the default user account that the Message Queuing Triggers service runs under on computers running Windows Server 8 and Windows 8. However, this user account can be changed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm the Message Queuing Triggers service user account and permissions</maml:ui>
              </maml:para>
              <maml:para>To confirm the Message Queuing Triggers service user account and permissions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, locate <maml:ui>Message Queuing Triggers</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Check the <maml:ui>Log On As</maml:ui> column to see what user account the service runs under.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Confirm that the user account has <maml:ui>Peek Message</maml:ui> or <maml:ui>Receive Message</maml:ui> permissions on the queue.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>View or change queue permissions</maml:ui>
              </maml:para>
              <maml:para>To view or change queue permissions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type compmgmt.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Expand <maml:ui>Services and Applications</maml:ui>, and then expand <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the queue for which you want to view or change permissions, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>Security</maml:ui> tab.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the user account is already listed in <maml:ui>Group or user names</maml:ui>, select the <maml:ui>Allow</maml:ui> check box next to the permissions that you want to add.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the user account is not listed in the <maml:ui>Access Control List</maml:ui>, click <maml:ui>Add</maml:ui> to add the user by name or search for the user, and then add permissions as appropriate, as described in step 5.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2205 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338549(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338549(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2206" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Opening an internal queue needed by the Triggers service failed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The internal triggers notification queue may not have been created successfully.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Uninstall and then reinstall the Message Queuing Server to recreate the internal triggers notification queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>External</maml:title>
              <maml:para>
                                For more information, see Event ID 2206 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338546(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338546(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2207" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>An instance of a rule handler for the rule was not created. The rule cannot be evaluated and executed. The MSMQTriggerObjects.MSMQRuleHandler class may not be registered, or your System folder does not contain mqtrig.dll.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm the version of Mqtrig.dll</maml:ui>
              </maml:para>
              <maml:para>You must have the correct version of the Mqtrig.dll file. First, confirm the version of the Mqtrig.dll file. Then, uninstall and reinstall Message Queuing triggers.</maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>Confirm that the %windir%\system32 folder contains the correct version of the Mqtrig.dll file</maml:para>
              <maml:para />
              <maml:para>To confirm the version of the Mqtrig.dll file:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Windows Explorer, and then navigate to the %windir%\System32 folder.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the System32 folder, right-click mqtrig.dll, and then click Properties.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the Version tab, and check the file version. Keep this window open. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Start, click Run, type MSInfo32, and then click OK.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click System Summary. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the details pane, locate Hardware Abstraction Layer. The version number should match the file version of Mqtrig.dll.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If these versions do not match, try uninstalling and reinstalling the Message Queuing Triggers feature of Message Queuing.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2207 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338556(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338556(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2208" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The action or a condition parameter for the rule was not parsed. The rule cannot be evaluated and executed.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Rule cannot be evaluated and executed. Rules must be loaded successfully to operate properly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Delete and recreate the rule that is specified in the event</maml:ui>
              </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To delete and recreate a specified rule:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Computer Management, expand Services and Applications, expand Message Queuing, expand Triggers, expand Rules, and then click Rules. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the rule that is specified in the error message, and then delete it.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule, point to New, and then click Rule.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Specify your parameters again.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about creating trigger rules, see Create and attach rules to triggers (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104059</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104059" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2208 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338551(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338551(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2209" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The action defined by the rule was not invoked.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>
                <maml:ui>Diagnose</maml:ui>
              </maml:para>
              <maml:para>The invocation of a Message Queuing trigger rule can fail for several reasons. This error might be caused by one of the following conditions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>A rule's condition or action parameter is not valid.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The Component Object Model (COM) object that is invoked by a rule is not registered correctly. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The executable file that is specified in the rule could not be found or is not functional.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>A rule's condition or action parameter is not valid</maml:para>
              <maml:para>To determine the validity of a rule's condition or action parameter: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Services and Applications, expand Message Queuing, and then expand Triggers. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Message Queuing Triggers, click Triggers.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that you want to execute to see its properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the General tab. Confirm that the rule is pointing to the desired queue and that the processing type is correct. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the Attached Rules tab, and ensure that the attached rules are as you intended. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Triggers, click Rules to display a list of available rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rules that should be executed with the trigger, and view their properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rules Conditions tab, confirm that the rule conditions are as desired. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, confirm that the rule points to the desired action. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that a rule's condition or parameter is the problem, see the section titled "Configure rules or triggers."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>The COM object that is invoked by a rule is not registered correctly</maml:para>
              <maml:para>To determine whether the COM object is registered correctly: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Component Services snap-in. To open Component Services, click Start, and then click Run. In the Open box, type comexp.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Component Services, expand Computers, expand My Computer, and then click COM+ Applications.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that your COM component is present and registered.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine the COM object is not registered properly, then see the section titled "Register the COM+ component."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>The executable file that is specified in the rule could not be found or is not functional</maml:para>
              <maml:para>To determine whether the executable file exists and is functional:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Windows Explorer, and then browse to the executable file that is specified in the event. Confirm that the file exists and that it executes properly.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Determine whether the executable file is referred to properly in the rule. Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type comexp.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Computer Management, expand Services and Applications, expand Message Queuing, expand Triggers, expand Rules, and then click Rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that is specified in the error message, and then click Properties.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, under Standalone executable invocation, confirm that the executable that is listed in Executable path exists and is preceded by its full path. For example, instead of just MyApp.exe, you should have c:\MyDirectory\MyApp.exe.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there is an issue with the executable file, see the section titled "Delete and recreate the rule."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                For more information about creating trigger rules, see Create and attach rules to triggers (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104059</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104059" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Configure rules or triggers</maml:ui>
              </maml:para>
              <maml:para>Rule conditions or triggers must be configured properly. If you do not know the intended rule or trigger settings, you may want to contact your solution architect. </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To confirm and change rules and triggers: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Expand Services and Applications, expand Message Queuing, and then expand Triggers. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Message Queuing Triggers, click Triggers.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that you want to execute, and then click Properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the General tab. Confirm that the rule is pointing to the desired queue and that the processing type is correct. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the Attached Rules tab, and ensure that the attached rules are as you intended. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Triggers, click Rules to display a list of available rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rules that should be executed with the trigger, and view their properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rules Conditions tab, confirm that the rule conditions are as desired. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, confirm that the rule points to the desired action. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Repeat steps 7 through 10 for each rule.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Register the COM+ object</maml:para>
              <maml:para>
                                The COM+ object that was invoked by a rule is not registered correctly. To register the object again, you can use the command-line utility regsvr32.exe. For more information about using regsvr32, see article 249873 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107513</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107513" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To register the COM+ object: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Run regsvr32.exe. To run regsvr32.exe, click Start. In the search box, type cmd, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type regsvr32 &lt;your COM+ component.dll&gt;, and then press ENTER.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Delete and recreate the rule</maml:para>
              <maml:para>The executable that is specified in the rule cannot be found or is not functional. To resolve this issue, try deleting and recreating the specified rule.</maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To delete and recreate a specified rule:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Computer Management, expand Services and Applications, expand Message Queuing, expand Triggers, expand Rules, and then click Rules. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the rule that is specified in the error message, and then double-click it.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Ensure that you provide the full path to your executable in the rule.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                For more information about creating trigger rules, see Create and attach rules to triggers (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104059</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104059" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2209 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337501(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337501(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2210" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Rule evaluation or execution failed for the transactional trigger.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The invocation of a Message Queuing trigger rule can fail for several reasons. This error might be caused by one of the following conditions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>A rule's condition or action parameter is not valid.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The Component Object Model (COM) object that is invoked by a rule is not registered correctly. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>The executable file that is specified in the rule could not be found or is not functional.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>A rule's condition or action parameter is not valid</maml:para>
              <maml:para>To determine the validity of a rule's condition or action parameter: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Services and Applications, expand Message Queuing, and then expand Triggers. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Message Queuing Triggers, click Triggers.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that you want to execute to see its properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the General tab. Confirm that the rule is pointing to the desired queue and that the processing type is correct. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the Attached Rules tab, and ensure that the attached rules are as you intended. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Triggers, click Rules to display a list of available rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rules that should be executed with the trigger, and view their properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rules Conditions tab, confirm that the rule conditions are as desired. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, confirm that the rule points to the desired action. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that a rule's condition or parameter is the problem, see the section titled "Configure rules or triggers."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>The COM object that is invoked by a rule is not registered correctly</maml:para>
              <maml:para>To determine whether the COM object is registered correctly: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Component Services snap-in. To open Component Services, click Start, and then click Run. In the Open box, type comexp.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Component Services, expand Computers, expand My Computer, and then click COM+ Applications.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that your COM component is present and registered.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine the COM object is not registered properly, then see the section titled "Register the COM+ component."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>The executable file that is specified in the rule could not be found or is not functional</maml:para>
              <maml:para>To determine whether the executable file exists and is functional:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Windows Explorer, and then browse to the executable file that is specified in the event. Confirm that the file exists and that it executes properly.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Determine whether the executable file is referred to properly in the rule. Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type comexp.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Computer Management, expand Services and Applications, expand Message Queuing, expand Triggers, expand Rules, and then click Rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that is specified in the error message, and then click Properties.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, under Standalone executable invocation, confirm that the executable that is listed in Executable path exists and is preceded by its full path. For example, instead of just MyApp.exe, you should have c:\MyDirectory\MyApp.exe.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>If you determine that there is an issue with the executable file, see the section titled "Delete and recreate the rule."</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                For more information about creating trigger rules, see Create and attach rules to triggers (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104059</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104059" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Configure rules or triggers</maml:ui>
              </maml:para>
              <maml:para>Rule conditions or triggers must be configured properly. If you do not know the intended rule or trigger settings, you may want to contact your solution architect. </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To confirm and change rules and triggers: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Expand Services and Applications, expand Message Queuing, and then expand Triggers. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Message Queuing Triggers, click Triggers.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rule that you want to execute, and then click Properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the General tab. Confirm that the rule is pointing to the desired queue and that the processing type is correct. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the Attached Rules tab, and ensure that the attached rules are as you intended. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Under Triggers, click Rules to display a list of available rules.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the rules that should be executed with the trigger, and view their properties. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rules Conditions tab, confirm that the rule conditions are as desired. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Rule Action tab, confirm that the rule points to the desired action. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Repeat steps 7 through 10 for each rule.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Register the COM+ object</maml:para>
              <maml:para>
                                The COM+ object that was invoked by a rule is not registered correctly. To register the object again, you can use the command-line utility regsvr32.exe. For more information about using regsvr32, see article 249873 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107513</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107513" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To register the COM+ object: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Run regsvr32.exe. To run regsvr32.exe, click Start. In the search box, type cmd, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type regsvr32 &lt;your COM+ component.dll&gt;, and then press ENTER.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Delete and recreate the rule</maml:para>
              <maml:para>The executable that is specified in the rule cannot be found or is not functional. To resolve this issue, try deleting and recreating the specified rule.</maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To delete and recreate a specified rule:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Computer Management, expand Services and Applications, expand Message Queuing, expand Triggers, expand Rules, and then click Rules. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the rule that is specified in the error message, and then double-click it.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Ensure that you provide the full path to your executable in the rule.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                For more information about creating trigger rules, see Create and attach rules to triggers (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104059</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104059" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2210 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337483(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337483(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2212" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The queue was not found. It may have been deleted. The trigger associated with this queue is nonfunctional. Please use Computer Management to remove this trigger.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The queue was not found. It may have been deleted. The trigger associated with this queue is nonfunctional.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Confirm the user account that the trigger service runs under on the computer that hosts the queue.</maml:para>
              <maml:para>Also, the trigger's queue must be available, and the account under which the trigger service is running needs Peek and/or Receive permissions to the trigger's queue.</maml:para>
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Find the trigger service account</maml:ui>
              </maml:para>
              <maml:para>To find the account that the trigger service runs under:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type services.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Select the <maml:ui>Message Queuing Triggers</maml:ui> service. Check the value in the <maml:ui>Log On As</maml:ui> column to determine which account the service runs under. Make a note of this account name.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click <maml:ui>Message Queuing Triggers</maml:ui>, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>Log On</maml:ui> tab. Confirm the account that the trigger service logs on as, and modify it as necessary.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm trigger queue existence and permissions</maml:ui>
              </maml:para>
              <maml:para>To confirm trigger queue existence and permissions:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Computer Management snap-in. To open Computer Management, click <maml:ui>Start</maml:ui>. In the search box, type compmgmt.msc, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Expand <maml:ui>Services and Applications</maml:ui>, and then expand <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the queue that is monitored by the trigger exists.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the queue, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>Security</maml:ui> tab.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the <maml:ui>Group or user names</maml:ui> section, select the user account that the service runs under.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Under <maml:ui>Permissions</maml:ui>, confirm that the account under which the trigger service is running has the appropriate permissions (Peek or Receive, and so on).
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2212 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337426(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337426(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2213" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>At least one of the required dependencies was not found. Please verify that MSMQ Triggers resources are dependent on Message Queue resources.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The Message Queuing Triggers service needs access to the required cluster resources when the Message Queuing services are configured for high availability on a Windows Server cluster. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Ensure that the trigger service has access to the cluster resources that it requires.</maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To confirm that the trigger service can access necessary cluster resources:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Cluster Management snap-in. To open Cluster Management, click <maml:ui>Start</maml:ui>, click <maml:ui>Control Panel,</maml:ui> click <maml:ui>Administrative Tools</maml:ui>, and then click <maml:ui>Failover Cluster Management</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, under <maml:ui>Services and Applications</maml:ui>, click the desired application.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, right-click <maml:ui>Message Queuing Triggers</maml:ui>, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click the <maml:ui>Dependencies</maml:ui> tab.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Look at the <maml:ui>Dependencies</maml:ui> list, and ensure that the cluster resources are in the list.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2213 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337425(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337425(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2214" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Unable to update EventLog information in registry</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>A registry key may not be registered properly. Uninstall and then reinstall Message Queuing triggers.</maml:para>
              <maml:para />
              <maml:para>To perform these procedures, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>Uninstall and reinstall Message Queuing triggers (Windows 7)</maml:para>
              <maml:para>To uninstall Message Queuing triggers:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Click Start, and then click Control Panel.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the left pane, click Classic View.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Programs and Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Windows Features dialog box, expand Microsoft Message Queue (MSMQ) Server Core, and then clear the MSMQ Triggers box.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click OK.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>To install Message Queuing triggers:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Click Start, and then click Control Panel.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the left pane, click Classic View.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Programs and Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the left pane, click Turn Windows features on or off.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the Windows Features dialog box, expand Microsoft Message Queue (MSMQ) Server Core, and then select the MSMQ Triggers check box.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click OK.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>Uninstall and reinstall Message Queuing triggers (Windows Server 8)</maml:para>
              <maml:para>To uninstall Message Queuing triggers:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, and then click Server Manager.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Start the Remove Features Wizard. To start the Remove Features Wizard, in the Features Summary section, click Remove Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Expand Message Queuing, and then expand Message Queuing Services.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Clear the Message Queuing Triggers check box, and then click Next.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Remove.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>To install Message Queuing triggers:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open Server Manager. To open Server Manager, click Start, point to Administrative Tools, and then click Server Manager.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Start the Add Features Wizard. To start the Add Features Wizard, in the Features Summary section, click Add Features.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Expand Message Queuing, and then expand Message Queuing Services.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the Message Queuing Triggers check box, and then click Next.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click Install.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                                If you continue to get this error, note any details in the event message, and then contact Microsoft Customer Service and Support (CSS). For information about how to contact CSS, see Enterprise Support (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=52267</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=52267" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2214 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338557(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338557(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2215" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The Triggers transactional component could not be registered in COM+.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The COM+ object that was invoked by a rule is not registered correctly.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To register the object again, you can use the command-line utility regsvr32.exe. For more information about using regsvr32, see article 249873 in the Microsoft Knowledge Base (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107513</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107513" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                To perform this procedure, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To register the COM+ object: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Run regsvr32.exe. To run regsvr32.exe, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>cmd</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        At the command prompt, type <maml:ui>regsvr32 &lt;your COM+ component.dll&gt;</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2215 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd338547(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd338547(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2219" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Restart the triggers service.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2220" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The IP Address specified in the registry value is not a valid IP address for this computer.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The IP address is not configured properly in the registry.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                                To perform these procedures, you must have membership in <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para>To configure IP address:</maml:para>
              <maml:para>
                <maml:ui>Caution: </maml:ui>Incorrectly editing the registry might severely damage your system. Before making changes to the registry, you should back up any valued data.
                            </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Registry Editor. Click <maml:ui>Start</maml:ui>, in the search box type <maml:ui>regedit</maml:ui>, and then hit ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Browse to the registry key specified in the event.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Either remove the registry value or set it to the IP address suggested in the event.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Verify</maml:ui>
              </maml:para>
              <maml:para>You can use Failover Cluster Management to determine whether the Message Queuing cluster resource is online, or you can use the Cluster.exe tool to determine whether Windows Failover Clustering is installed and running.</maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2220 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337457(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337457(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2250" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing will not be able to accept messages temporarily because system paged pool is low. No manual intervention is required at this stage. Once memory utilization has normalized, Message Queuing will automatically resume accepting messages. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Common system resources are almost fully consumed. Message Queuing will not operate properly until system resources are freed up. </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about managing Message Queuing system resources, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2250 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337494(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337494(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2251" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Message Queuing will not be able to accept messages temporarily because system commit is high. No manual intervention is required at this stage. Once memory utilization has normalized, Message Queuing will automatically resume accepting messages.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>Message Queuing will not be able to accept messages temporarily because system commit is high.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Monitor low system resources</maml:ui>
              </maml:para>
              <maml:para>
                                Common system resources are almost fully consumed. Message Queuing will not operate properly until system resources are freed up. For more information about managing Message Queuing system resources, see Resource Management in MSMQ Applications (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=107361</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=107361" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>We recommend that you monitor the number of messages on your computer and processs these messages. If this issue is persistent, you may have to rearchitect your solution.</maml:para>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority.</maml:para>
              <maml:para>To monitor Message Queuing with Performance Monitor:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open a command prompt. To open a command prompt, click Start. In the search box, type cmd, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>At the command prompt, type Perfmon, and then press ENTER. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, under Monitoring Tools, click Performance Monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Click the green plus sign to add a monitor. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the Add counters tab, in the Counters section, click MSMQ Service. </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Select the appropriate counters that you need.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information, see Event ID 2251 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337531(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337531(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2253" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The message could not be moved to deadletter queue. The message was moved to the system transactional dead letter queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>A dead-letter queue must exist. It also needs appropriate permissions.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that a dead-letter queue exists and confirm permissions</maml:ui>
              </maml:para>
              <maml:para>To resolve this issue:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Confirm that the dead-letter queue that is specified in the event exists.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Determine the user account under which Message Queuing is running.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Confirm that the user account has permissions on the specified queue.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that the dead-letter queue exists</maml:ui>
              </maml:para>
              <maml:para>To confirm that the dead-letter queue exists:</maml:para>
              <maml:para>
                                On the computer that is specified in the queue format name, locate the dead-letter queue that is specified in the event. For more information about queue format names, see Queue Names (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=104739</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=104739" /></maml:navigationLink>)
                            </maml:para>
              <maml:para>
                                To perform these procedures you must have membership to <maml:ui>Administrators</maml:ui>, or you must have been delegated the appropriate authority.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Determine the user account under which Message Queuing is running</maml:ui>
              </maml:para>
              <maml:para>To determine the user account under which Message Queuing is running:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the details pane, locate <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Check the <maml:ui>Log On As</maml:ui> column to see what user the service runs under.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>
                <maml:ui>Note</maml:ui>: When Message Queuing is running in workgroup mode, the default user is <maml:ui>Local System</maml:ui>. When Message Queuing is running in domain mode, the default user is <maml:ui>Network Service</maml:ui>.
                            </maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Confirm that the user account has permissions on the specified queue</maml:ui>
              </maml:para>
              <maml:para>You must have administrator privileges to confirm Message Queuing user permissions. If you want to modify permissions, you will also must have the Set Permissions permission on the specified queue.</maml:para>
              <maml:para>To confirm that the user account has permissions on the specified queue:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Open the Services snap-in. To open Services, click <maml:ui>Start</maml:ui>. In the search box, type <maml:ui>services.msc</maml:ui>, and then press ENTER.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the console tree, expand <maml:ui>Services and Applications</maml:ui>, and then expand <maml:ui>Message Queuing</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Navigate to the dead-letter queue that is specified in the event.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Right-click the queue, and then click <maml:ui>Properties</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        On the <maml:ui>Security</maml:ui> tab, in <maml:ui>Group or user names</maml:ui>, find the user under which Message Queuing is running. If the user is in this list, go to step 11.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the user is not already in the list, click <maml:ui>Add</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In <maml:ui>Enter the object names to select</maml:ui>, enter the user under which Message Queuing is running.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>Check Names</maml:ui> to make sure that you are adding the correct permissions.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        If the correct user is found, click <maml:ui>OK</maml:ui>.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        In the queue’s security properties, under <maml:ui>Permissions</maml:ui>, select the <maml:ui>Allow</maml:ui> check box next to the <maml:ui>Send Message</maml:ui> permission.
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>
                                        Click <maml:ui>OK</maml:ui>.
                                    </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para />
              <maml:para>
                                For more information about queue format names, see Queue Names (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=104739</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=104739" /></maml:navigationLink>)
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2253 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337462(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337462(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2254" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The message could not be moved to deadletter queue. The deadletter queue is authenticated and the authenticity of the message could not be verified. The message will be moved to the system transactional dead letter queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The dead-letter queue that is mentioned in the error is authenticated, but the MSMQ Service could not confirm the authenticity of the message in the dead-letter queue</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Confirm that the message is properly signed or allow the dead-letter queue to receive non authenticated messages.</maml:ui>
              </maml:para>
              <maml:para>To resolve this issue, do one of the following:</maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>
                                        Confirm that the computer that sent the message is properly signing its authenticated messages. For more information about signing messages, see Message Authentication (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkID=104732</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkID=104732" /></maml:navigationLink>).
                                    </maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Allow the dead-letter queue to receive nonauthenticated messages.</maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para>To perform this procedure, you must have membership in Administrators, or you must have been delegated the appropriate authority. If you want to modify permissions, you also must have the Set Properties permission on the specified queue.</maml:para>
              <maml:para />
              <maml:para>
                <maml:ui>Allow the dead-letter queue to receive nonauthenticated messages</maml:ui>
              </maml:para>
              <maml:para>To allow the dead-letter queue to receive nonauthenticated messages: </maml:para>
              <maml:list>
                <maml:listItem>
                  <maml:para>Open the Computer Management snap-in. To open Computer Management, click Start. In the search box, type compmgmt.msc, and then press ENTER.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>In the console tree, expand Services and Applications, and then expand Message Queuing.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>Right-click the desired queue, and then click Properties.</maml:para>
                </maml:listItem>
                <maml:listItem>
                  <maml:para>On the General tab, clear the Authenticated check box. </maml:para>
                </maml:listItem>
              </maml:list>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about sending authenticated messages, see Message Authentication (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104732</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104732" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2254 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337478(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337478(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2255" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>The message could not be moved to deadletter queue. Deadletter queues should not require privacy of messages. The message will be moved to the system transactional dead letter queue.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>This problem could be because:</maml:para>
              <maml:para>
                                The privacy level of the specified dead-letter queue might be other than <maml:ui>None</maml:ui> or <maml:ui>Optional</maml:ui> or the messages that are being sent to the queue are not encrypted.
                            </maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Change encryption levels</maml:ui>
              </maml:para>
              <maml:para>To allow messages to enter a dead-letter queue, set the privacy level of the specified dead-letter queue to None or Optional, or ensure that the messages that are being sent to the queue are encrypted.</maml:para>
              <maml:para>
                                For more information about changing the privacy level of queues, see Change the Privacy Level for Queues (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104733</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104733" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information about sending encrypted messages, see Message Queuing-Encrypted Messages (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104734</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104734" /></maml:navigationLink>).
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about changing the privacy level of queues, see Change the Privacy Level for Queues (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104733</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104733" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information about sending encrypted messages, see Message Queuing-Encrypted Messages (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104734</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104734" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event id 2255 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337460(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337460(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
              <maml:para />
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Rule.Alert.Event2256" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>
                                The message could not be moved to deadletter queue. The deadletter queue needs to be transactional. The message will be moved to the system transactional dead letter queue.<maml:ui />Make the per-app dead-letter queue transactional or the messages being sent to it nontransactional.
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The dead-letter queue that is specified in the event is nontransactional, but there are transactional messages trying to go there.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>
                <maml:ui>Make the per-app dead-letter queue transactional or the messages being sent to it nontransactional</maml:ui>
              </maml:para>
              <maml:para>
                                To allow messages to go to the dead-letter queue, recreate the dead-letter queue as a transactional queue, or if you have control over the messages that are being sent to the queue, ensure that the messages are <maml:ui>nontransactional</maml:ui>.
                            </maml:para>
              <maml:para>
                                To recreate the dead-letter queue as a transactional queue, create a new transactional queue with all the same properties as the original dead-letter queue, but make the new queue <maml:ui>transactional</maml:ui>.
                            </maml:para>
              <maml:para />
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Additional</maml:title>
              <maml:para>
                                For more information about creating queues, see Create Queues (<maml:navigationLink><maml:linkText>http://go.microsoft.com/fwlink/?LinkId=104735</maml:linkText><maml:uri href="http://go.microsoft.com/fwlink/?LinkId=104735" /></maml:navigationLink>).
                            </maml:para>
              <maml:para>
                                For more information, see Event ID 2256 (<maml:navigationLink><maml:linkText>http://technet.microsoft.com/en-us/library/dd337453(WS.10).aspx</maml:linkText><maml:uri href="http://technet.microsoft.com/en-us/library/dd337453(WS.10).aspx" /></maml:navigationLink>)
                            </maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Service.Monitor" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This monitor tracks the state of the MSMQ service and changes state depending on whether the service is running or not.  By default the monitor is configured to generate alerts when the service is not running.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The process supporting the service has failed or the service has been sent a stop command.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Restart the MSMQ service.  If the service fails to start then investigate the cause of the failure further by looking for events in the event log, which provide more details.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="MSMQ.Triggers.Service.Monitor" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This monitor tracks the state of the MSMQ triggers service and changes state depending on whether the service is running or not.  By default the monitor is configured to generate alerts when the service is not running.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Causes</maml:title>
              <maml:para>The process supporting the service has failed or the service has been sent a stop command.</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Resolutions</maml:title>
              <maml:para>Restart the MSMQ triggers service.  If the service fails to start then investigate the cause of the failure further by looking for events in the event log, which provide more details.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
      </KnowledgeArticles>
    </LanguagePack>
  </LanguagePacks>
</ManagementPack>